(this["webpackJsonpmoney-flow"]=this["webpackJsonpmoney-flow"]||[]).push([[0],{372:function(e,t,n){"use strict";(function(e){var r=n(72),i=n(13),o=n(14),a=n(39),l=n.n(a),c=n(373),u=n.n(c),s=n(374),d=n(375),y=function(){function t(){Object(i.a)(this,t),this.db=null,this.actionCount=0}return Object(o.a)(t,[{key:"init",value:function(){var e=Object(r.a)(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()({locateFile:function(){return s.a}});case 2:return n=e.sent,e.next=5,new Promise((function(e,n){var r=new FileReader;r.readAsArrayBuffer(t),r.onload=function(){return e(r.result)}}));case 5:r=e.sent,i=new Uint8Array(r),this.db=new n.Database(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDb",value:function(){var e=Object(r.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()({locateFile:function(){return s.a}});case 2:t=e.sent,this.db=new t.Database,this.create("CREATE TABLE `data_summary` (            `id` INTEGER NOT NULL  ,            `gmt_create` datetime NOT NULL  ,            `gmt_modified` datetime NOT NULL  ,            `type` varchar(64) NOT NULL ,            `time` datetime NOT NULL  ,            `money` INTEGER,            PRIMARY KEY (`id` AUTOINCREMENT)           )"),this.create("CREATE TABLE `income_expenditure_detail` (            `id` INTEGER NOT NULL ,            `gmt_create` datetime NOT NULL,            `gmt_modified` datetime NOT NULL ,            `type` int NOT NULL,            `desc` varchar(64) NULL,            `money` bigint unsigned NOT NULL,            `happen_time` datetime NOT NULL,            PRIMARY KEY (`id` AUTOINCREMENT)        )"),this.create("CREATE TABLE `investment_detail` (            `id` INTEGER NOT NULL  ,            `gmt_create` datetime NOT NULL  ,            `gmt_modified` datetime NOT NULL  ,            `product_id` INTEGER NOT NULL  ,            `product_name` varchar(64) NOT NULL  ,            `product_type` INTEGER NOT NULL  ,            `money` INTEGER NOT NULL  ,            `happen_time` datetime NOT NULL  ,            `buy_sell_id` INTEGER,            `record_type` int NOT NULL , `count` INT,            PRIMARY KEY (`id` AUTOINCREMENT)           )"),this.create("CREATE TABLE `investment_product` (            `id` INTEGER NOT NULL  ,            `gmt_create` datetime NOT NULL  ,            `gmt_modified` datetime NOT NULL  ,            `name` varchar(64) NOT NULL  ,            `type` int NOT NULL  ,            `desc` varchar(64) NULL  , fix_vote INT,            PRIMARY KEY (`id` AUTOINCREMENT)           )");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var t=this.db.export(),n=e.from(t),r=new Blob([n]),i=window.URL.createObjectURL(r);this.downloadFile(i)}},{key:"checkAutoSave",value:function(){++this.actionCount>20&&(d.b.info("\u81ea\u52a8\u89e6\u53d1\u4fdd\u5b58"),this.actionCount=0,this.export())}},{key:"downloadFile",value:function(e){console.log("\u4e0b\u8f7d\u6587\u4ef6\uff1a"+e);var t=document.createElement("a");document.body.appendChild(t),t.href=e,t.download="data.db",t.onclick=function(){setTimeout((function(){window.URL.revokeObjectURL(t.href)}),1500)},t.click()}},{key:"selectAll",value:function(e){return this.select(e,[],[],[])}},{key:"select",value:function(e,t,n,r){return this.selectAndOrder(e,t,n,r,[])}},{key:"selectAndOrder",value:function(e,t,n,r,i){var o="SELECT * FROM ".concat(e),a=this.genWhereSql(t,n,r),l=a[1];return o+=a[0],i.length>0&&(o+=" order by ".concat(i.join(","))),this.db.exec(o,l)}},{key:"create",value:function(e){console.log(e),this.db.run(e)}},{key:"insert",value:function(e,t,n){for(var r="INSERT INTO ".concat(e," (").concat(t.join(","),") VALUES ("),i={},o=0;o<t.length;o++)r+="$"+t[o]+o,o<t.length-1&&(r+=", "),i["$"+t[o]+o]=n[o];r+=") returning id",console.log(r+" "+JSON.stringify(i));var a=this.db.exec(r,i);return this.checkAutoSave(),a[0].values[0][0]}},{key:"update",value:function(e,t,n,r){var i="UPDATE ".concat(e," SET"),o=this.genSubSql(n,r,[],!1),a=o[1];i+=o[0],i+=" where id=$id",a.$id=t,console.log(i+" "+JSON.stringify(a)),this.checkAutoSave(),this.db.run(i,a)}},{key:"deleteAll",value:function(e){this.delete(e,[],[],[])}},{key:"delete",value:function(e,t,n,r){var i="DELETE FROM ".concat(e),o=this.genWhereSql(t,n,r),a=o[1];i+=o[0],console.log(i+" "+JSON.stringify(a));var l=this.db.exec(i,a);this.checkAutoSave(),console.log(JSON.stringify(l))}},{key:"genWhereSql",value:function(e,t,n){return this.genSubSql(e,t,n,!0)}},{key:"genSubSql",value:function(e,t,n,r){for(var i="",o={},a=0;a<e.length;a++){i+=0!==a?r?" and ":" , ":r?" where ":" ";var l=n[a];void 0===l&&(l="="),i+=" "+e[a]+" "+l+" $"+e[a]+a,o["$"+e[a]+a]=t[a]}return[i,o]}}]),t}();t.a=y}).call(this,n(68).Buffer)},546:function(e,t,n){},694:function(e,t){},696:function(e,t){},707:function(e,t){},709:function(e,t){},736:function(e,t){},738:function(e,t){},739:function(e,t){},744:function(e,t){},746:function(e,t){},752:function(e,t){},754:function(e,t){},773:function(e,t){},785:function(e,t){},788:function(e,t){},795:function(e,t,n){"use strict";n.r(t),n.d(t,"App",(function(){return Qe})),n.d(t,"DB_INIT",(function(){return $e}));var r=n(72),i=n(13),o=n(14),a=n(39),l=n.n(a),c=n(0),u=n.n(c),s=n(74),d=n.n(s),y=(n(546),n(21)),h=n(20),f=n(530),p=n(211),v=n(84),m=n(803),b=n(806),j=n(799),g=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"noValue",value:function(e){return x.isEmpty(e)||x.notNumber(e)||0==e}},{key:"getDetailStr",value:function(e){if(this.noValue(e))return"-";var t=e/100;return"\uffe5".concat(t%1===0?t:t.toFixed(2))}},{key:"getStr",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.noValue(e))return"-";var n=e/100;return t&&(n=e),"\uffe5".concat(this.getFixedMoney(n))}},{key:"getMoneyColorType",value:function(e){return this.noValue(e)?"":e>0?"danger":e<0?"success":""}},{key:"getFixedMoney",value:function(e){var t=e<0,n=e.toFixed();t&&(n=n.substr(1));for(var r=n.length,i=[],o=0;o<r;){var a=0==o?r%3:3;0==a&&(a=3),i.push(n.substr(o,a)),o+=a}return t?"-"+i.join(","):i.join(",")}},{key:"compare",value:function(e,t){return x.notNumber(e)?-1:x.notNumber(t)?1:e-t}},{key:"compareAbs",value:function(e,t){return x.notNumber(e)?-1:x.notNumber(t)?1:Math.abs(e)-Math.abs(t)}},{key:"safeDivision",value:function(e,t){return x.notNumber(e)||x.notNumber(t)||0==t?null:e/t}},{key:"getPercentStr",value:function(e){return x.notNumber(e)||Math.abs(e)<=1e-4?"-":x.getPercent(e)}},{key:"getPercentColorType",value:function(e){return x.notNumber(e)||Math.abs(e)<=1e-4?"":e>0?"danger":e<0?"success":""}}]),e}(),x=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"isEmpty",value:function(e){return void 0===e||null===e||""===e}},{key:"isNull",value:function(e){return void 0===e||null===e}},{key:"notNumber",value:function(e){return this.isNull(e)||isNaN(e)}},{key:"getPercent",value:function(e){var t=100*e;return"".concat(t%1===0?t:t.toFixed(2),"%")}},{key:"compare",value:function(t,n){return e.notNumber(t)?-1:e.notNumber(n)?1:t-n}},{key:"compareAbs",value:function(t,n){return e.notNumber(t)?-1:e.notNumber(n)?1:Math.abs(t)-Math.abs(n)}}]),e}(),O=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"nextMonthStart",value:function(e){var t=e.getMonth()+1,n=e.getFullYear();return 12===t?(n+=1,t="01"):t=(t+=1)<10?"0"+t:t,new Date("".concat(n,"-").concat(t,"-01 00:00:00"))}},{key:"monthEnd",value:function(e){return new Date(this.nextMonthStart(e)-1)}},{key:"monthStart",value:function(e){var t=e.getMonth()+1,n=e.getFullYear();return new Date("".concat(n,"-").concat(t,"-01 00:00:00"))}},{key:"nextYearStart",value:function(e){var t=e.getMonth()+1,n=e.getFullYear()+1;return new Date("".concat(n,"-").concat(t,"-01 00:00:00"))}},{key:"yearEnd",value:function(e){return new Date(this.nextYearStart(e)-1)}},{key:"lastMonthEnd",value:function(e){return new Date(this.monthStart(e)-1)}},{key:"inMonth",value:function(t,n){var r=e.monthStart(n),i=e.monthEnd(n);return this.inTime(t,r,i)}},{key:"inTime",value:function(e,t,n){return!(e>n||e<t)}},{key:"dayStr",value:function(e){return x.isNull(e)?"":e.timeStr().substring(0,10)}},{key:"monthStr",value:function(e){return x.isNull(e)?"":e.timeStr().substring(0,7)}},{key:"weekDayStr",value:function(e){switch(e.getDay()){case 0:return"\u5468\u65e5";case 1:return"\u5468\u4e00";case 2:return"\u5468\u4e8c";case 3:return"\u5468\u4e09";case 4:return"\u5468\u56db";case 5:return"\u5468\u4e94";case 6:return"\u5468\u516d"}}}]),e}(),P=n(52),k=function(){function e(){Object(i.a)(this,e),this.tablename=null,Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Date.prototype.timeStr=function(){return this.format("yyyy-MM-dd hh:mm:ss")}}return Object(o.a)(e,[{key:"get",value:function(e){if(!$e)return null;if(null!=e)return this.convert(Qe.db.select(this.tablename,["id"],[e],[]));throw new Error("id \u4e0d\u80fd\u4e3a\u7a7a")}},{key:"selectAll",value:function(){return $e?this.convert(Qe.db.selectAll(this.tablename)):[]}},{key:"delete",value:function(e){$e&&Qe.db.delete(this.tablename,["id"],[e],[])}},{key:"deleteAll",value:function(){$e&&Qe.db.deleteAll(this.tablename)}},{key:"convert",value:function(e){}}],[{key:"getDateStr",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e){if(t)return(new Date).timeStr();throw new Error("\u65e5\u671f\u4e0d\u80fd\u4e3a null")}if(e instanceof Date)return e.timeStr();throw new Error("\u65e5\u671f\u683c\u5f0f\u4e0d\u4e3a Date")}}]),e}(),S=Object(o.a)((function e(){Object(i.a)(this,e),this.id=null,this.gmtCreate=null,this.gmtModified=null})),M=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).tablename="income_expenditure_detail",e}return Object(o.a)(n,[{key:"upsert",value:function(e){var t,n,r=k.getDateStr(e.gmtCreate,!0),i=k.getDateStr(e.gmtModified),o=k.getDateStr(e.happenTime);null==e.id?null===(t=Qe.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","type","desc","money","happen_time"],[r,i,e.type.code,e.desc,e.money,o]):null===(n=Qe.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","type","desc","money","happen_time"],[r,i,e.type.code,e.desc,e.money,o])}},{key:"select",value:function(e,t){var n;if(t<e)throw new Error("\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4");return this.convert(null===(n=Qe.db)||void 0===n?void 0:n.select(this.tablename,["happen_time","happen_time"],[e.timeStr(),t.timeStr()],[">","<"]))}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(P.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=new w;o.id=i[0],o.gmtCreate=new Date(i[1]),o.gmtModified=new Date(i[2]),o.type=D.getByCode(i[3]),o.desc=i[4],o.money=i[5],o.happenTime=new Date(i[6]),t.push(o)}}catch(a){r.e(a)}finally{r.f()}return t}}]),n}(k),w=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).type=null,e.desc=null,e.money=null,e.happenTime=null,e}return Object(o.a)(n,[{key:"save",value:function(){this.gmtModified=new Date,this.money*this.type.code<0&&(this.money=-1*this.money),n.repo.upsert(this)}}],[{key:"query",value:function(e){return this.repo.get(e)}},{key:"queryTimeBetwen",value:function(e,t){return this.repo.select(e,t)}},{key:"delete",value:function(e){n.repo.delete(e)}}]),n}(S);w.repo=new M;var D=function(){function e(t,n){Object(i.a)(this,e),this.code=t,this.name=n}return Object(o.a)(e,[{key:"getGroup",value:function(){return e.getByCode(this.code-this.code%100)}},{key:"isIncome",value:function(){return this.code>0}}],[{key:"getByCode",value:function(e){var t,n=Object(P.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"toList",value:function(t){if(t instanceof e)return[t];for(var n=[],r=0,i=Object.keys(t);r<i.length;r++){var o=i[r];n=n.concat(this.toList(t[o]))}return n}},{key:"values",value:function(){return this.toList(this.Incomme).concat(this.toList(this.Expenditure))}}]),e}();D.Incomme={salary:{self:new D(1e4,"\u85aa\u6c34"),num13:new D(10001,"\u85aa\u6c34-\u5341\u4e09\u85aa"),bonus:new D(10002,"\u85aa\u6c34-\u5e74\u7ec8\u5956")},luckmoney:{self:new D(2e4,"\u7ea2\u5305"),work:new D(20001,"\u7ea2\u5305-\u5de5\u4f5c"),home:new D(20002,"\u7ea2\u5305-\u5bb6\u4eba")},other:{self:new D(3e4,"\u5176\u4ed6")}},D.Expenditure={home:{self:new D(-1e4,"\u4f4f\u623f"),rent:new D(-10001,"\u4f4f\u623f-\u623f\u79df"),utility:new D(-10002,"\u4f4f\u623f-\u6c34\u7535")},daily:{self:new D(-2e4,"\u65e5\u5e38"),taxi:new D(-20001,"\u65e5\u5e38-\u4ea4\u901a"),phone:new D(-20002,"\u65e5\u5e38-\u8bdd\u8d39")},shopping:{self:new D(-3e4,"\u8d2d\u7269"),elc:new D(-30001,"\u8d2d\u7269-\u7535\u5b50"),life:new D(-30002,"\u8d2d\u7269-\u751f\u6d3b")},happy:{self:new D(-4e4,"\u5a31\u4e50"),online:new D(-40001,"\u5a31\u4e50-\u7ebf\u4e0a"),offline:new D(-40002,"\u5a31\u4e50-\u7ebf\u4e0b")},food:{self:new D(-5e4,"\u9910\u996e"),canteen:new D(-50001,"\u9910\u996e-\u98df\u5802"),out:new D(-50002,"\u9910\u996e-\u5916\u51fa")},family:{self:new D(-6e4,"\u5bb6\u4eba"),traval:new D(-60001,"\u5bb6\u4eba-\u4ea4\u901a"),gift:new D(-60002,"\u5bb6\u4eba-\u793c\u7269")},study:{self:new D(-7e4,"\u5b66\u4e60"),online:new D(-70001,"\u5b66\u4e60-\u7ebf\u4e0a"),offline:new D(-70002,"\u5b66\u4e60-\u7ebf\u4e0b")},health:{self:new D(-8e4,"\u5065\u5eb7")},car:{self:new D(-9e4,"\u8f66"),etc:new D(-90001,"\u8f66-\u505c\u8f66/ETC"),oil:new D(-90002,"\u8f66-\u52a0\u6cb9")},girlfriend:{self:new D(-1e5,"\u5973\u670b\u53cb"),traval:new D(-100001,"\u5973\u670b\u53cb-\u65c5\u6e38"),eat:new D(-100002,"\u5973\u670b\u53cb-\u5403\u559d"),gift:new D(-100003,"\u5973\u670b\u53cb-\u793c\u7269")},other:{self:new D(-11e4,"\u5176\u4ed6")}};var T=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"getIncomeTypes",value:function(){return D.Incomme}},{key:"getExpenditureTypes",value:function(){return D.Expenditure}},{key:"upsert",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=new w;o.id=i,o.type=t,o.desc=r,o.money=e,o.happenTime=n,o.save()}},{key:"queryMonth",value:function(e){var t=O.monthStart(e);return w.queryTimeBetwen(t,O.monthEnd(t))}},{key:"queryTimeBetwen",value:function(e,t){return w.queryTimeBetwen(e,t)}},{key:"delete",value:function(e){w.delete(e)}}]),e}(),I=n(514),_=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).tablename="investment_product",e}return Object(o.a)(n,[{key:"upsert",value:function(e){var t,n,r=k.getDateStr(e.gmtCreate,!0),i=k.getDateStr(e.gmtModified);null==e.id?null===(t=Qe.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","name","type","desc","fix_vote"],[r,i,e.name,e.type.code,e.desc,e.fixVote]):null===(n=Qe.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","name","type","desc","fix_vote"],[r,i,e.name,e.type.code,e.desc,e.fixVote])}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(P.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=new C;o.id=i[0],o.gmtCreate=new Date(i[1]),o.gmtModified=new Date(i[2]),o.name=i[3],o.type=L.getByCode(i[4]),o.desc=i[5],o.fixVote=i[6],t.push(o)}}catch(a){r.e(a)}finally{r.f()}return t}}]),n}(k),N=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).tablename="investment_detail",e}return Object(o.a)(n,[{key:"upsert",value:function(e){var t,n,r=k.getDateStr(e.gmtCreate,!0),i=k.getDateStr(e.gmtModified),o=k.getDateStr(e.happenTime);return null==e.id?null===(t=Qe.db)||void 0===t?void 0:t.insert(this.tablename,["gmt_create","gmt_modified","product_id","product_name","product_type","money","happen_time","buy_sell_id","record_type","count"],[r,i,e.productId,e.productName,e.productType.code,e.money,o,e.buySellId,e.recordType.code,e.count]):(null===(n=Qe.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","product_id","product_name","product_type","money","happen_time","buy_sell_id","record_type","count"],[r,i,e.productId,e.productName,e.productType.code,e.money,o,e.buySellId,e.recordType.code,e.count]),e.id)}},{key:"select",value:function(e,t,n,r){var i;if(!$e)return[];if(null!=n&&r<n)throw new Error("\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4");var o=[],a=[],l=[];return null!=e&&(o.push("product_id"),a.push(e),l.push("=")),null!=t&&(o.push("record_type"),a.push(t.code),l.push("=")),null!=n&&(o.push("happen_time"),a.push(n.timeStr()),l.push(">")),null!=r&&(o.push("happen_time"),a.push(r.timeStr()),l.push("<")),this.convert(null===(i=Qe.db)||void 0===i?void 0:i.selectAndOrder(this.tablename,o,a,l,["happen_time desc","gmt_modified desc"]))}},{key:"selectBySellId",value:function(e){var t;return this.convert(null===(t=Qe.db)||void 0===t?void 0:t.select(this.tablename,["buy_sell_id"],[e],["="]))}},{key:"deleteBySellId",value:function(e){var t;null===(t=Qe.db)||void 0===t||t.delete(this.tablename,["buy_sell_id"],[e],["="])}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(P.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=new E;o.id=i[0],o.gmtCreate=new Date(i[1]),o.gmtModified=new Date(i[2]),o.productId=i[3],o.productName=i[4],o.productType=L.getByCode(i[5]),o.money=i[6],o.happenTime=new Date(i[7]),o.buySellId=i[8],o.recordType=A.getByCode(i[9]),o.count=i[10],t.push(o)}}catch(a){r.e(a)}finally{r.f()}return t}}]),n}(k),C=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).name=null,e.type=null,e.desc=null,e.fixVote=null,e}return Object(o.a)(n,[{key:"save",value:function(){this.gmtModified=new Date,x.isNull(this.fixVote)&&(this.fixVote=0),n.repo.upsert(this)}}],[{key:"queryAll",value:function(){return this.repo.selectAll()}},{key:"delete",value:function(e){n.repo.delete(e)}}]),n}(S);C.repo=new _;var E=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).productId=null,e.productName=null,e.productType=null,e.money=null,e.count=null,e.happenTime=null,e.buySellId=null,e.recordType=null,e}return Object(o.a)(n,[{key:"save",value:function(){return this.gmtModified=new Date,n.repo.upsert(this)}},{key:"delete",value:function(){this.recordType.code===A.BuySell.code&&n.repo.deleteBySellId(this.id),n.repo.delete(this.id)}}],[{key:"query",value:function(e){return this.repo.get(e)}},{key:"queryTimeBetwen",value:function(e,t,n,r){return this.repo.select(e,t,n,r)}}]),n}(S);E.repo=new N;var A=function(){function e(t,n){Object(i.a)(this,e),this.code=t,this.name=n}return Object(o.a)(e,null,[{key:"getByCode",value:function(e){var t,n=Object(P.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"values",value:function(){return[this.BuySell,this.CurrentPrice,this.Profit,this.AssetDebtCurrentPrice,this.AssetDebtProfit]}}]),e}();A.BuySell=new A(1,"\u4e70\u5165\u6216\u5356\u51fa"),A.CurrentPrice=new A(2,"\u6295\u8d44\u7c7b\u73b0\u4ef7"),A.Profit=new A(3,"\u6295\u8d44\u7c7b\u6536\u76ca"),A.AssetDebtCurrentPrice=new A(4,"\u8d44\u4ea7/\u8d1f\u503a\u7c7b\u73b0\u4ef7"),A.AssetDebtProfit=new A(5,"\u8d44\u4ea7/\u8d1f\u503a\u7c7b\u6536\u76ca");var L=function(){function e(t,n){Object(i.a)(this,e),this.code=t,this.name=n}return Object(o.a)(e,[{key:"isAsset",value:function(){return this===e.Product.saving}},{key:"isDebt",value:function(){return this===e.Product.debt}},{key:"isStock",value:function(){return this===e.Product.stock}},{key:"isFund",value:function(){return this===e.Product.stock_fund||this===e.Product.etf||this===e.Product.bond}}],[{key:"getByCode",value:function(e){var t,n=Object(P.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"toList",value:function(t){if(t instanceof e)return[t];for(var n=[],r=0,i=Object.keys(t);r<i.length;r++){var o=i[r];n=n.concat(this.toList(t[o]))}return n}},{key:"values",value:function(){return this.toList(this.Product)}}]),e}();L.Product={saving:new L(1e6,"\u73b0\u91d1\u7c7b\u8d44\u4ea7"),stock_fund:new L(2e6,"\u80a1\u7968\u7c7b\u57fa\u91d1"),etf:new L(3e6,"\u6307\u6570\u7c7b\u57fa\u91d1"),bond:new L(4e6,"\u503a\u5238\u7c7b\u57fa\u91d1"),stock:new L(5e6,"\u80a1\u7968"),debt:new L(6e6,"\u8d1f\u503a")};var q=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"getProductTypes",value:function(){return L.toList(L.Product)}},{key:"upsertProduct",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=new C;i.id=r,i.type=L.getByCode(e),i.desc=n,i.name=t,i.save()}},{key:"queryProducts",value:function(){return C.queryAll()}},{key:"editProduct",value:function(e,t,n){e.fixVote=n,e.desc=t,e.save()}},{key:"deleteProduct",value:function(e){C.delete(e.id)}},{key:"getAllInvestDetailBefore",value:function(e){var t=this,n=E.queryTimeBetwen(null,null,null,e),r={fund:{},stock:{},asset:{},debt:{}};return n.forEach((function(e){t.dealDetail(e,r)})),r}},{key:"dealDetail",value:function(e,t){var n=null;return n=e.productType.isAsset()?t.asset:e.productType.isDebt()?t.debt:e.productType.isStock()?t.stock:t.fund,x.isNull(n[e.productId])&&(n[e.productId]={}),(n=n[e.productId]).info=e,e.recordType==A.CurrentPrice||e.recordType==A.AssetDebtCurrentPrice?void 0===n.currentPrice&&(n.currentPrice=e):e.recordType==A.Profit||e.recordType==A.AssetDebtProfit?(x.isNull(n.profits)&&(n.profits={totalMoney:0,datas:[]}),n.profits.totalMoney+=e.money,n.profits.datas.push(e)):e.recordType==A.BuySell&&(x.isNull(n.buySells)&&(n.buySells={totalMoney:0,totalSellMoney:0,totalCount:0,datas:[]}),x.notNumber(e.count)||(n.buySells.totalCount+=e.count),n.buySells.totalMoney+=e.money,e.money<0&&(n.buySells.totalSellMoney+=e.money),n.buySells.datas.push(e)),t}},{key:"getProductTotalBuySellBefore",value:function(e,t){return E.queryTimeBetwen(e,A.BuySell,null,t)}},{key:"addAssetDebtProfit",value:function(e,t,n,r,i,o){x.notNumber(r)||0==r||this._upsertInvest(e,t,n,r,o,A.AssetDebtProfit),this._upsertInvest(e,t,n,i,o,A.AssetDebtCurrentPrice)}},{key:"addBuyInvest",value:function(e,t,n,r,i,o,a){var l=this._upsertInvest(e,t,n,i,a,A.BuySell,r);this._upsertInvest(e,t,n,o,a,A.CurrentPrice,null,l)}},{key:"addSellInvest",value:function(e,t,n,r,i,o,a,l){var c=0;this.getProductTotalBuySellBefore(e,new Date(l.getTime()+1e3)).forEach((function(e){c+=e.money}));var u=c-(o-a),s=i-u;console.log("totalInvestMoney: ".concat(c," currentProfit: ").concat(a," currentPrice: ").concat(o," principal: ").concat(u," sellGetMoney: ").concat(i," sellProfit: ").concat(s)),this.addSellInvestOfProfit(e,t,n,r,i,s,o,l)}},{key:"addSellInvestOfProfit",value:function(e,t,n,r,i,o,a,l){var c=i-o;x.notNumber(r)||(r*=-1);var u=this._upsertInvest(e,t,n,-1*c,l,A.BuySell,r);a>=0&&this._upsertInvest(e,t,n,a,l,A.CurrentPrice,null,u),this._upsertInvest(e,t,n,o,l,A.Profit,null,u)}},{key:"deleteInvestDetail",value:function(e){e.delete()}},{key:"_upsertInvest",value:function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=new E;return u.id=c,u.productId=e,u.productName=t,u.productType=L.getByCode(n),u.money=r,u.count=a,u.happenTime=i,u.buySellId=l,u.recordType=o,u.save()}}]),e}(),B=q,R=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"queryMonthData",value:function(e){return this._calIncomeExpendData(T.queryMonth(e))}},{key:"queryYearData",value:function(e){var t=this._calIncomeExpendData(T.queryTimeBetwen(O.monthStart(e),O.yearEnd(e))),n=this._calSumByMonth(t.income.details),r=this._calSumByMonth(t.expend.details);return t.income.sumByMonth=n,t.expend.sumByMonth=r,t}},{key:"_calSumByMonth",value:function(e){var t,n={},r=Object(P.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=O.monthStr(i.happenTime);o in n||(n[o]=0),n[o]+=i.money}}catch(a){r.e(a)}finally{r.f()}return Object.keys(n).map((function(e){return{month:e,total:n[e]}}))}},{key:"_calIncomeExpendData",value:function(e){var t=this,n={income:{total:0,details:[]},expend:{total:0,details:[]}};return e.sort((function(e,t){return Math.abs(e.type.code)>Math.abs(t.type.code)?1:-1})).forEach((function(e){var r=n.expend;e.type.code>0&&(r=n.income),r.details.push(t._newEntityFromDetail(e)),r.total+=e.money})),n}},{key:"_newEntityFromDetail",value:function(e){return{id:e.id,happenTime:e.happenTime,title:e.type.name,money:e.money,desc:e.desc,type:e.type}}}]),e}(),V=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"queryMonthData",value:function(e){var t=O.monthStart(e),n=O.monthEnd(e),r=B.getAllInvestDetailBefore(n);return{asset:this._getInvestSummary(r.asset,t,n),debt:this._getInvestSummary(r.debt,t,n),fund:this._getInvestSummary(r.fund,t,n),stock:this._getInvestSummary(r.stock,t,n)}}},{key:"queryYearData",value:function(e){var t=O.monthStart(e),n=O.yearEnd(e),r=B.getAllInvestDetailBefore(n);return{asset:this._getInvestSummary(r.asset,t,n),debt:this._getInvestSummary(r.debt,t,n),fund:this._getInvestSummary(r.fund,t,n),stock:this._getInvestSummary(r.stock,t,n)}}},{key:"getPaperProfit",value:function(e){var t,n;return x.isNull(e)?0:(null===(t=e.currentPrice)||void 0===t?void 0:t.money)-(null===(n=e.buySells)||void 0===n?void 0:n.totalMoney)}},{key:"getPaperProfitPercent",value:function(e){var t;return g.safeDivision(this.getPaperProfit(e),null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)}},{key:"getSellProfitPercent",value:function(e){var t,n;return g.safeDivision(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney,Math.abs(null===(n=e.buySells)||void 0===n?void 0:n.filterSellMoney))}},{key:"_getInvestSummary",value:function(e,t,n){var r=this._getProfitSummary(e,t,n);return{totalMoneys:this._getTotalMoney(e),totalProfitMoneys:[r[0],r[1]],products:r[2]}}},{key:"_getProfitSummary",value:function(e,t,n){for(var r=0,i=0,o={},a=0,l=Object.keys(e);a<l.length;a++){var c=l[a],u=e[c];x.isNull(u.profits)||function(){var e=0,o=[];u.profits.datas.forEach((function(r){O.inTime(r.happenTime,t,n)&&(e+=r.money,o.push(r))})),r+=u.profits.totalMoney,0!==e&&(i+=e,u.profits.filterDatas=o,u.profits.filterTotalMoney=e)}(),x.isNull(u.buySells)||function(){var e=0,r=0,i=0,o=[];u.buySells.datas.forEach((function(a){O.inTime(a.happenTime,t,n)&&0!==a.money&&(e+=a.money,a.money<0&&(r+=a.money),x.notNumber(a.count)||(i+=a.count),o.push(a))})),u.buySells.filterMoney=e,u.buySells.filterSellMoney=r,u.buySells.filterTotalCount=i,u.buySells.filterDatas=o}(),o[c]=u}return[r,i,o]}},{key:"_getTotalMoney",value:function(e){for(var t=0,n=0,r=0,i=Object.keys(e);r<i.length;r++){var o=e[i[r]];x.isNull(o.currentPrice)||(t+=o.currentPrice.money),x.isNull(o.buySells)||(n+=o.buySells.totalMoney)}return[t,n]}}]),e}(),U=n(9),K=(b.a.Title,b.a.Paragraph,b.a.Text),F=(b.a.Link,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={},r.testResults=[],r.group="default",r.resultColumns=[{title:"id",key:"id",dataIndex:"entity",render:function(e){return Object(U.jsx)(K,{children:e.id})}},{title:"success",key:"success",dataIndex:"entity",render:function(e){var t="green";return e.success||(t="red"),Object(U.jsx)(f.a,{color:t,children:e.success?"Success":"Fail"})}},{title:"group",key:"group",dataIndex:"entity",render:function(e){return Object(U.jsx)(K,{children:e.group})}},{title:"msg",key:"msg",dataIndex:"entity",render:function(e){return Object(U.jsx)(K,{children:e.msg})}},{title:"actual",key:"actual",dataIndex:"entity",render:function(e){return Object(U.jsx)(K,{children:e.actual})}},{title:"expect",key:"expect",dataIndex:"entity",render:function(e){return Object(U.jsx)(K,{children:e.expect})}}],r}return Object(o.a)(n,[{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"_expect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r={};(r=t===e?{group:this.group,success:!0,msg:n,expect:t,actual:e}:{group:this.group,success:!1,msg:n,expect:t,actual:e}).id=this.testResults.length+1,this.testResults.push(r)}},{key:"_testIncomeExpend",value:function(){this.group="_testIncomeExpend";var e=R.queryMonthData(new Date("2022-11"));this._expect(e.income.total,3007018),this._expect(e.income.details.length,2),this._expect(e.expend.total,-826853),this._expect(e.expend.details.length,17);var t=R.queryMonthData(new Date("2022-10"));this._expect(t.income.total,3260514),this._expect(t.income.details.length,3),this._expect(t.expend.total,-1809859),this._expect(t.expend.details.length,20);var n=R.queryYearData(new Date("2021-04"));this._expect(n.income.total,14980332),this._expect(n.income.details.length,9),this._expect(n.income.sumByMonth.length,4),this._expect(n.expend.total,-164667437),this._expect(n.expend.details.length,51),this._expect(n.expend.sumByMonth.length,4)}},{key:"_testInvestData",value:function(){this.group="_testInvestData";var e=V.queryMonthData(new Date("2022-10"));this._expect(e.asset.totalMoneys[0],17330631),this._expect(e.asset.totalProfitMoneys[1],7500),this._expect(e.asset.totalMoneys[1],0),this._expect(e.debt.totalMoneys[0],-894467),this._expect(e.debt.totalProfitMoneys[1],-85e4),this._expect(e.debt.totalMoneys[1],0),this._expect(e.fund.totalMoneys[0],50981840),this._expect(e.fund.totalProfitMoneys[1],0),this._expect(e.fund.totalMoneys[1],57218750),this._expect(e.stock.totalMoneys[0],21153610),this._expect(e.stock.totalProfitMoneys[1],28250),this._expect(e.stock.totalMoneys[1],24719638);var t=V.queryMonthData(new Date("2022-11"));this._expect(t.asset.totalMoneys[0],16241803),this._expect(t.asset.totalProfitMoneys[1],2650),this._expect(t.asset.totalMoneys[1],0),this._expect(t.debt.totalMoneys[0],-6e3),this._expect(t.debt.totalProfitMoneys[1],-15e5),this._expect(t.debt.totalMoneys[1],0),this._expect(t.fund.totalMoneys[0],54335438),this._expect(t.fund.totalProfitMoneys[1],0),this._expect(t.fund.totalMoneys[1],58088750),this._expect(t.stock.totalMoneys[0],21522750),this._expect(t.stock.totalProfitMoneys[1],-20),this._expect(t.stock.totalMoneys[1],24677398)}},{key:"testAll",value:function(){this.testResults=[],this._testIncomeExpend(),this._testInvestData(),this.refreshPage()}},{key:"render",value:function(){var e=this;return Object(U.jsxs)(I.Content,{className:"Content",children:[Object(U.jsxs)(j.a,{orientation:"center",children:["\u7248\u672c\uff1a",Qe.getVersion()]}),Object(U.jsxs)(p.a,{style:{padding:"10px 50px 50px",backgroundColor:"#eee",margin:"10px 0"},children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u6d4b\u8bd5\u6309\u94ae"}),Object(U.jsx)(v.a,{onClick:function(){return e.testAll()},children:"\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b"})]}),Object(U.jsx)(m.a,{columns:this.resultColumns,dataSource:this.testResults.filter((function(e){return!e.success})).map((function(e,t){return{key:t,entity:e}}))})]})}}]),n}(u.a.Component)),Y=F,z=n(800),G=n(375),H=n(204),$=n(12),Q=n(243),J=n(810),W=n(123),X=n(809),Z=n(3),ee=n(526),te=n(807),ne=n(804),re=n(805),ie=n(104),oe=n.n(ie),ae=Q.a.Option,le=(z.a.Header,z.a.Content,z.a.Sider,b.a.Title,b.a.Paragraph,b.a.Text),ce=(b.a.Link,["type","name","desc","money","currentPrice","currentProfit","sellProfit","count","date"]),ue=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state=r.getInitialState(),r}return Object(o.a)(n,[{key:"getInitialState",value:function(){var e={};return ce.forEach((function(t){e[t]=null})),e}},{key:"getOpts",value:function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.push(Object(U.jsx)(ae,{value:i,children:e[i][0]},i))}return t}},{key:"itemToWidget",value:function(e){var t,n,r,i,o,a=this,l=e.name,c=null!==(t=e.required)&&void 0!==t&&t?"(\u5fc5\u586b)":"",u="",s=e.defaultValue;switch(x.isNull(this.state[l])&&!x.isNull(s)&&(this.state[l]=s),e.name){case"type":var d=l+"Name",y=l+"ParentCode",h=l+"ParentName",f=this.getOpts(e.code2Name);return Object(U.jsxs)(p.a,{align:"middle",children:[Object(U.jsx)(W.a,{span:8,children:Object(U.jsxs)(le,{children:["\u7c7b\u578b",c,":"]})}),Object(U.jsx)(W.a,{flex:"auto",align:"center",children:Object(U.jsx)(Q.a,{style:{width:"150px"},value:this.state[l],onChange:function(t){var n;a.setState((n={},Object(Z.a)(n,l,t),Object(Z.a)(n,d,e.code2Name[t][0]),Object(Z.a)(n,y,e.code2Name[t][1]),Object(Z.a)(n,h,e.code2Name[t][2]),n))},children:f})})]});case"name":return Object(U.jsxs)(p.a,{align:"middle",style:{margin:"10px 0"},children:[Object(U.jsx)(W.a,{span:8,children:Object(U.jsxs)(le,{children:["\u540d\u79f0",c,":"]})}),Object(U.jsx)(W.a,{flex:"auto",align:"center",children:Object(U.jsx)(ee.a,{placeholder:"\u540d\u79f0",style:{width:"150px"},value:this.state[l],onChange:function(e){a.setState(Object(Z.a)({},l,e.target.value))}})})]});case"money":case"currentPrice":case"currentProfit":case"sellProfit":case"count":var v=e.moneyPon;u=null!==(n=e.hint)&&void 0!==n?n:"\u91d1\u989d";var m=l+"Pon";return this.state[m]=v,Object(U.jsxs)(p.a,{align:"middle",style:{margin:"10px 0"},children:[Object(U.jsx)(W.a,{span:8,children:Object(U.jsxs)(le,{children:[u,c,":"]})}),Object(U.jsx)(W.a,{flex:"auto",align:"center",children:Object(U.jsx)(te.a,{style:{width:"150px"},addonBefore:v?"+":"-",value:this.state[l],onChange:function(e){a.setState(Object(Z.a)({},l,e))}})})]});case"date":x.isNull(e.inMonth)||!x.isNull(this.state[l])&&O.inMonth(this.state[l],new Date(e.inMonth))||(this.state[l]=new Date(e.inMonth)),u=null!==(r=e.hint)&&void 0!==r?r:"\u53d1\u751f\u65e5\u671f";var b=null!==(i=e.picker)&&void 0!==i?i:"";return Object(U.jsxs)(p.a,{align:"middle",style:{margin:"10px 0"},children:[Object(U.jsx)(W.a,{span:8,children:Object(U.jsxs)(le,{children:[u,c,":"]})}),Object(U.jsx)(W.a,{flex:"auto",align:"center",children:Object(U.jsx)(ne.a,{style:{width:"150px"},picker:b,value:oe()(this.state[l]),onChange:function(e,t){a.setState(Object(Z.a)({},l,e.toDate()))}})})]});case"desc":return u=null!==(o=e.hint)&&void 0!==o?o:"\u63cf\u8ff0",Object(U.jsxs)(p.a,{align:"middle",style:{margin:"10px 0"},children:[Object(U.jsx)(W.a,{span:8,children:Object(U.jsxs)(le,{children:[u,c,":"]})}),Object(U.jsx)(W.a,{flex:"auto",align:"center",children:Object(U.jsx)(ee.a,{placeholder:"\u63cf\u8ff0",style:{width:"150px"},value:this.state[l],onChange:function(e){a.setState(Object(Z.a)({},l,e.target.value))}})})]});default:return Object(U.jsx)(p.a,{children:Object(U.jsxs)(le,{children:["\u672a\u652f\u6301\u8f93\u5165\u914d\u7f6e ",e.name]})})}}},{key:"checkData",value:function(e,t){try{var n=e[t.name];if(!0===t.required&&x.isNull(n))throw new Error(t.name+" \u5fc5\u987b\u8f93\u5165");if(!0===t.isNum&&isNaN(n))throw new Error(t.name+" \u5fc5\u987b\u4e3a\u6570\u5b57");if(!x.isNull(t.inMonth)&&!O.inMonth(n,new Date(t.inMonth)))throw new Error("\u53d1\u751f\u65e5\u671f\u4ec5\u53ef\u9009\u5728\u5f53\u524d\u6708\u4efd\uff1a"+t.inMonth);return!0}catch(r){return console.warn(r),alert(r),!1}}},{key:"render",value:function(){var e,t,n=this,r=[],i=Object(P.a)(this.props.cfgs);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push(this.itemToWidget(o))}}catch(a){i.e(a)}finally{i.f()}return Object(U.jsxs)(re.a,{title:null!==(e=this.props.title)&&void 0!==e?e:"\u65b0\u589e",style:{margin:"0px 5px"},bodyStyle:{padding:"25px"},children:[r,Object(U.jsx)(p.a,{justify:"center",style:{margin:"15px 0 0 0"},children:Object(U.jsx)(W.a,{children:Object(U.jsx)(v.a,{type:"primary",onClick:function(){var e,t=Object(P.a)(n.props.cfgs);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!n.checkData(n.state,r))return}}catch(a){t.e(a)}finally{t.f()}n.props.onSubmit(n.state)&&n.setState(n.getInitialState())},children:" \u63d0\u4ea4 "})})})]})}}],[{key:"getMoney",value:function(e,t){var n=e[t+"Pon"]?1:-1;return x.notNumber(e[t])?NaN:e[t]*n*100}}]),n}(u.a.Component),se=(b.a.Title,b.a.Paragraph,b.a.Text),de=(b.a.Link,function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"getProductTag",value:function(e){return Object(U.jsx)(f.a,{color:this._getProductColor(e),children:e.name},e.code)}},{key:"_getProductColor",value:function(e){return e.isAsset()?"geekblue":e.isDebt()?"green":e.isStock()?"red":"gold"}},{key:"createShowTextRow",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Object(U.jsxs)(p.a,{align:"middle",style:{margin:"0 10px",padding:"4px 0"},children:[Object(U.jsx)(W.a,{span:12,children:Object(U.jsx)(se,{type:n,strong:!0,children:e})}),Object(U.jsx)(W.a,{span:12,align:"right",children:Object(U.jsx)(se,{type:n,strong:!0,children:t})})]})}}]),e}()),ye=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).tablename="data_summary",e}return Object(o.a)(n,[{key:"upsert",value:function(e){var t,n,r=k.getDateStr(e.gmtCreate,!0),i=k.getDateStr(e.gmtModified);null==e.id?null===(t=Qe.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","type","time","money"],[r,i,e.type.code,e.time.timeStr(),e.money]):null===(n=Qe.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","type","time","money"],[r,i,e.type.code,e.time.timeStr(),e.money])}},{key:"selectAllMonthKey",value:function(){var e;return this.convert(null===(e=Qe.db)||void 0===e?void 0:e.select(this.tablename,["type"],[fe.BY_MONTH_KEY.code],["="]))}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(P.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=new he;o.id=i[0],o.gmtCreate=new Date(i[1]),o.gmtModified=new Date(i[2]),o.type=fe.getByCode(i[3]),o.time=new Date(i[4]),o.money=i[5],t.push(o)}}catch(a){r.e(a)}finally{r.f()}return t}}]),n}(k),he=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).type=null,e.time=null,e.money=null,e}return Object(o.a)(n,[{key:"save",value:function(){this.gmtModified=new Date,n.repo.upsert(this)}}],[{key:"queryAllMonthKey",value:function(){return this.repo.selectAllMonthKey()}},{key:"delete",value:function(e){this.repo.delete(e)}}]),n}(S);he.repo=new ye;var fe=function(){function e(t,n){Object(i.a)(this,e),this.code=t,this.name=n}return Object(o.a)(e,null,[{key:"getByCode",value:function(e){var t,n=Object(P.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"values",value:function(){return[this.BY_MONTH_KEY]}}]),e}();fe.BY_MONTH_KEY=new fe(1,"\u6309\u6708\u5c55\u793a\u7684\u53ef\u7528\u6708\u4efd");var pe=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"addMonth",value:function(e){var t=new he;t.type=fe.BY_MONTH_KEY,t.time=O.monthStart(e),t.save()}},{key:"queryMonths",value:function(){var e=he.queryAllMonthKey();return console.log(e),e.map((function(e){return O.monthStr(e.time)}))}}]),e}(),ve=n(808),me=function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={},r}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props.title,n=this.props.visible,r=this.props.cfgs;return Object(U.jsx)(ve.a,{title:t,visible:n,footer:null,onCancel:function(){return e.props.onCancel()},children:Object(U.jsx)(ue,{title:"",cfgs:r,onSubmit:function(t){return e.props.onOk(t)}},this.props.key)})}}]),n}(u.a.Component),be=(Q.a.Option,z.a.Header,z.a.Content),je=z.a.Sider,ge=(b.a.Title,b.a.Paragraph,b.a.Text),xe=(b.a.Link,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={},r.incomeExpendColumns=[{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){var t="geekblue";return"\u4e3b\u52a8\u6536\u5165"===e.title||"\u88ab\u52a8\u6536\u5165"===e.title?t="red":"\u4e3b\u52a8\u652f\u51fa"!==e.title&&"\u88ab\u52a8\u652f\u51fa"!==e.title||(t="green"),Object(U.jsx)(f.a,{color:t,children:e.title},e.title)}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(e.money)})}}],r.subIncomeExpendColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:O.dayStr(e.happenTime)})}},{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:e.title})}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(e.money)})},sorter:function(e,t){return g.compareAbs(e.entity.money,t.entity.money)}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:e.desc})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){if(!x.isNull(t.entity.id))return Object(U.jsx)(J.b,{size:"middle",children:Object(U.jsx)("a",{onClick:function(){r.deleteIncomeExpendDetail(t.entity.id)},children:"\u5220\u9664"})})}}],r.assetDebtColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return de.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:e.info.productName})}},{title:"\u6700\u65b0\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){var t,n,i="";return O.inMonth(null===(t=e.currentPrice)||void 0===t?void 0:t.happenTime,r.monthDate)||(i="secondary"),Object(U.jsx)(ge,{type:i,children:O.dayStr(null===(n=e.currentPrice)||void 0===n?void 0:n.happenTime)})}},{title:"\u603b\u989d",key:"currentPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}}],r.subAssetDebtColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:O.dayStr(e.happenTime)})}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(e.money)})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(U.jsx)(J.b,{size:"middle",children:Object(U.jsx)("a",{onClick:function(){r.deleteInvestDetail(t.entity)},children:"\u5220\u9664"})})}}],r.investColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return de.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:e.info.productName})}},{title:"\u6700\u65b0\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){var t,n,i="";return O.inMonth(null===(t=e.currentPrice)||void 0===t?void 0:t.happenTime,r.monthDate)||(i="secondary"),Object(U.jsx)(ge,{type:i,children:O.dayStr(null===(n=e.currentPrice)||void 0===n?void 0:n.happenTime)})}},{title:"\u5356\u51fa\u603b\u989d",key:"sellPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(Math.abs(null===(t=e.buySells)||void 0===t?void 0:t.filterSellMoney))})},sorter:function(e,t){var n,r;return g.compareAbs(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterSellMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterSellMoney)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=V.getSellProfitPercent(e);return Object(U.jsx)(ge,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=V.getSellProfitPercent(e.entity),r=V.getSellProfitPercent(t.entity);return x.compare(n,r)}},{title:"\u5356\u51fa\u5229\u6da6",key:"sellProfit",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}},{title:"\u5f53\u671f\u6295\u8d44",key:"timeInvest",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(null===(t=e.buySells)||void 0===t?void 0:t.filterMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterMoney)}},{title:"\u5f53\u671f\u8d26\u9762\u5229\u6da6",key:"qoqPaperProfit",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(r.getQoqPaperProfit(e))})},sorter:function(e,t){return g.compare(r.getQoqPaperProfit(e.entity),r.getQoqPaperProfit(t.entity))}},{title:"\u5f53\u671f\u8d26\u9762\u5229\u6da6\u7387",key:"qoqPaperProfitPercent",dataIndex:"entity",render:function(e){var t=r.getQoqPaperProfitPercent(e);return Object(U.jsx)(ge,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=r.getQoqPaperProfitPercent(e.entity),i=r.getQoqPaperProfitPercent(t.entity);return x.compare(n,i)}},{title:"\u6295\u8d44\u603b\u989d",key:"totalInvest",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalMoney)}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=V.getPaperProfitPercent(e);return Object(U.jsx)(ge,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=V.getPaperProfitPercent(e.entity),r=V.getPaperProfitPercent(t.entity);return x.compare(n,r)}},{title:"\u8d26\u9762\u5229\u6da6",key:"paperProfit",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(V.getPaperProfit(e))})},sorter:function(e,t){return g.compare(V.getPaperProfit(e.entity),V.getPaperProfit(t.entity))}},{title:"\u6700\u65b0\u4ef7\u503c",key:"lastPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getDetailStr(g.safeDivision(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney,e.buySells.totalCount))})}},{title:"\u73b0\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(ge,{children:g.getDetailStr(g.safeDivision(null===(t=e.currentPrice)||void 0===t?void 0:t.money,e.buySells.totalCount))})}}],r.subInvestColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:O.dayStr(e.happenTime)})}},{title:"\u4e70\u5165/\u5356\u51fa\u672c\u91d1",key:"principal",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(e.money)})}},{title:"\u5230\u8d26\u603b\u989d",key:"sellGetMoney",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(Math.abs(e.money)+e.profitMoney)})}},{title:"\u5229\u6da6",key:"profit",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getStr(e.profitMoney)})}},{title:"\u5229\u6da6\u7387",key:"profitPercent",dataIndex:"entity",render:function(e){var t=g.safeDivision(e.profitMoney,Math.abs(e.money));return Object(U.jsx)(ge,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getDetailStr(g.safeDivision(Math.abs(e.money),Math.abs(e.count)))})}},{title:"\u5356\u51fa\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(ge,{children:g.getDetailStr(g.safeDivision(Math.abs(-1*e.money+e.profitMoney),Math.abs(e.count)))})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(U.jsx)(J.b,{size:"middle",children:Object(U.jsx)("a",{onClick:function(){r.deleteInvestDetail(t.entity)},children:"\u5220\u9664"})})}}],r}return Object(o.a)(n,[{key:"getQoqPaperProfit",value:function(e){var t=V.getPaperProfit(this._getLastMonthProductDetail(e.info.productId));return V.getPaperProfit(e)-t}},{key:"getQoqPaperProfitPercent",value:function(e){var t;return g.safeDivision(this.getQoqPaperProfit(e),null===e||void 0===e||null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)}},{key:"_getLastMonthProductDetail",value:function(e){for(var t=0,n=[this.lastMonthAllInvestData.fund,this.lastMonthAllInvestData.stock,this.lastMonthAllInvestData.asset,this.lastMonthAllInvestData.debt];t<n.length;t++){var r=n[t];if(e in r.products)return r.products[e]}return null}},{key:"insertData",value:function(e){try{var t,n=ue.getMoney(e,"money"),r=e.date;return T.upsert(n,D.getByCode(e.type),r,null!==(t=e.desc)&&void 0!==t?t:""),this.refreshPage(),!0}catch(i){return console.warn(i),alert(i),!1}}},{key:"addBuyInvest",value:function(e){var t=e.type,n=e.typeName,r=e.typeParentCode,i=ue.getMoney(e,"money"),o=ue.getMoney(e,"currentPrice"),a=e.count,l=e.date;return B.addBuyInvest(t,n,r,a,i,o,l),this.refreshPage(),!0}},{key:"addSellInvest",value:function(e){var t=e.type,n=e.typeName,r=e.typeParentCode,i=e.count,o=ue.getMoney(e,"money"),a=ue.getMoney(e,"currentPrice"),l=ue.getMoney(e,"currentProfit"),c=ue.getMoney(e,"sellProfit"),u=e.date;if(x.notNumber(c)){if(x.notNumber(l))return G.b.error("\u5356\u51fa\u5229\u6da6 \u6216 \u8d26\u9762\u5229\u6da6 \u5fc5\u987b\u586b\u5199\u4e00\u4e2a\uff01"),!1;B.addSellInvest(t,n,r,i,o,a,l,u)}else B.addSellInvestOfProfit(t,n,r,i,o,c,a,u);return this.refreshPage(),!0}},{key:"addAssetDebtProfit",value:function(e){var t=e.type,n=e.typeName,r=e.typeParentCode,i=ue.getMoney(e,"money"),o=ue.getMoney(e,"currentPrice"),a=e.date;return B.addAssetDebtProfit(t,n,r,i,o,a),this.refreshPage(),!0}},{key:"deleteInvestDetail",value:function(e){B.deleteInvestDetail(e),this.refreshPage()}},{key:"deleteIncomeExpendDetail",value:function(e){T.delete(e),this.refreshPage()}},{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"getByMonthSideDatas",value:function(){var e=pe.queryMonths();this.months=e;var t={};return e.forEach((function(e){var n=e.substring(0,4);x.isNull(t[n])&&(t[n]=[]),t[n].push(e)})),console.log(t),t}},{key:"showAddNewMonthDialog",value:function(){this.setState({showDialog:"addNewMonth"})}},{key:"addNewMoth",value:function(e){isNaN(e)?G.b.error("\u8bf7\u8f93\u5165\u6709\u6548\u6708\u4efd\uff0c\u5982 2022-5"):this.months.includes(O.monthStr(e))?(G.b.error("\u5df2\u6709\u5f53\u524d\u6708\u4efd"),this.hideDialog()):(pe.addMonth(e),this.state.sideKey=O.monthStr(e),this.hideDialog())}},{key:"hideDialog",value:function(){this.setState({showDialog:""})}},{key:"render",value:function(){var e,t=this,n=[],r=this.getByMonthSideDatas(),i=null;e=Object.keys(r).sort((function(e,t){return t>e?1:-1})).map((function(e,t){return n.push(e),{key:e,label:e,children:r[e].sort((function(e,t){return t>e?1:-1})).map((function(e,t){return null==i&&(i=e),{key:e,label:e}}))}})),x.isNull(this.state.sideKey)&&(this.state.sideKey=i),this.monthDate=new Date(this.state.sideKey);var o=this.monthDate;if(x.notNumber(o))return Object(U.jsx)(be,{});console.log("month page render ",o);var a={},l={};D.toList(T.getExpenditureTypes()).forEach((function(e){a[e.code]=[e.name]})),D.toList(T.getIncomeTypes()).forEach((function(e){l[e.code]=[e.name]}));var c={},u={},s={};B.queryProducts().forEach((function(e){e.type.isAsset()?u[e.id]=[e.name,e.type.code,e.type.name]:e.type.isDebt()?s[e.id]=[e.name,e.type.code,e.type.name]:c[e.id]=[e.name,e.type.code,e.type.name]}));var d=[],y=R.queryMonthData(o),h=y.income.total,f=y.expend.total,b=V.queryMonthData(o),k=this._getPassiveIncomeSummary(b),S=this._getPassiveExpendSummary(b);console.log("===== monthData     =====",y),console.log("===== allInvestData =====",b),this.lastMonthAllInvestData=V.queryMonthData(O.lastMonthEnd(o));var M=this._getTotalMoney(b),w=this._getTotalMoney(this.lastMonthAllInvestData),I=h+f+k.total+S.total;d.push({key:"\u4e3b\u52a8\u6536\u5165",entity:this.newEntity(null,"\u4e3b\u52a8\u6536\u5165",h,null,y.income.details)}),d.push({key:"\u88ab\u52a8\u6536\u5165",entity:this.newEntity(null,"\u88ab\u52a8\u6536\u5165",k.total,null,k.details)}),d.push({key:"\u4e3b\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u4e3b\u52a8\u652f\u51fa",f,null,y.expend.details)}),d.push({key:"\u88ab\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u88ab\u52a8\u652f\u51fa",S.total,null,S.details)}),d.push({key:"\u65b0\u589e\u73b0\u91d1",entity:this.newEntity(null,"\u65b0\u589e\u73b0\u91d1",I,null)}),d.push({key:"\u4e0a\u671f\u603b\u8d44\u4ea7",entity:this.newEntity(null,"\u4e0a\u671f\u603b\u8d44\u4ea7",w,null)});var _=[];_.push(this.newEntity(null,"\u8d44\u4ea7\u603b\u989d",b.asset.totalMoneys[0],null)),_.push(this.newEntity(null,"\u8d1f\u503a\u603b\u989d",b.debt.totalMoneys[0],null)),_.push(this.newEntity(null,"\u6295\u8d44\u603b\u989d",b.fund.totalMoneys[1],"\u8d26\u9762\u4ef7\u503c\uff1a".concat(g.getStr(b.fund.totalMoneys[0])))),_.push(this.newEntity(null,"\u80a1\u7968\u603b\u989d",b.stock.totalMoneys[1],"\u8d26\u9762\u4ef7\u503c\uff1a".concat(g.getStr(b.stock.totalMoneys[0])))),d.push({key:"\u5f53\u524d\u603b\u8d44\u4ea7",entity:this.newEntity(null,"\u5f53\u524d\u603b\u8d44\u4ea7",M,null,_)});var N=this._mapToList(b.fund.products,!0),C=this._mapToList(b.stock.products,!0),E=[];E.push.apply(E,Object($.a)(this._mapToList(b.asset.products)).concat(Object($.a)(this._mapToList(b.debt.products))));var A=function(e,n){var r=[];return e.entity.buySells.filterDatas.forEach((function(t){var n,i,o,a=Object(P.a)(null!==(n=null===(i=e.entity.profits)||void 0===i?void 0:i.filterDatas)&&void 0!==n?n:[]);try{for(a.s();!(o=a.n()).done;){var l=o.value;if(l.buySellId===t.id){t.profitMoney=l.money;break}}}catch(c){a.e(c)}finally{a.f()}r.push({key:t.id,entity:t})})),Object(U.jsx)(m.a,{columns:t.subInvestColumns,dataSource:r,pagination:!1})},L=function(e){var t,n;return!x.isNull(null===(t=e.entity.buySells)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterDatas.length)>0},q=Object(U.jsxs)(be,{className:"Content",children:[Object(U.jsxs)(p.a,{children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u4f7f\u7528\u6b65\u9aa4"}),Object(U.jsxs)(J.b,{direction:"vertical",children:[Object(U.jsx)(ge,{children:"1. \u8fd8\u6e05\u5404\u8d44\u4ea7\u8d26\u6237\u7684\u501f\u6b3e\uff08\u4fe1\u7528\u5361\uff09\uff0c\u8bb0\u5f55\u8d44\u4ea7\u73b0\u989d"}),Object(U.jsx)(ge,{children:"2. \u8bb0\u5f55 \u652f\u4ed8\u5b9d/\u5fae\u4fe1 \u5f53\u6708\u7684 \u6536\u5165/\u652f\u51fa"}),Object(U.jsx)(ge,{children:"3. \u8bb0\u5f55 \u57fa\u91d1/\u80a1\u7968 \u7684 \u5f53\u6708 \u4e70\u5165/\u5356\u51fa \u64cd\u4f5c\u548c\u5f53\u524d\u73b0\u989d\u7b49\u4fe1\u606f"}),Object(U.jsx)(ge,{children:"4. \u68c0\u67e5 \u603b\u8d44\u4ea7\u73af\u6bd4\u8bef\u5dee \u4fe1\u606f\uff08\u5927\u4e8e0\u8868\u793a\uff1a\u65b0\u589e\u73b0\u91d1\u5c11\u4e86/\u5f53\u524d\u603b\u8d44\u4ea7\u591a\u4e86\uff09\uff0c\u5c3d\u91cf\u4fdd\u6301500\u4ee5\u4e0b"})]})]}),Object(U.jsxs)(p.a,{justify:"space-between",style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u65b0\u589e\u6536\u5165/\u652f\u51fa"}),Object(U.jsxs)(W.a,{span:8,children:[Object(U.jsx)(ue,{title:"\u6536\u5165",cfgs:[{name:"type",code2Name:l,required:!0},{name:"money",required:!0,moneyPon:!0},{name:"date",required:!0,inMonth:o},{name:"desc"}],onSubmit:function(e){return t.insertData(e)}}),Object(U.jsx)(ue,{title:"\u652f\u51fa",cfgs:[{name:"type",code2Name:a,required:!0},{name:"money",required:!0,moneyPon:!1},{name:"date",required:!0,inMonth:o},{name:"desc"}],onSubmit:function(e){return t.insertData(e)}})]}),Object(U.jsxs)(W.a,{span:16,children:[Object(U.jsx)(m.a,{columns:this.incomeExpendColumns,dataSource:d,expandable:{expandedRowRender:function(e,n){var r=[];return e.entity.child.forEach((function(e){r.push({key:x.isNull(e.id)?e.title:e.id,entity:e})})),Object(U.jsx)(m.a,{columns:t.subIncomeExpendColumns,dataSource:r,pagination:!1,sortDirections:["descend"]})},rowExpandable:function(e){return!x.isNull(e.entity.child)&&e.entity.child.length>0}},pagination:{pageSize:20},sortDirections:["descend"]}),Object(U.jsx)(j.a,{orientation:"center",children:"\u6307\u6807"}),de.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u652f\u51fa\uff08\u8d22\u5bcc\u81ea\u6709\u7387\uff09",x.getPercent(k.total/Math.abs(f+S.total))),de.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u4e3b\u52a8\u6536\u5165",x.getPercent(k.total/h)),this.createShowMoneyRowIfBiggerThan("\u603b\u8d44\u4ea7\u73af\u6bd4\u8bef\u5dee",M-w-I,[500,1e3])]})]}),Object(U.jsxs)(p.a,{justify:"space-between",style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u8d44\u4ea7/\u8d1f\u503a"}),Object(U.jsxs)(W.a,{span:8,children:[Object(U.jsx)(ue,{title:"\u8d44\u4ea7",cfgs:[{name:"type",code2Name:u,required:!0},{name:"currentPrice",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!0},{name:"money",hint:"\u6536\u76ca",moneyPon:!0},{name:"date",required:!0,inMonth:o}],onSubmit:function(e){return t.addAssetDebtProfit(e)}}),Object(U.jsx)(ue,{title:"\u8d1f\u503a",cfgs:[{name:"type",code2Name:s,required:!0},{name:"currentPrice",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!1},{name:"money",hint:"\u4e8f\u635f",moneyPon:!1},{name:"date",required:!0,inMonth:o}],onSubmit:function(e){return t.addAssetDebtProfit(e)}})]}),Object(U.jsx)(W.a,{span:16,children:Object(U.jsx)(m.a,{columns:this.assetDebtColumns,dataSource:E,expandable:{expandedRowRender:function(e,n){var r=[];return e.entity.profits.filterDatas.forEach((function(e){r.push({key:e.id,entity:e})})),Object(U.jsx)(m.a,{columns:t.subAssetDebtColumns,dataSource:r,pagination:!1})},rowExpandable:function(e){var t,n;return!x.isNull(null===(t=e.entity.profits)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.profits)||void 0===n?void 0:n.filterDatas.length)>0}},pagination:{pageSize:20},scroll:{x:800},sortDirections:["descend"]})})]}),Object(U.jsxs)(p.a,{style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u6295\u8d44"}),Object(U.jsx)(W.a,{span:10,children:Object(U.jsx)(ue,{title:"\u4e70\u5165\u6295\u8d44",cfgs:[{name:"type",code2Name:c,required:!0},{name:"money",hint:"\u82b1\u8d39\u91d1\u989d",required:!0,moneyPon:!0},{name:"currentPrice",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!0},{name:"count",hint:"\u4efd\u6570",required:!1,moneyPon:!0},{name:"date",required:!0,inMonth:o}],onSubmit:function(e){return t.addBuyInvest(e)}})}),Object(U.jsx)(W.a,{span:14,children:Object(U.jsx)(ue,{title:"\u5356\u51fa\u6295\u8d44",cfgs:[{name:"type",code2Name:c,required:!0},{name:"count",hint:"\u4efd\u6570",required:!1,moneyPon:!0},{name:"money",hint:"\u5356\u51fa\u6240\u5f97\u91d1\u989d",required:!0,moneyPon:!0},{name:"sellProfit",hint:"\u5356\u51fa\u5229\u6da6-\u53ef\u8d1f\uff08\u4e8c\u9009\u4e00\uff09",required:!1,moneyPon:!0},{name:"currentPrice",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!0},{name:"currentProfit",hint:"\u8d26\u9762\u5229\u6da6-\u53ef\u8d1f\uff08\u4e8c\u9009\u4e00\uff09",required:!1,moneyPon:!0},{name:"date",required:!0,inMonth:o}],onSubmit:function(e){return t.addSellInvest(e)}})})]}),Object(U.jsx)(m.a,{columns:this.investColumns,dataSource:C,expandable:{expandedRowRender:A,rowExpandable:L},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(U.jsx)(m.a,{columns:this.investColumns,dataSource:N,expandable:{expandedRowRender:A,rowExpandable:L},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]})]});return Object(U.jsxs)(z.a,{children:[Object(U.jsx)(je,{width:200,children:Object(U.jsx)(H.a,{className:"Menu",mode:"inline",openKeys:n,selectedKeys:[this.state.sideKey],items:e,onSelect:function(e){t.setState((function(){return t.state.sideKey=e.key}))}})}),Object(U.jsxs)(z.a,{className:"Layout-inner",children:[Object(U.jsxs)(p.a,{align:"middle",children:[Object(U.jsx)(W.a,{flex:"auto",children:Object(U.jsx)(X.a,{children:Object(U.jsx)(X.a.Item,{children:this.state.sideKey})})}),Object(U.jsx)(W.a,{span:12,align:"right",children:Object(U.jsx)(v.a,{onClick:function(){return t.showAddNewMonthDialog()},children:"\u65b0\u52a0\u6708\u4efd"})})]}),q]}),Object(U.jsx)(me,{title:"\u65b0\u52a0\u6708\u4efd",visible:"addNewMonth"===this.state.showDialog,cfgs:[{name:"date",hint:"\u6708\u4efd",picker:"month",defaultValue:new Date}],onOk:function(e){return t.addNewMoth(e.date)},onCancel:function(){return t.hideDialog()}})]})}},{key:"createShowMoneyRowIfBiggerThan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="",i=Math.abs(t);return void 0!==n[0]&&(r=i>100*n[1]?"danger":i>100*n[0]?"warning":"success"),de.createShowTextRow(e,g.getStr(t),r)}},{key:"createShowMoneyRowIfSmallerThan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="",i=Math.abs(t);return void 0!==n[0]&&(r=i<100*n[1]?"danger":i<100*n[0]?"warning":"success"),de.createShowTextRow(e,g.getStr(t),r)}},{key:"createShowMoneyRow",value:function(e,t){return de.createShowTextRow(e,g.getStr(t),"")}},{key:"newEntity",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return{happenTime:e,title:t,money:n,desc:r,child:i}}},{key:"_getTotalMoney",value:function(e){var t=e.asset.totalMoneys,n=e.fund.totalMoneys,r=e.stock.totalMoneys,i=e.debt.totalMoneys;return t[0]+i[0]+n[1]+r[1]}},{key:"_mapToList",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=0,i=Object.keys(e);r<i.length;r++){var o,a,l,c,u=i[r],s=e[u];t&&g.noValue(null===(o=s.currentPrice)||void 0===o?void 0:o.money)&&g.noValue(null===(a=s.profits)||void 0===a?void 0:a.filterTotalMoney)&&g.noValue(null===(l=s.buySells)||void 0===l?void 0:l.filterMoney)&&g.noValue(null===(c=s.buySells)||void 0===c?void 0:c.totalMoney)||n.push({key:u,entity:s})}return n}},{key:"_getProductsProfitEntitys",value:function(e){var t=this;if(x.isEmpty(e))return[];var n=[];return Object.keys(e).map((function(r){var i,o=null===(i=e[r].profits)||void 0===i?void 0:i.filterDatas;if(!x.isNull(o)){var a,l=Object(P.a)(o);try{for(l.s();!(a=l.n()).done;){var c=a.value;n.push(t.newEntity(c.happenTime,c.productName,c.money,null))}}catch(u){l.e(u)}finally{l.f()}}})),n}},{key:"_getPassiveIncomeSummary",value:function(e){var t=e.asset,n=e.fund,r=e.stock,i=[];return i.push.apply(i,Object($.a)(this._getProductsProfitEntitys(t.products)).concat(Object($.a)(this._getProductsProfitEntitys(n.products)),Object($.a)(this._getProductsProfitEntitys(r.products)))),{total:t.totalProfitMoneys[1]+n.totalProfitMoneys[1]+r.totalProfitMoneys[1],details:i}}},{key:"_getPassiveExpendSummary",value:function(e){var t=e.debt,n=[];return n.push.apply(n,Object($.a)(this._getProductsProfitEntitys(t.products))),{total:t.totalProfitMoneys[1],details:n}}}]),n}(u.a.Component)),Oe=xe,Pe=(Q.a.Option,z.a.Header,z.a.Content),ke=(z.a.Sider,b.a.Title,b.a.Paragraph,b.a.Text),Se=(b.a.Link,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(U.jsx)(Pe,{className:"Content",children:Object(U.jsx)(ke,{style:{fontSize:"50px"},children:" TODO "})})}}]),n}(u.a.Component)),Me=(Q.a.Option,z.a.Header,z.a.Content),we=(z.a.Sider,b.a.Title,b.a.Paragraph,b.a.Text),De=(b.a.Link,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={},r.investColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){var t="gold";return e.info.productType.isStock()&&(t="red"),Object(U.jsx)(f.a,{color:t,children:e.info.productType.name},e.info.productType.code)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:e.info.productName})}},{title:"\u6700\u65b0\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:O.dayStr(null===(t=e.currentPrice)||void 0===t?void 0:t.happenTime)})}},{title:"\u6295\u8d44\u603b\u989d",key:"totalInvest",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:g.getStr(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalMoney)}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=r.getPagerProfitProcent(e);return Object(U.jsx)(we,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=r.getPagerProfitProcent(e.entity),i=r.getPagerProfitProcent(t.entity);return x.compare(n,i)}},{title:"\u8d26\u9762\u5229\u6da6",key:"paperProfit",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getStr(r.getPagerProfit(e))})},sorter:function(e,t){return g.compare(r.getPagerProfit(e.entity),r.getPagerProfit(t.entity))}},{title:"\u6700\u65b0\u4ef7\u503c",key:"lastPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:g.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u5356\u51fa\u603b\u989d",key:"sellPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:g.getStr(Math.abs(null===(t=e.buySells)||void 0===t?void 0:t.totalSellMoney))})},sorter:function(e,t){var n,r;return g.compareAbs(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalSellMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalSellMoney)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=r.getSellProfitPercent(e);return Object(U.jsx)(we,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=r.getSellProfitPercent(e.entity),i=r.getSellProfitPercent(t.entity);return x.compare(n,i)}},{title:"\u5356\u51fa\u5229\u6da6",key:"sellProfit",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:g.getStr(null===(t=e.profits)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.totalMoney)}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:g.getDetailStr(g.safeDivision(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney,e.buySells.totalCount))})}},{title:"\u73b0\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:g.getDetailStr(g.safeDivision(null===(t=e.currentPrice)||void 0===t?void 0:t.money,e.buySells.totalCount))})}},{title:"\u4efd\u6570",key:"totalCount",dataIndex:"entity",render:function(e){var t,n=null===(t=e.buySells)||void 0===t?void 0:t.totalCount;return Object(U.jsx)(we,{children:0==Math.abs(n)?"-":Math.abs(n)})}}],r.subInvestColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:O.dayStr(e.happenTime)})}},{title:"\u4e70\u5165/\u5356\u51fa\u672c\u91d1",key:"principal",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getStr(e.money)})}},{title:"\u5230\u8d26\u603b\u989d",key:"sellGetMoney",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getStr(-1*e.money+e.profitMoney)})}},{title:"\u5229\u6da6",key:"profit",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getStr(e.profitMoney)})}},{title:"\u5229\u6da6\u7387",key:"profitPercent",dataIndex:"entity",render:function(e){var t=g.safeDivision(e.profitMoney,Math.abs(e.money));return Object(U.jsx)(we,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})}},{title:"\u4efd\u6570",key:"totalCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:0==Math.abs(e.count)?"-":Math.abs(e.count)})}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getDetailStr(g.safeDivision(Math.abs(e.money),Math.abs(e.count)))})}},{title:"\u5356\u51fa\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getDetailStr(g.safeDivision(Math.abs(-1*e.money+e.profitMoney),Math.abs(e.count)))})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(U.jsx)(J.b,{size:"middle",children:Object(U.jsx)("a",{onClick:function(){r.deleteInvestDetail(t.entity)},children:"\u5220\u9664"})})}}],r.productColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){var t,n,r,i,o,a="gold";return null!==(t=e.type)&&void 0!==t&&t.isAsset()?a="geekblue":null!==(n=e.type)&&void 0!==n&&n.isDebt()?a="green":null!==(r=e.type)&&void 0!==r&&r.isStock()&&(a="red"),Object(U.jsx)(f.a,{color:a,children:null===(o=e.type)||void 0===o?void 0:o.name},null===(i=e.type)||void 0===i?void 0:i.code)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:e.name})}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:e.desc})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(U.jsxs)(J.b,{size:"middle",children:[Object(U.jsx)("a",{onClick:function(){r.showEditProductDialog(t.entity)},children:"\u7f16\u8f91"}),Object(U.jsx)("a",{onClick:function(){r.deleteProduct(t.entity)},children:"\u5220\u9664"})]})}}],r.productFixVoteColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return Object(U.jsx)(f.a,{color:"gold",children:e.productTypeName},e.productTypeCode)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:e.productName})}},{title:"\u5b9a\u6295\u989d",key:"fixVote",dataIndex:"entity",render:function(e){return Object(U.jsx)(we,{children:g.getStr(e.productFixVote)})}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=e.paperProfitPercent;return Object(U.jsx)(we,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=e.entity.paperProfitPercent,r=t.entity.paperProfitPercent;return x.compare(n,r)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=e.sellProfitPercent;return Object(U.jsx)(we,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=e.entity.sellProfitPercent,r=t.entity.sellProfitPercent;return x.compare(n,r)}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(we,{children:null===(t=e.product)||void 0===t?void 0:t.desc})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){if(!x.isNull(t.entity.product))return Object(U.jsxs)(J.b,{size:"middle",children:[Object(U.jsx)("a",{onClick:function(){r.showEditProductDialog(t.entity.product)},children:"\u7f16\u8f91"}),Object(U.jsx)("a",{onClick:function(){r.deleteProduct(t.entity.product)},children:"\u5220\u9664"})]})}}],r}return Object(o.a)(n,[{key:"getPagerProfit",value:function(e){var t,n;return(null===(t=e.currentPrice)||void 0===t?void 0:t.money)-(null===(n=e.buySells)||void 0===n?void 0:n.totalMoney)}},{key:"getPagerProfitProcent",value:function(e){var t;return g.safeDivision(this.getPagerProfit(e),null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)}},{key:"getSellProfitPercent",value:function(e){var t,n;return g.safeDivision(null===(t=e.profits)||void 0===t?void 0:t.totalMoney,Math.abs(null===(n=e.buySells)||void 0===n?void 0:n.totalSellMoney))}},{key:"showEditProductDialog",value:function(e){this.setState({showDialog:"editProduct",currentProduct:e})}},{key:"editProduct",value:function(e,t){B.editProduct(e,t.desc,ue.getMoney(t,"money")),this.hideDialog()}},{key:"hideDialog",value:function(){this.setState({showDialog:"",currentProduct:null})}},{key:"deleteInvestDetail",value:function(e){B.deleteInvestDetail(e),this.refreshPage()}},{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"addProduct",value:function(e){B.upsertProduct(e.type,e.name,e.desc),this.refreshPage()}},{key:"queryProducts",value:function(){return B.queryProducts()}},{key:"deleteProduct",value:function(e){B.deleteProduct(e),this.refreshPage()}},{key:"queryAllInvestData",value:function(){return B.getAllInvestDetailBefore(null)}},{key:"render",value:function(){var e,t,n,r=this;console.log("invest page render");var i={};B.getProductTypes().forEach((function(e){i[e.code]=[e.name]}));var o=[],a=[],l=[],c={};B.queryProducts().sort((function(e,t){return Math.abs(e.type.code)<Math.abs(t.type.code)?1:-1})).forEach((function(e){e.type.isAsset()||e.type.isDebt()?o.push({key:e.id,entity:e}):e.type.isStock()?a.push({key:e.id,entity:e}):l.push({key:e.id,entity:e}),c[e.id]=e}));for(var u=this.queryAllInvestData(),s=[],d=[],y=[],h={productTypeCode:99999999,productTypeName:"\u6c47\u603b",productName:"\u6c47\u603b",productFixVote:0,paperProfit:0,sellProfit:0,paperProfitPercent:0,sellProfitPercent:0},f=0,v=Object.keys(u.fund);f<v.length;f++){var b=v[f],g=u.fund[b];s.push({key:b,entity:g});var O=c[b],k=this.getPagerProfitProcent(g),S=this.getSellProfitPercent(g),M={product:O,productTypeCode:O.type.code,productTypeName:O.type.name,productName:O.name,productFixVote:O.fixVote,paperProfit:O.fixVote*k,sellProfit:O.fixVote*S,paperProfitPercent:k,sellProfitPercent:S};h.productFixVote+=M.productFixVote,h.paperProfit+=M.paperProfit,h.sellProfit+=M.sellProfit,y.push({key:b,entity:M})}h.paperProfitPercent=h.paperProfit/h.productFixVote,h.sellProfitPercent=h.sellProfit/h.productFixVote,y.push({key:9999999,entity:h});for(var w=0,D=Object.keys(u.stock);w<D.length;w++){var T=D[w],I=u.stock[T];d.push({key:T,entity:I})}var _=function(e,t){var n=[];return e.entity.buySells.datas.forEach((function(t){var r,i,o,a=Object(P.a)(null!==(r=null===(i=e.entity.profits)||void 0===i?void 0:i.datas)&&void 0!==r?r:[]);try{for(a.s();!(o=a.n()).done;){var l=o.value;if(l.buySellId===t.id){t.profitMoney=l.money;break}}}catch(c){a.e(c)}finally{a.f()}n.push({key:t.id,entity:t})})),Object(U.jsx)(m.a,{columns:r.subInvestColumns,dataSource:n,pagination:!1})},N=function(e){var t;return!x.isNull(null===(t=e.entity.buySells)||void 0===t?void 0:t.datas)};return Object(U.jsxs)(Me,{className:"Content",children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u6295\u8d44\u8be6\u60c5"}),Object(U.jsx)(m.a,{columns:this.investColumns,dataSource:d,expandable:{expandedRowRender:_,rowExpandable:N},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(U.jsx)(m.a,{columns:this.investColumns,dataSource:s,expandable:{expandedRowRender:_,rowExpandable:N},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(U.jsx)(j.a,{orientation:"center",children:"\u6295\u8d44\u4ea7\u54c1"}),Object(U.jsxs)(p.a,{style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(U.jsx)(W.a,{span:8,children:Object(U.jsx)(ue,{title:"\u65b0\u589e\u6295\u8d44\u4ea7\u54c1",cfgs:[{name:"type",code2Name:i,required:!0},{name:"name",required:!0},{name:"desc"}],onSubmit:function(e){return r.addProduct(e),!0}})}),Object(U.jsxs)(W.a,{span:16,children:[Object(U.jsx)(m.a,{columns:this.productColumns,dataSource:a,pagination:{pageSize:10}}),Object(U.jsx)(m.a,{columns:this.productFixVoteColumns,dataSource:y,pagination:{pageSize:15},scroll:{x:1e3},sortDirections:["descend"]}),Object(U.jsx)(m.a,{columns:this.productColumns,dataSource:o,pagination:{pageSize:10}})]})]}),Object(U.jsx)(me,{title:"\u4fee\u6539\u4ea7\u54c1",visible:"editProduct"===this.state.showDialog,cfgs:[{name:"money",hint:"\u5b9a\u6295\u989d",defaultValue:(null===(t=this.state.currentProduct)||void 0===t?void 0:t.fixVote)/100,moneyPon:!0},{name:"desc",defaultValue:null===(n=this.state.currentProduct)||void 0===n?void 0:n.desc}],onOk:function(e){return r.editProduct(r.state.currentProduct,e)},onCancel:function(){return r.hideDialog()}},null===(e=this.state.currentProduct)||void 0===e?void 0:e.id)]})}}]),n}(u.a.Component)),Te=(Q.a.Option,z.a.Header,z.a.Content),Ie=(z.a.Sider,b.a.Title,b.a.Paragraph,b.a.Text),_e=(b.a.Link,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={},r}return Object(o.a)(n,[{key:"refreshDB",value:function(){var e=Object(r.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.initDb(t[0]);case 2:this.props.onDbReady();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(r.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.createDb();case 2:this.props.onDbReady();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e;$e?null===(e=Qe.db)||void 0===e||e.export():G.b.error("\u8bf7\u5148\u52a0\u8f7dDB\u6587\u4ef6")}},{key:"click1",value:function(){}},{key:"click2",value:function(){}},{key:"render",value:function(){var e=this;return Object(U.jsxs)(Te,{className:"Content",children:[Object(U.jsxs)(j.a,{orientation:"center",children:["\u7248\u672c\uff1a",Qe.getVersion()]}),Object(U.jsxs)(p.a,{style:{padding:"10px 50px 50px",backgroundColor:"#eee"},children:[Object(U.jsxs)(W.a,{span:8,align:"center",children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u65b0\u5efaDB\u6587\u4ef6"}),Object(U.jsx)(v.a,{onClick:function(){return e.create()},children:"\u65b0\u5efa"})]}),Object(U.jsxs)(W.a,{span:8,align:"center",children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u52a0\u8f7dDB\u6587\u4ef6"}),Object(U.jsx)(Ie,{children:this.state.fileName}),Object(U.jsx)("input",{type:"file",id:"dbfile",accept:".db",onChange:function(t){return e.refreshDB(t.target.files)}})]}),Object(U.jsxs)(W.a,{span:8,align:"center",children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u5bfc\u51faDB\u6587\u4ef6"}),Object(U.jsx)(v.a,{onClick:function(){return e.export()},children:"\u4fdd\u5b58"})]})]}),Object(U.jsxs)(p.a,{style:{padding:"10px 50px 50px",backgroundColor:"#eee",margin:"10px 0"},children:[Object(U.jsx)(j.a,{orientation:"center",children:"\u6d4b\u8bd5\u6309\u94ae"}),Object(U.jsx)(v.a,{onClick:function(){return e.click1()},children:"click1"}),Object(U.jsx)(v.a,{onClick:function(){return e.click2()},children:"click2"})]})]})}}]),n}(u.a.Component)),Ne=_e,Ce=n(6),Ee=n(801),Ae=n(802),Le=n(297),qe=(Q.a.Option,z.a.Header,z.a.Content),Be=z.a.Sider,Re=(b.a.Title,b.a.Paragraph,b.a.Text),Ve=(b.a.Link,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={startMonth:"01"},r.incomeExpendColumns=[{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){var t="geekblue";return"\u4e3b\u52a8\u6536\u5165"===e.title||"\u88ab\u52a8\u6536\u5165"===e.title?t="red":"\u4e3b\u52a8\u652f\u51fa"!==e.title&&"\u88ab\u52a8\u652f\u51fa"!==e.title||(t="green"),Object(U.jsx)(f.a,{color:t,children:e.title},e.title)}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(e.money)})}}],r.subIncomeExpendColumns=[{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:e.title})}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(e.money)})},sorter:function(e,t){return g.compareAbs(e.entity.money,t.entity.money)}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:e.desc})}}],r.assetDebtColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return de.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:e.info.productName})}},{title:"\u603b\u989d",key:"currentPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}}],r.subAssetDebtColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:O.dayStr(e.happenTime)})}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(e.money)})}}],r.investColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return de.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:e.info.productName})}},{title:"\u5356\u51fa\u603b\u989d",key:"sellPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(Math.abs(null===(t=e.buySells)||void 0===t?void 0:t.filterSellMoney))})},sorter:function(e,t){var n,r;return g.compareAbs(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterSellMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterSellMoney)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=V.getSellProfitPercent(e);return Object(U.jsx)(Re,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=V.getSellProfitPercent(e.entity),r=V.getSellProfitPercent(t.entity);return x.compare(n,r)}},{title:"\u5356\u51fa\u5229\u6da6",key:"sellProfit",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}},{title:"\u5f53\u671f\u6295\u8d44",key:"timeInvest",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(null===(t=e.buySells)||void 0===t?void 0:t.filterMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterMoney)}},{title:"\u6295\u8d44\u603b\u989d",key:"totalInvest",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalMoney)}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=V.getPaperProfitPercent(e);return Object(U.jsx)(Re,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})},sorter:function(e,t){var n=V.getPaperProfitPercent(e.entity),r=V.getPaperProfitPercent(t.entity);return x.compare(n,r)}},{title:"\u8d26\u9762\u5229\u6da6",key:"paperProfit",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(V.getPaperProfit(e))})},sorter:function(e,t){return g.compare(V.getPaperProfit(e.entity),V.getPaperProfit(t.entity))}},{title:"\u6700\u65b0\u4ef7\u503c",key:"lastPrice",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return g.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getDetailStr(g.safeDivision(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney,e.buySells.totalCount))})}},{title:"\u73b0\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(U.jsx)(Re,{children:g.getDetailStr(g.safeDivision(null===(t=e.currentPrice)||void 0===t?void 0:t.money,e.buySells.totalCount))})}}],r.subInvestColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:O.dayStr(e.happenTime)})}},{title:"\u4e70\u5165/\u5356\u51fa\u672c\u91d1",key:"principal",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(e.money)})}},{title:"\u5230\u8d26\u603b\u989d",key:"sellGetMoney",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(Math.abs(e.money)+e.profitMoney)})}},{title:"\u5229\u6da6",key:"profit",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getStr(e.profitMoney)})}},{title:"\u5229\u6da6\u7387",key:"profitPercent",dataIndex:"entity",render:function(e){var t=g.safeDivision(e.profitMoney,Math.abs(e.money));return Object(U.jsx)(Re,{type:g.getPercentColorType(t),children:g.getPercentStr(t)})}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getDetailStr(g.safeDivision(Math.abs(e.money),Math.abs(e.count)))})}},{title:"\u5356\u51fa\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){return Object(U.jsx)(Re,{children:g.getDetailStr(g.safeDivision(Math.abs(-1*e.money+e.profitMoney),Math.abs(e.count)))})}}],r}return Object(o.a)(n,[{key:"getByYearSideDatas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"01",t=pe.queryMonths();this.months=t;var n=[];return t.forEach((function(t){var r=t.substring(0,4)+"-"+e;n.includes(r)||n.push(r)})),n.sort((function(e,t){return t>e?1:-1}))}},{key:"showDialog",value:function(e){this.setState({showDialog:e})}},{key:"modifyMonth",value:function(e){isNaN(e)?G.b.error("\u8bf7\u8f93\u5165\u6709\u6548\u6708\u4efd\uff0c\u5982 2022-5"):(this.state.startMonth=O.monthStr(e).substring(5,7),this.state.sideKey=null,this.hideDialog())}},{key:"hideDialog",value:function(){this.setState({showDialog:""})}},{key:"getAggregateGroupDataArr",value:function(e){var t,n={},r=0,i=Object(P.a)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=D.getByCode(o.type.code);(a=a.getGroup()).code in n||(n[a.code]={name:a.name,code:a.code,value:0});var l=Math.abs(o.money/100);n[a.code].value+=l,r+=l}}catch(c){i.e(c)}finally{i.f()}return Object.keys(n).map((function(e){return n[e].valuePercent=n[e].value/r,n[e]})).sort((function(e,t){return x.compare(e.code,t.code)}))}},{key:"getAggregateTimeDataArr",value:function(e,t){var n,r={},i=0,o=Object(P.a)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value,l=D.getByCode(a.type.code),c=l.getGroup();if(t===c.code){var u=O.monthStr(a.happenTime)+"_"+l.code;u in r||(r[u]={name:l.name,code:l.code,groupCode:c.code,groupName:c.name,month:O.monthStr(a.happenTime),value:0});var s=Math.abs(a.money/100);r[u].value+=s,i+=s}}}catch(y){o.e(y)}finally{o.f()}var d=Object.keys(r).map((function(e){return r[e].valuePercent=r[e].value/i,r[e]})).sort((function(e,t){return e.month==t.month?x.compare(e.code,t.code):e.month>t.month?1:-1}));return d}},{key:"render",value:function(){var e=this,t=this.getByYearSideDatas(this.state.startMonth),n=t.map((function(e,t){return{key:e,label:e}}));x.isNull(this.state.sideKey)&&(this.state.sideKey=t[0]);var r=new Date(this.state.sideKey),i=R.queryYearData(r),o=V.queryYearData(r);console.log("===== yearData     =====",i),console.log("===== allInvestData =====",o);var a=this._getPassiveIncomeSummary(o),l=this._getPassiveExpendSummary(o),c=[];c.push({key:"\u4e3b\u52a8\u6536\u5165",entity:this.newEntity(null,"\u4e3b\u52a8\u6536\u5165",i.income.total,null,i.income.sumByMonth.map((function(t){return e.newEntity(null,t.month,t.total,null)})))}),c.push({key:"\u88ab\u52a8\u6536\u5165",entity:this.newEntity(null,"\u88ab\u52a8\u6536\u5165",a.total,null,a.details)}),c.push({key:"\u4e3b\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u4e3b\u52a8\u652f\u51fa",i.expend.total,null,i.expend.sumByMonth.map((function(t){return e.newEntity(null,t.month,t.total,null)})))}),c.push({key:"\u88ab\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u88ab\u52a8\u652f\u51fa",l.total,null,l.details)}),c.push({key:"\u65b0\u589e\u73b0\u91d1",entity:this.newEntity(null,"\u65b0\u589e\u73b0\u91d1",i.income.total+a.total+i.expend.total+l.total,null)});var u=this._mapToList(o.fund.products,!0),s=this._mapToList(o.stock.products,!0),d=[];d.push.apply(d,Object($.a)(this._mapToList(o.asset.products)).concat(Object($.a)(this._mapToList(o.debt.products))));var y=function(t,n){var r=[];return t.entity.buySells.filterDatas.forEach((function(e){var n,i,o,a=Object(P.a)(null!==(n=null===(i=t.entity.profits)||void 0===i?void 0:i.filterDatas)&&void 0!==n?n:[]);try{for(a.s();!(o=a.n()).done;){var l=o.value;if(l.buySellId===e.id){e.profitMoney=l.money;break}}}catch(c){a.e(c)}finally{a.f()}r.push({key:e.id,entity:e})})),Object(U.jsx)(m.a,{columns:e.subInvestColumns,dataSource:r,pagination:!1})},h=function(e){var t,n;return!x.isNull(null===(t=e.entity.buySells)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterDatas.length)>0},f=this.getAggregateGroupDataArr(i.income.details),b=this.getAggregateGroupDataArr(i.expend.details),g=[];if(!x.isNull(this.state.selectedGroupCode)){var O=D.getByCode(this.state.selectedGroupCode);g=O.isIncome()?this.getAggregateTimeDataArr(i.income.details,O.code):this.getAggregateTimeDataArr(i.expend.details,O.code)}var k=Object(U.jsxs)(qe,{children:[Object(U.jsx)(m.a,{columns:this.incomeExpendColumns,dataSource:c,expandable:{expandedRowRender:function(t,n){var r=[];return t.entity.child.forEach((function(e){r.push({key:x.isNull(e.id)?e.title:e.id,entity:e})})),Object(U.jsx)(m.a,{columns:e.subIncomeExpendColumns,dataSource:r,pagination:!1,sortDirections:["descend"]})},rowExpandable:function(e){return!x.isNull(e.entity.child)&&e.entity.child.length>0}},pagination:{pageSize:20},sortDirections:["descend"]}),Object(U.jsxs)(p.a,{children:[Object(U.jsx)(W.a,{span:12,children:Object(U.jsx)(Ee.a,Object(Ce.a)({},this._getPieConfig(f)))}),Object(U.jsx)(W.a,{span:12,children:Object(U.jsx)(Ee.a,Object(Ce.a)({},this._getPieConfig(b)))})]}),Object(U.jsx)(p.a,{style:{padding:"10px"},children:Object(U.jsx)(W.a,{span:24,children:g.length>0?Object(U.jsx)(Ae.a,Object(Ce.a)({},this._getBarConfig(g))):Object(U.jsx)("div",{})})}),Object(U.jsx)(j.a,{orientation:"center",children:"\u6307\u6807"}),de.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u652f\u51fa\uff08\u8d22\u5bcc\u81ea\u6709\u7387\uff09",x.getPercent(a.total/Math.abs(i.expend.total+l.total))),de.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u4e3b\u52a8\u6536\u5165",x.getPercent(a.total/i.income.total)),Object(U.jsx)(j.a,{orientation:"center",children:"\u8d44\u4ea7/\u8d1f\u503a"}),Object(U.jsx)(m.a,{columns:this.assetDebtColumns,dataSource:d,expandable:{expandedRowRender:function(t,n){var r=[];return t.entity.profits.filterDatas.forEach((function(e){r.push({key:e.id,entity:e})})),Object(U.jsx)(m.a,{columns:e.subAssetDebtColumns,dataSource:r,pagination:!1})},rowExpandable:function(e){var t,n;return!x.isNull(null===(t=e.entity.profits)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.profits)||void 0===n?void 0:n.filterDatas.length)>0}},pagination:{pageSize:20},scroll:{x:800},sortDirections:["descend"]}),Object(U.jsx)(j.a,{orientation:"center",children:"\u6295\u8d44"}),Object(U.jsx)(m.a,{columns:this.investColumns,dataSource:s,expandable:{expandedRowRender:y,rowExpandable:h},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(U.jsx)(m.a,{columns:this.investColumns,dataSource:u,expandable:{expandedRowRender:y,rowExpandable:h},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]})]});return Object(U.jsxs)(z.a,{children:[Object(U.jsx)(Be,{width:200,children:Object(U.jsx)(H.a,{className:"Menu",mode:"inline",selectedKeys:[this.state.sideKey],items:n,onSelect:function(t){e.setState((function(){return e.state.sideKey=t.key}))}})}),Object(U.jsxs)(z.a,{className:"Layout-inner",children:[Object(U.jsxs)(p.a,{align:"middle",children:[Object(U.jsx)(W.a,{flex:"auto",children:Object(U.jsx)(X.a,{children:Object(U.jsx)(X.a.Item,{children:this.state.sideKey})})}),Object(U.jsx)(W.a,{span:12,align:"right",children:Object(U.jsx)(v.a,{onClick:function(){return e.showDialog("modifyStartMonth")},children:"\u8c03\u6574\u5f00\u59cb\u6708\u4efd"})})]}),k]}),Object(U.jsx)(me,{title:"\u8c03\u6574\u5f00\u59cb\u6708\u4efd",visible:"modifyStartMonth"===this.state.showDialog,cfgs:[{name:"date",hint:"\u6708\u4efd",picker:"month",defaultValue:new Date("2022-01")}],onOk:function(t){return e.modifyMonth(t.date)},onCancel:function(){return e.hideDialog()}})]})}},{key:"_getBarConfig",value:function(e){return{data:e,xField:"month",yField:"value",isGroup:!0,isStack:!0,seriesField:"name",groupField:"groupName",label:{position:"middle",style:{fill:"black",textAlign:"center"},formatter:function(e){return e.name+": "+g.getPercentStr(e.valuePercent)}},tooltip:{formatter:function(e){return{name:"".concat(e.name),value:"".concat(g.getStr(e.value,!0))}}}}}},{key:"_getPieConfig",value:function(e){var t=this;function n(e,t,n){var r=Object(Le.measureTextWidth)(t,n),i=r.width,o=r.height,a=e/2,l=1;e<i&&(l=Math.min(Math.sqrt(Math.abs(Math.pow(a,2)/(Math.pow(i/2,2)+Math.pow(o,2)))),1));var c="width:".concat(e,"px;");return'<div style="'.concat(c,";font-size:").concat(l,"em;line-height:").concat(l<1?1:"inherit",';">').concat(t,"</div>")}return{appendPadding:10,data:e,angleField:"valuePercent",colorField:"name",radius:1,innerRadius:.618,label:{type:"inner",offset:"-50%",style:{fill:"black",textAlign:"center"},formatter:function(e){return e.name+": "+g.getPercentStr(e.valuePercent)},autoRotate:!1},statistic:{title:{offsetY:-4,customHtml:function(e,t,r){var i=e.getBoundingClientRect(),o=i.width,a=i.height;return n(Math.sqrt(Math.pow(o/2,2)+Math.pow(a/2,2)),r?r.name:"\u603b\u8ba1",{fontSize:28})}},content:{offsetY:4,customHtml:function(e,t,r,i){return n(e.getBoundingClientRect().width,"".concat(r?g.getStr(r.value,!0):g.getStr(i.reduce((function(e,t){return e+t.value}),0),!0)),{fontSize:32})}}},interactions:[{type:"element-selected"},{type:"element-active"},{type:"pie-statistic-active"}],onReady:function(e){e.on("element:click",(function(e){t.setState({selectedGroupCode:e.data.data.code})}))}}}},{key:"newEntity",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return{happenTime:e,title:t,money:n,desc:r,child:i}}},{key:"_mapToList",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=0,i=Object.keys(e);r<i.length;r++){var o,a,l,c,u=i[r],s=e[u];t&&g.noValue(null===(o=s.currentPrice)||void 0===o?void 0:o.money)&&g.noValue(null===(a=s.profits)||void 0===a?void 0:a.filterTotalMoney)&&g.noValue(null===(l=s.buySells)||void 0===l?void 0:l.filterMoney)&&g.noValue(null===(c=s.buySells)||void 0===c?void 0:c.totalMoney)||n.push({key:u,entity:s})}return n}},{key:"_getPassiveIncomeSummary",value:function(e){var t=e.asset,n=e.fund,r=e.stock;return{total:t.totalProfitMoneys[1]+n.totalProfitMoneys[1]+r.totalProfitMoneys[1],details:[this.newEntity(null,"\u8d44\u4ea7\u6536\u5165",t.totalProfitMoneys[1]),this.newEntity(null,"\u6295\u8d44\u6536\u5165",n.totalProfitMoneys[1]),this.newEntity(null,"\u80a1\u7968\u6536\u5165",r.totalProfitMoneys[1])]}}},{key:"_getPassiveExpendSummary",value:function(e){var t=e.debt;return{total:t.totalProfitMoneys[1],details:[this.newEntity(null,"\u8d1f\u503a\u652f\u51fa",t.totalProfitMoneys[1])]}}}]),n}(u.a.Component)),Ue=Ve,Ke=z.a.Header,Fe=(z.a.Content,z.a.Sider,function(e){Object(y.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(i.a)(this,n),r=t.call(this,e);var o={init:"\u6570\u636e\u521d\u59cb\u5316",by_month:"\u6309\u6708\u5c55\u793a",by_year:"\u6309\u5e74\u5c55\u793a",invest_detail:"\u6295\u8d44\u8be6\u60c5"};return Qe.isProduction()||(o.test="\u6d4b\u8bd5\u9875\u9762"),r.navItems=Object.keys(o).map((function(e){return{key:e,label:o[e]}})),r.state={navKey:"init"},r}return Object(o.a)(n,[{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"render",value:function(){var e=this,t=this.state.navKey,n=null;return"init"===t||!0!==$e?("init"!==t&&(this.state.navKey="init",G.b.error("\u8bf7\u5148\u52a0\u8f7dDB\u6587\u4ef6")),n=Object(U.jsx)(Ne,{onDbReady:function(){Qe.isProduction()?e.state.navKey="by_month":e.state.navKey="test",e.refreshPage()}})):n="test"===t?Object(U.jsx)(Y,{}):"by_month"===t?Object(U.jsx)(Oe,{}):"by_year"===t?Object(U.jsx)(Ue,{}):"invest_detail"===t?Object(U.jsx)(De,{}):Object(U.jsx)(Se,{}),Object(U.jsxs)(z.a,{children:[Object(U.jsx)(Ke,{className:"header",children:Object(U.jsx)(H.a,{theme:"dark",mode:"horizontal",items:this.navItems,selectedKeys:[t],onSelect:function(t){e.setState((function(){return e.state.navKey=t.key}))}})}),n]})}}]),n}(u.a.Component)),Ye=n(372),ze=(n(791),n(525)),Ge=n.n(ze),He=n(28);oe.a.locale("zh-cn");var $e=!1,Qe=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"isProduction",value:function(){return"production"===this._env}},{key:"getVersion",value:function(){return this.isProduction()?this._version:this._version+"-dev"}},{key:"initDb",value:function(){var e=Object(r.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.db=new Ye.a,e.next=3,this.db.init(t);case 3:$e=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDb",value:function(){var e=Object(r.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.db=new Ye.a,e.next=3,this.db.createDb();case 3:$e=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();Qe.db=null,Qe._env="production",Qe._version="1.1.20230129",d.a.render(Object(U.jsx)(He.a,{locale:Ge.a,children:Object(U.jsx)(Fe,{},"mainpage")}),document.getElementById("root"))}},[[795,1,2]]]);
//# sourceMappingURL=main.d108a2b3.chunk.js.map