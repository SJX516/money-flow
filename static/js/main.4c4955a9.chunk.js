(this["webpackJsonpmoney-flow"]=this["webpackJsonpmoney-flow"]||[]).push([[0],{105:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(14),i=n(15),a=n(22),o=n(21),c=n(33),l=n(34),u=n(73),s=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).tablename="income_expenditure_detail",e}return Object(i.a)(n,[{key:"upsert",value:function(e){var t,n,r=u.a.getDateStr(e.gmtCreate,!0),i=u.a.getDateStr(e.gmtModified),a=u.a.getDateStr(e.happenTime);null==e.id?null===(t=l.a.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","type","desc","money","happen_time"],[r,i,e.type.code,e.desc,e.money,a]):null===(n=l.a.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","type","desc","money","happen_time"],[r,i,e.type.code,e.desc,e.money,a])}},{key:"select",value:function(e,t){var n;if(t<e)throw new Error("\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4");return this.convert(null===(n=l.a.db)||void 0===n?void 0:n.select(this.tablename,["happen_time","happen_time"],[e.timeStr(),t.timeStr()],[">","<"]))}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(c.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=new f;a.id=i[0],a.gmtCreate=new Date(i[1]),a.gmtModified=new Date(i[2]),a.type=p.getByCode(i[3]),a.desc=i[4],a.money=i[5],a.happenTime=new Date(i[6]),t.push(a)}}catch(o){r.e(o)}finally{r.f()}return t}}]),n}(u.a),d=n(78),y=n(147),h=n(52),f=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(r.a)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).type=null,e.desc=null,e.money=null,e.happenTime=null,e}return Object(i.a)(n,[{key:"save",value:function(){this.gmtModified=new Date,this.money*this.type.code<0&&(this.money=-1*this.money),n.repo.upsert(this)}}],[{key:"query",value:function(e){return this.repo.get(e)}},{key:"queryTimeBetwen",value:function(e,t){return this.repo.select(e,t)}},{key:"delete",value:function(e){n.repo.delete(e)}}]),n}(y.a);f.repo=new s;var p=function(){function e(t){Object(r.a)(this,e),this.config=t,this.code=t.code,this.name=t.name}return Object(i.a)(e,[{key:"getGroup",value:function(){return d.a.getIncomeExpendGroupByCode(this.code)}},{key:"isIncome",value:function(){return this.config.type==h.c.IncomeType}},{key:"isEnable",value:function(){return this.config.status==h.b.Normal}}],[{key:"getByCode",value:function(e){return d.a.getIncomeExpendTypeByCode(e)}}]),e}()},11:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return o}));var r=n(14),i=n(15),a=function(){function e(){Object(r.a)(this,e)}return Object(i.a)(e,null,[{key:"debug",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log(0,e,n)}},{key:"info",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log(1,e,n)}},{key:"warn",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log(2,e,n)}},{key:"error",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log(3,e,n)}},{key:"log",value:function(e,t){if(e>=this.logLevel){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];console.log("[".concat(this.levelNames[e],"] ").concat(t),r)}}}]),e}();a.logLevel=1,a.levelNames=["debug","info","warn","error"];var o=function(){function e(){Object(r.a)(this,e)}return Object(i.a)(e,null,[{key:"noValue",value:function(e){return c.isEmpty(e)||c.notNumber(e)||0==e}},{key:"getDetailStr",value:function(e){if(this.noValue(e))return"-";var t=e/100;return"\uffe5".concat(t%1===0?t:t.toFixed(2))}},{key:"getStr",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.noValue(e))return"-";var n=e/100;return t&&(n=e),"\uffe5".concat(this.getFixedMoney(n))}},{key:"getMoneyColorType",value:function(e){return this.noValue(e)?"":e>0?"danger":e<0?"success":""}},{key:"getFixedMoney",value:function(e){var t=e<0,n=e.toFixed();t&&(n=n.substr(1));for(var r=n.length,i=[],a=0;a<r;){var o=0==a?r%3:3;0==o&&(o=3),i.push(n.substr(a,o)),a+=o}return t?"-"+i.join(","):i.join(",")}},{key:"compare",value:function(e,t){return c.notNumber(e)?-1:c.notNumber(t)?1:e-t}},{key:"compareAbs",value:function(e,t){return c.notNumber(e)?-1:c.notNumber(t)?1:Math.abs(e)-Math.abs(t)}},{key:"safeDivision",value:function(e,t){return c.notNumber(e)||c.notNumber(t)||0==t?null:e/t}},{key:"getPercentStr",value:function(e){return c.notNumber(e)||Math.abs(e)<=1e-4?"-":c.getPercent(e)}},{key:"getPercentColorType",value:function(e){return c.notNumber(e)||Math.abs(e)<=1e-4?"":e>0?"danger":e<0?"success":""}}]),e}(),c=function(){function e(){Object(r.a)(this,e)}return Object(i.a)(e,null,[{key:"isEmpty",value:function(e){return void 0===e||null===e||""===e}},{key:"isNull",value:function(e){return void 0===e||null===e}},{key:"notNumber",value:function(e){return this.isNull(e)||isNaN(e)}},{key:"safeGetNumber",value:function(e){return this.notNumber(e)?0:e}},{key:"getPercent",value:function(e){var t=100*e;return"".concat(t%1===0?t:t.toFixed(2),"%")}},{key:"compare",value:function(t,n){return e.notNumber(t)?-1:e.notNumber(n)?1:t-n}},{key:"compareAbs",value:function(t,n){return e.notNumber(t)?-1:e.notNumber(n)?1:Math.abs(t)-Math.abs(n)}}]),e}(),l=function(){function e(){Object(r.a)(this,e)}return Object(i.a)(e,null,[{key:"nextMonthStart",value:function(e){var t=e.getMonth()+1,n=e.getFullYear();return 12===t?(n+=1,t="01"):t=(t+=1)<10?"0"+t:t,new Date("".concat(n,"-").concat(t,"-01 00:00:00"))}},{key:"monthEnd",value:function(e){return new Date(this.nextMonthStart(e)-1)}},{key:"monthStart",value:function(e){var t=e.getMonth()+1,n=e.getFullYear();return new Date("".concat(n,"-").concat(t,"-01 00:00:00"))}},{key:"nextYearStart",value:function(e){var t=e.getMonth()+1,n=e.getFullYear()+1;return new Date("".concat(n,"-").concat(t,"-01 00:00:00"))}},{key:"yearEnd",value:function(e){return new Date(this.nextYearStart(e)-1)}},{key:"lastMonthEnd",value:function(e){return new Date(this.monthStart(e)-1)}},{key:"inMonth",value:function(t,n){var r=e.monthStart(n),i=e.monthEnd(n);return this.inTime(t,r,i)}},{key:"inTime",value:function(e,t,n){return!(e>n||e<t)}},{key:"dayStr",value:function(e){return c.isNull(e)?"":e.timeStr().substring(0,10)}},{key:"monthStr",value:function(e){return c.isNull(e)?"":e.timeStr().substring(0,7)}},{key:"weekDayStr",value:function(e){switch(e.getDay()){case 0:return"\u5468\u65e5";case 1:return"\u5468\u4e00";case 2:return"\u5468\u4e8c";case 3:return"\u5468\u4e09";case 4:return"\u5468\u56db";case 5:return"\u5468\u4e94";case 6:return"\u5468\u516d"}}}]),e}()},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15),i=n(14),a=Object(r.a)((function e(){Object(i.a)(this,e),this.id=null,this.gmtCreate=null,this.gmtModified=null}))},188:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(33),i=n(14),a=n(15),o=n(52),c=n(22),l=n(21),u=n(34),s=n(73),d=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).tablename="user_config",e}return Object(a.a)(n,[{key:"upsert",value:function(e){var t,n,r=s.a.getDateStr(e.gmtCreate,!0),i=s.a.getDateStr(new Date);null==e.id?null===(t=u.a.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","type","status","code","name","parent_code"],[r,i,e.type.code,e.status.code,e.code,e.name,e.parent_code]):null===(n=u.a.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","type","status","code","name","parent_code"],[r,i,e.type.code,e.status.code,e.code,e.name,e.parent_code])}},{key:"selectType",value:function(e){var t;return this.convert(null===(t=u.a.db)||void 0===t?void 0:t.select(this.tablename,["type"],[e.code],["="]))}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,i=Object(r.a)(e[0].values);try{for(i.s();!(n=i.n()).done;){var a=n.value,c=new o.a;c.id=a[0],c.gmtCreate=new Date(a[1]),c.gmtModified=new Date(a[2]),c.type=o.c.getByCode(a[3]),c.status=o.b.getByCode(a[4]),c.code=a[5],c.name=a[6],c.parent_code=a[7],t.push(c)}}catch(l){i.e(l)}finally{i.f()}return t}}]),n}(s.a),y=n(78),h=function(){function e(){Object(i.a)(this,e)}return Object(a.a)(e,null,[{key:"initDefaultTypes",value:function(){var e,t=Object(r.a)(f.values());try{for(t.s();!(e=t.n()).done;){var n=e.value,i=new o.a;i.type=n.isIncome()?o.c.IncomeType:o.c.ExpenditureType,i.status=o.b.Normal,i.code=n.code,i.name=n.name,i.parent_code=n.getParentCode(),this.repo.upsert(i)}}catch(a){t.e(a)}finally{t.f()}}},{key:"save",value:function(e){this.repo.upsert(e),e.type!=o.c.IncomeType&&e.type!=o.c.ExpenditureType||y.a.refreshTypes(!0)}},{key:"getAll",value:function(e){return this.repo.selectType(e)}}]),e}();h.repo=new d;var f=function(){function e(t,n){Object(i.a)(this,e),this.code=t,this.name=n}return Object(a.a)(e,[{key:"getParentCode",value:function(){var e=this.code-this.code%100;return e===this.code?null:e}},{key:"isIncome",value:function(){return this.code>0}}],[{key:"getByCode",value:function(e){var t,n=Object(r.a)(this.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.code==e)return i}}catch(a){n.e(a)}finally{n.f()}return null}},{key:"toList",value:function(t){if(t instanceof e)return[t];for(var n=[],r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];n=n.concat(this.toList(t[a]))}return n}},{key:"values",value:function(){return this.toList(this.Incomme).concat(this.toList(this.Expenditure))}}]),e}();f.Incomme={salary:{self:new f(1e4,"\u85aa\u6c34"),num13:new f(10001,"\u85aa\u6c34-\u5341\u4e09\u85aa"),bonus:new f(10002,"\u85aa\u6c34-\u5e74\u7ec8\u5956")},luckmoney:{self:new f(2e4,"\u7ea2\u5305"),work:new f(20001,"\u7ea2\u5305-\u5de5\u4f5c"),home:new f(20002,"\u7ea2\u5305-\u5bb6\u4eba")},other:{self:new f(3e4,"\u5176\u4ed6")}},f.Expenditure={home:{self:new f(-1e4,"\u4f4f\u623f"),rent:new f(-10001,"\u4f4f\u623f-\u623f\u79df"),utility:new f(-10002,"\u4f4f\u623f-\u6c34\u7535")},daily:{self:new f(-2e4,"\u65e5\u5e38"),taxi:new f(-20001,"\u65e5\u5e38-\u4ea4\u901a"),phone:new f(-20002,"\u65e5\u5e38-\u8bdd\u8d39")},shopping:{self:new f(-3e4,"\u8d2d\u7269"),elc:new f(-30001,"\u8d2d\u7269-\u7535\u5b50"),life:new f(-30002,"\u8d2d\u7269-\u751f\u6d3b")},happy:{self:new f(-4e4,"\u5a31\u4e50"),online:new f(-40001,"\u5a31\u4e50-\u7ebf\u4e0a"),offline:new f(-40002,"\u5a31\u4e50-\u7ebf\u4e0b")},food:{self:new f(-5e4,"\u9910\u996e"),canteen:new f(-50001,"\u9910\u996e-\u98df\u5802"),out:new f(-50002,"\u9910\u996e-\u5916\u51fa")},family:{self:new f(-6e4,"\u5bb6\u4eba"),traval:new f(-60001,"\u5bb6\u4eba-\u4ea4\u901a"),gift:new f(-60002,"\u5bb6\u4eba-\u793c\u7269")},study:{self:new f(-7e4,"\u5b66\u4e60"),online:new f(-70001,"\u5b66\u4e60-\u7ebf\u4e0a"),offline:new f(-70002,"\u5b66\u4e60-\u7ebf\u4e0b")},health:{self:new f(-8e4,"\u5065\u5eb7")},car:{self:new f(-9e4,"\u8f66"),etc:new f(-90001,"\u8f66-\u505c\u8f66/ETC"),oil:new f(-90002,"\u8f66-\u52a0\u6cb9")},girlfriend:{self:new f(-1e5,"\u5973\u670b\u53cb"),traval:new f(-100001,"\u5973\u670b\u53cb-\u65c5\u6e38"),eat:new f(-100002,"\u5973\u670b\u53cb-\u5403\u559d"),gift:new f(-100003,"\u5973\u670b\u53cb-\u793c\u7269")},other:{self:new f(-11e4,"\u5176\u4ed6")}}},34:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(75),i=n(14),a=n(15),o=n(41),c=n.n(o),l=n(384),u=!1,s=function(){function e(){Object(i.a)(this,e)}return Object(a.a)(e,null,[{key:"isProduction",value:function(){return"production"===this._env}},{key:"isTest",value:function(){return"test"===this._env}},{key:"getVersion",value:function(){return this.isProduction()?this._version:this.isTest()?this._version+"-test":this._version+"-dev"}},{key:"initDb",value:function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.db=new l.a,e.next=3,this.db.init(t);case 3:u=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDb",value:function(){var e=Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.db=new l.a,e.next=3,this.db.createDb();case 3:u=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();s.db=null,s._env="production",s._version="1.2.20240206"},384:function(e,t,n){"use strict";(function(e){var r=n(33),i=n(75),a=n(14),o=n(15),c=n(41),l=n.n(c),u=n(385),s=n.n(u),d=n(386),y=n(388),h=n(188),f=n(11),p="db_config",v="db_version",m={0:function(e){f.b.info("\u6570\u636e\u5e93\u5347\u7ea7: v0 => v1"),e.create("CREATE TABLE `db_config` (        `id` INTEGER NOT NULL UNIQUE,        `type` varchar(64) NOT NULL ,        `value` varchar(64) NOT NULL ,        PRIMARY KEY (`id` AUTOINCREMENT)       )"),e.create("CREATE TABLE `user_config` (        `id` INTEGER NOT NULL UNIQUE,        `gmt_create` datetime NOT NULL  ,        `gmt_modified` datetime NOT NULL  ,        `type` INTEGER NOT NULL ,        `status` INTEGER NOT NULL ,        `code` INTEGER NOT NULL ,        `name` varchar(64) NOT NULL ,        `parent_code` INTEGER,        PRIMARY KEY (`id` AUTOINCREMENT)       )"),e.insert(p,["type","value"],[v,"1"]),h.a.initDefaultTypes()}};var b=function(){function t(){Object(a.a)(this,t),this.db=null,this.actionCount=0,this.initing=!1}return Object(o.a)(t,[{key:"init",value:function(){var e=Object(i.a)(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s()({locateFile:function(){return d.a}});case 2:return n=e.sent,e.next=5,new Promise((function(e,n){var r=new FileReader;r.readAsArrayBuffer(t),r.onload=function(){return e(r.result)}}));case 5:r=e.sent,i=new Uint8Array(r),this.db=new n.Database(i),this.applyUpdate();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDb",value:function(){var e=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createV0Db();case 2:this.applyUpdate();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createV0Db",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s()({locateFile:function(){return d.a}});case 2:t=e.sent,this.db=new t.Database,this.create("CREATE TABLE `data_summary` (            `id` INTEGER NOT NULL  ,            `gmt_create` datetime NOT NULL  ,            `gmt_modified` datetime NOT NULL  ,            `type` varchar(64) NOT NULL ,            `time` datetime NOT NULL  ,            `money` INTEGER,            PRIMARY KEY (`id` AUTOINCREMENT)           )"),this.create("CREATE TABLE `income_expenditure_detail` (            `id` INTEGER NOT NULL ,            `gmt_create` datetime NOT NULL,            `gmt_modified` datetime NOT NULL ,            `type` int NOT NULL,            `desc` varchar(64) NULL,            `money` bigint unsigned NOT NULL,            `happen_time` datetime NOT NULL,            PRIMARY KEY (`id` AUTOINCREMENT)        )"),this.create("CREATE TABLE `investment_detail` (            `id` INTEGER NOT NULL  ,            `gmt_create` datetime NOT NULL  ,            `gmt_modified` datetime NOT NULL  ,            `product_id` INTEGER NOT NULL  ,            `product_name` varchar(64) NOT NULL  ,            `product_type` INTEGER NOT NULL  ,            `money` INTEGER NOT NULL  ,            `happen_time` datetime NOT NULL  ,            `buy_sell_id` INTEGER,            `record_type` int NOT NULL , `count` INT,            PRIMARY KEY (`id` AUTOINCREMENT)           )"),this.create("CREATE TABLE `investment_product` (            `id` INTEGER NOT NULL  ,            `gmt_create` datetime NOT NULL  ,            `gmt_modified` datetime NOT NULL  ,            `name` varchar(64) NOT NULL  ,            `type` int NOT NULL  ,            `desc` varchar(64) NULL  , fix_vote INT,            PRIMARY KEY (`id` AUTOINCREMENT)           )");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDbConfig",value:function(){try{return this.convert(this.selectAll(p))}catch(e){return{}}}},{key:"applyUpdate",value:function(){this.initing=!0;var e=this.getDbConfig(),t=0;for(f.a.isNull(e.db_version)||(t=parseInt(e.db_version));t<1;)m[t](this),t+=1;this.initing=!1}},{key:"convert",value:function(e){var t={};if(void 0===e||void 0===e[0])return t;var n,i=Object(r.a)(e[0].values);try{for(i.s();!(n=i.n()).done;){var a=n.value;t[a[1]]=a[2]}}catch(o){i.e(o)}finally{i.f()}return t}},{key:"export",value:function(){var t=this.db.export(),n=e.from(t),r=new Blob([n]),i=window.URL.createObjectURL(r);this.downloadFile(i)}},{key:"checkAutoSave",value:function(){!this.initing&&++this.actionCount>20&&(f.b.info("\u81ea\u52a8\u89e6\u53d1\u4fdd\u5b58"),y.b.info("\u81ea\u52a8\u89e6\u53d1\u4fdd\u5b58"),this.actionCount=0,this.export())}},{key:"downloadFile",value:function(e){console.log("\u4e0b\u8f7d\u6587\u4ef6\uff1a"+e);var t=document.createElement("a");document.body.appendChild(t),t.href=e,t.download="data.db",t.onclick=function(){setTimeout((function(){window.URL.revokeObjectURL(t.href)}),1500)},t.click()}},{key:"selectAll",value:function(e){return this.select(e,[],[],[])}},{key:"select",value:function(e,t,n,r){return this.selectAndOrder(e,t,n,r,[])}},{key:"selectAndOrder",value:function(e,t,n,r,i){var a="SELECT * FROM ".concat(e),o=this.genWhereSql(t,n,r),c=o[1];return a+=o[0],i.length>0&&(a+=" order by ".concat(i.join(","))),this.db.exec(a,c)}},{key:"create",value:function(e){f.b.debug(e),this.db.run(e)}},{key:"insert",value:function(e,t,n){for(var r="INSERT INTO ".concat(e," (").concat(t.join(","),") VALUES ("),i={},a=0;a<t.length;a++)r+="$"+t[a]+a,a<t.length-1&&(r+=", "),i["$"+t[a]+a]=n[a];r+=") returning id",f.b.debug(r+" "+JSON.stringify(i));var o=this.db.exec(r,i);return this.checkAutoSave(),o[0].values[0][0]}},{key:"update",value:function(e,t,n,r){var i="UPDATE ".concat(e," SET"),a=this.genSubSql(n,r,[],!1),o=a[1];i+=a[0],i+=" where id=$id",o.$id=t,f.b.debug(i+" "+JSON.stringify(o)),this.checkAutoSave(),this.db.run(i,o)}},{key:"deleteAll",value:function(e){this.delete(e,[],[],[])}},{key:"delete",value:function(e,t,n,r){var i="DELETE FROM ".concat(e),a=this.genWhereSql(t,n,r),o=a[1];i+=a[0],f.b.debug(i+" "+JSON.stringify(o));this.db.exec(i,o);this.checkAutoSave()}},{key:"genWhereSql",value:function(e,t,n){return this.genSubSql(e,t,n,!0)}},{key:"genSubSql",value:function(e,t,n,r){for(var i="",a={},o=0;o<e.length;o++){i+=0!==o?r?" and ":" , ":r?" where ":" ";var c=n[o];void 0===c&&(c="="),i+=" "+e[o]+" "+c+" $"+e[o]+o,a["$"+e[o]+o]=t[o]}return[i,a]}}]),t}();t.a=b}).call(this,n(72).Buffer)},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}));var r=n(33),i=n(15),a=n(14),o=n(22),c=n(21),l=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).type=null,e.status=null,e.code=null,e.name=null,e.parent_code=null,e}return Object(i.a)(n)}(n(147).a),u=function(){function e(t,n){Object(a.a)(this,e),this.code=t,this.name=n}return Object(i.a)(e,null,[{key:"getByCode",value:function(e){var t,n=Object(r.a)(this.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.code===e)return i}}catch(a){n.e(a)}finally{n.f()}return null}},{key:"values",value:function(){return[this.Normal,this.Disabled]}}]),e}();u.Normal=new u(1,"normal"),u.Disabled=new u(99,"disabled");var s=function(){function e(t,n){Object(a.a)(this,e),this.code=t,this.name=n}return Object(i.a)(e,null,[{key:"getByCode",value:function(e){var t,n=Object(r.a)(this.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.code===e)return i}}catch(a){n.e(a)}finally{n.f()}return null}},{key:"values",value:function(){return[this.Account,this.IncomeType,this.ExpenditureType]}}]),e}();s.Account=new s(1,"Account"),s.IncomeType=new s(2,"IncomeType"),s.ExpenditureType=new s(3,"ExpenditureType")},563:function(e,t){},565:function(e,t){},576:function(e,t){},578:function(e,t){},605:function(e,t){},607:function(e,t){},608:function(e,t){},613:function(e,t){},615:function(e,t){},621:function(e,t){},623:function(e,t){},642:function(e,t){},654:function(e,t){},657:function(e,t){},661:function(e,t,n){},73:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(14),i=n(15),a=n(34),o=function(){function e(){Object(r.a)(this,e),this.tablename=null,Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Date.prototype.timeStr=function(){return this.format("yyyy-MM-dd hh:mm:ss")}}return Object(i.a)(e,[{key:"get",value:function(e){if(!a.b)return null;if(null!=e)return this.convert(a.a.db.select(this.tablename,["id"],[e],[]));throw new Error("id \u4e0d\u80fd\u4e3a\u7a7a")}},{key:"selectAll",value:function(){return a.b?this.convert(a.a.db.selectAll(this.tablename)):[]}},{key:"delete",value:function(e){a.b&&a.a.db.delete(this.tablename,["id"],[e],[])}},{key:"deleteAll",value:function(){a.b&&a.a.db.deleteAll(this.tablename)}},{key:"convert",value:function(e){}}],[{key:"getDateStr",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e){if(t)return(new Date).timeStr();throw new Error("\u65e5\u671f\u4e0d\u80fd\u4e3a null")}if(e instanceof Date)return e.timeStr();throw new Error("\u65e5\u671f\u683c\u5f0f\u4e0d\u4e3a Date")}}]),e}()},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(14),i=n(15),a=n(11),o=n(105),c=n(52),l=n(188),u=function(){function e(){Object(r.a)(this,e)}return Object(i.a)(e,null,[{key:"getIncomeTypes",value:function(){return this.refreshTypes(!1),this.incomeTypes}},{key:"getExpenditureTypes",value:function(){return this.refreshTypes(!1),this.expendTypes}},{key:"getIncomeExpendTypeByCode",value:function(e){return this.refreshTypes(!1),this.codeToType[e]}},{key:"getIncomeExpendGroupByCode",value:function(e){this.refreshTypes(!1);for(var t=this.codeToParentCode[e];null!=t;)e=t,t=this.codeToParentCode[e];return this.getIncomeExpendTypeByCode(e)}},{key:"refreshTypes",value:function(e){var t=this;(0==this.incomeTypes.length||0==this.expendTypes.length||e)&&(this.incomeTypes=[],this.expendTypes=[],this.codeToType={},this.nameToType={},this.codeToParentCode={},l.a.getAll(c.c.IncomeType).forEach((function(e){return t._addFromUserConfig(e)})),l.a.getAll(c.c.ExpenditureType).forEach((function(e){return t._addFromUserConfig(e)})))}},{key:"_addFromUserConfig",value:function(e){var t=new o.b(e);this.codeToType[e.code]=t,this.codeToParentCode[e.code]=e.parent_code,e.type===c.c.IncomeType?this.incomeTypes.push(t):this.expendTypes.push(t),e.code>this.maxCode&&(this.maxCode=e.code),e.code<this.minCode&&(this.minCode=e.code)}},{key:"updateType",value:function(e,t,n,r){var i=e.config;i.name=t,i.parent_code=n,i.status=r,l.a.save(i)}},{key:"addType",value:function(e,t,n,r){var i=null;i=e===c.c.IncomeType?this.maxCode+10:this.minCode-10;var a=new c.a;a.type=e,a.code=i,a.name=t,a.parent_code=n,a.status=r,l.a.save(a)}},{key:"upsert",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new o.a;a.id=i,a.type=t,a.desc=r,a.money=e,a.happenTime=n,a.save()}},{key:"queryMonth",value:function(e){var t=a.d.monthStart(e);return o.a.queryTimeBetwen(t,a.d.monthEnd(t))}},{key:"queryTimeBetwen",value:function(e,t){return o.a.queryTimeBetwen(e,t)}},{key:"delete",value:function(e){o.a.delete(e)}}]),e}();u.incomeTypes=[],u.expendTypes=[],u.codeToType={},u.nameToType={},u.codeToParentCode={},u.maxCode=0,u.minCode=0},806:function(e,t,n){"use strict";n.r(t);var r=n(28),i=n(536),a=n.n(i),o=n(111),c=n.n(o),l=(n(552),n(80)),u=n.n(l),s=n(34),d=(n(661),n(14)),y=n(15),h=n(22),f=n(21),p=n(810),v=n(388),m=n(213),b=n(0),j=n.n(b),g=n(75),x=n(41),O=n.n(x),k=n(817),P=n(811),S=n(221),T=n(131),M=n(90),w=n(9),D=p.a.Content,I=k.a.Text,C=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={},r.testViewVisibility="hidden",s.a.isProduction()||(r.testViewVisibility="visible"),r}return Object(y.a)(n,[{key:"refreshDB",value:function(){var e=Object(g.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.initDb(t[0]);case 2:this.props.onDbReady();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.createDb();case 2:this.props.onDbReady();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e;s.b?null===(e=s.a.db)||void 0===e||e.export():v.b.error("\u8bf7\u5148\u52a0\u8f7dDB\u6587\u4ef6")}},{key:"click1",value:function(){}},{key:"click2",value:function(){}},{key:"render",value:function(){var e=this;return Object(w.jsxs)(D,{className:"Content",children:[Object(w.jsxs)(P.a,{orientation:"center",children:["\u7248\u672c\uff1a",s.a.getVersion()]}),Object(w.jsxs)(S.a,{style:{padding:"10px 50px 50px",backgroundColor:"#eee"},children:[Object(w.jsxs)(T.a,{span:8,align:"center",children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u65b0\u5efaDB\u6587\u4ef6"}),Object(w.jsx)(M.a,{onClick:function(){return e.create()},children:"\u65b0\u5efa"})]}),Object(w.jsxs)(T.a,{span:8,align:"center",children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u52a0\u8f7dDB\u6587\u4ef6"}),Object(w.jsx)(I,{children:this.state.fileName}),Object(w.jsx)("input",{type:"file",id:"dbfile",accept:".db",onChange:function(t){return e.refreshDB(t.target.files)}})]}),Object(w.jsxs)(T.a,{span:8,align:"center",children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u5bfc\u51faDB\u6587\u4ef6"}),Object(w.jsx)(M.a,{onClick:function(){return e.export()},children:"\u4fdd\u5b58"})]})]}),Object(w.jsxs)(S.a,{style:{padding:"10px 50px 50px",backgroundColor:"#eee",margin:"10px 0",visibility:this.testViewVisibility},children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u6d4b\u8bd5\u6309\u94ae"}),Object(w.jsx)(M.a,{onClick:function(){return e.click1()},children:"click1"}),Object(w.jsx)(M.a,{onClick:function(){return e.click2()},children:"click2"})]})]})}}]),n}(j.a.Component),_=C,E=n(33),N=n(541),A=n(823),L=n(814),R=n(11),B=n(73),q=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).tablename="investment_product",e}return Object(y.a)(n,[{key:"upsert",value:function(e){var t,n,r=B.a.getDateStr(e.gmtCreate,!0),i=B.a.getDateStr(e.gmtModified);null==e.id?null===(t=s.a.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","name","type","desc","fix_vote"],[r,i,e.name,e.type.code,e.desc,e.fixVote]):null===(n=s.a.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","name","type","desc","fix_vote"],[r,i,e.name,e.type.code,e.desc,e.fixVote])}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(E.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=new K;a.id=i[0],a.gmtCreate=new Date(i[1]),a.gmtModified=new Date(i[2]),a.name=i[3],a.type=G.getByCode(i[4]),a.desc=i[5],a.fixVote=i[6],t.push(a)}}catch(o){r.e(o)}finally{r.f()}return t}}]),n}(B.a),U=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).tablename="investment_detail",e}return Object(y.a)(n,[{key:"upsert",value:function(e){var t,n,r=B.a.getDateStr(e.gmtCreate,!0),i=B.a.getDateStr(e.gmtModified),a=B.a.getDateStr(e.happenTime);return null==e.id?null===(t=s.a.db)||void 0===t?void 0:t.insert(this.tablename,["gmt_create","gmt_modified","product_id","product_name","product_type","money","happen_time","buy_sell_id","record_type","count"],[r,i,e.productId,e.productName,e.productType.code,e.money,a,e.buySellId,e.recordType.code,e.count]):(null===(n=s.a.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","product_id","product_name","product_type","money","happen_time","buy_sell_id","record_type","count"],[r,i,e.productId,e.productName,e.productType.code,e.money,a,e.buySellId,e.recordType.code,e.count]),e.id)}},{key:"select",value:function(e,t,n,r){var i;if(!s.b)return[];if(null!=n&&r<n)throw new Error("\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4");var a=[],o=[],c=[];return null!=e&&(a.push("product_id"),o.push(e),c.push("=")),null!=t&&(a.push("record_type"),o.push(t.code),c.push("=")),null!=n&&(a.push("happen_time"),o.push(n.timeStr()),c.push(">")),null!=r&&(a.push("happen_time"),o.push(r.timeStr()),c.push("<")),this.convert(null===(i=s.a.db)||void 0===i?void 0:i.selectAndOrder(this.tablename,a,o,c,["happen_time desc","gmt_modified desc"]))}},{key:"selectBySellId",value:function(e){var t;return this.convert(null===(t=s.a.db)||void 0===t?void 0:t.select(this.tablename,["buy_sell_id"],[e],["="]))}},{key:"deleteBySellId",value:function(e){var t;null===(t=s.a.db)||void 0===t||t.delete(this.tablename,["buy_sell_id"],[e],["="])}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(E.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=new F;a.id=i[0],a.gmtCreate=new Date(i[1]),a.gmtModified=new Date(i[2]),a.productId=i[3],a.productName=i[4],a.productType=G.getByCode(i[5]),a.money=i[6],a.happenTime=new Date(i[7]),a.buySellId=i[8],a.recordType=Y.getByCode(i[9]),a.count=i[10],t.push(a)}}catch(o){r.e(o)}finally{r.f()}return t}}]),n}(B.a),V=n(147),K=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).name=null,e.type=null,e.desc=null,e.fixVote=null,e}return Object(y.a)(n,[{key:"save",value:function(){this.gmtModified=new Date,R.a.isNull(this.fixVote)&&(this.fixVote=0),n.repo.upsert(this)}}],[{key:"queryAll",value:function(){return this.repo.selectAll()}},{key:"delete",value:function(e){n.repo.delete(e)}}]),n}(V.a);K.repo=new q;var F=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).productId=null,e.productName=null,e.productType=null,e.money=null,e.count=null,e.happenTime=null,e.buySellId=null,e.recordType=null,e}return Object(y.a)(n,[{key:"save",value:function(){return this.gmtModified=new Date,n.repo.upsert(this)}},{key:"delete",value:function(){this.recordType.code===Y.BuySell.code&&n.repo.deleteBySellId(this.id),n.repo.delete(this.id)}}],[{key:"query",value:function(e){return this.repo.get(e)}},{key:"queryTimeBetwen",value:function(e,t,n,r){return this.repo.select(e,t,n,r)}}]),n}(V.a);F.repo=new U;var Y=function(){function e(t,n){Object(d.a)(this,e),this.code=t,this.name=n}return Object(y.a)(e,null,[{key:"getByCode",value:function(e){var t,n=Object(E.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"values",value:function(){return[this.BuySell,this.CurrentPrice,this.Profit,this.AssetDebtCurrentPrice,this.AssetDebtProfit]}}]),e}();Y.BuySell=new Y(1,"\u4e70\u5165\u6216\u5356\u51fa"),Y.CurrentPrice=new Y(2,"\u6295\u8d44\u7c7b\u73b0\u4ef7"),Y.Profit=new Y(3,"\u6295\u8d44\u7c7b\u6536\u76ca"),Y.AssetDebtCurrentPrice=new Y(4,"\u8d44\u4ea7/\u8d1f\u503a\u7c7b\u73b0\u4ef7"),Y.AssetDebtProfit=new Y(5,"\u8d44\u4ea7/\u8d1f\u503a\u7c7b\u6536\u76ca");var G=function(){function e(t,n){Object(d.a)(this,e),this.code=t,this.name=n}return Object(y.a)(e,[{key:"isAsset",value:function(){return this===e.Product.saving}},{key:"isDebt",value:function(){return this===e.Product.debt}},{key:"isStock",value:function(){return this===e.Product.stock}},{key:"isFund",value:function(){return this===e.Product.stock_fund||this===e.Product.etf||this===e.Product.bond}}],[{key:"getByCode",value:function(e){var t,n=Object(E.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"toList",value:function(t){if(t instanceof e)return[t];for(var n=[],r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];n=n.concat(this.toList(t[a]))}return n}},{key:"values",value:function(){return this.toList(this.Product)}}]),e}();G.Product={saving:new G(1e6,"\u73b0\u91d1\u7c7b\u8d44\u4ea7"),stock_fund:new G(2e6,"\u80a1\u7968\u7c7b\u57fa\u91d1"),etf:new G(3e6,"\u6307\u6570\u7c7b\u57fa\u91d1"),bond:new G(4e6,"\u503a\u5238\u7c7b\u57fa\u91d1"),stock:new G(5e6,"\u80a1\u7968"),debt:new G(6e6,"\u8d1f\u503a")};var z=function(){function e(){Object(d.a)(this,e)}return Object(y.a)(e,null,[{key:"getProductTypes",value:function(){return G.toList(G.Product)}},{key:"upsertProduct",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=new K;i.id=r,i.type=G.getByCode(e),i.desc=n,i.name=t,i.save()}},{key:"queryProducts",value:function(){return K.queryAll()}},{key:"editProduct",value:function(e,t,n){e.fixVote=n,e.desc=t,e.save()}},{key:"deleteProduct",value:function(e){K.delete(e.id)}},{key:"getAllInvestDetailBefore",value:function(e){var t=this,n=F.queryTimeBetwen(null,null,null,e),r={fund:{},stock:{},asset:{},debt:{}};return n.forEach((function(e){t.dealDetail(e,r)})),r}},{key:"dealDetail",value:function(e,t){var n=null;return n=e.productType.isAsset()?t.asset:e.productType.isDebt()?t.debt:e.productType.isStock()?t.stock:t.fund,R.a.isNull(n[e.productId])&&(n[e.productId]={}),(n=n[e.productId]).info=e,e.recordType==Y.CurrentPrice||e.recordType==Y.AssetDebtCurrentPrice?void 0===n.currentPrice&&(n.currentPrice=e):e.recordType==Y.Profit||e.recordType==Y.AssetDebtProfit?(R.a.isNull(n.profits)&&(n.profits={totalMoney:0,datas:[]}),n.profits.totalMoney+=e.money,n.profits.datas.push(e)):e.recordType==Y.BuySell&&(R.a.isNull(n.buySells)&&(n.buySells={totalMoney:0,totalSellMoney:0,totalCount:0,datas:[]}),R.a.notNumber(e.count)||(n.buySells.totalCount+=e.count),n.buySells.totalMoney+=e.money,e.money<0&&(n.buySells.totalSellMoney+=e.money),n.buySells.datas.push(e)),t}},{key:"getProductTotalBuySellBefore",value:function(e,t){return F.queryTimeBetwen(e,Y.BuySell,null,t)}},{key:"addAssetDebtProfit",value:function(e,t,n,r,i,a){R.a.notNumber(r)||0==r||this._upsertInvest(e,t,n,r,a,Y.AssetDebtProfit),this._upsertInvest(e,t,n,i,a,Y.AssetDebtCurrentPrice)}},{key:"addBuyInvest",value:function(e,t,n,r,i,a,o){var c=this._upsertInvest(e,t,n,i,o,Y.BuySell,r);this._upsertInvest(e,t,n,a,o,Y.CurrentPrice,null,c)}},{key:"addSellInvest",value:function(e,t,n,r,i,a,o,c){var l=0;this.getProductTotalBuySellBefore(e,new Date(c.getTime()+1e3)).forEach((function(e){l+=e.money}));var u=l-(a-o),s=i-u;console.log("totalInvestMoney: ".concat(l," currentProfit: ").concat(o," currentPrice: ").concat(a," principal: ").concat(u," sellGetMoney: ").concat(i," sellProfit: ").concat(s)),this.addSellInvestOfProfit(e,t,n,r,i,s,a,c)}},{key:"addSellInvestOfProfit",value:function(e,t,n,r,i,a,o,c){var l=i-a;R.a.notNumber(r)||(r*=-1);var u=this._upsertInvest(e,t,n,-1*l,c,Y.BuySell,r);o>=0&&this._upsertInvest(e,t,n,o,c,Y.CurrentPrice,null,u),this._upsertInvest(e,t,n,a,c,Y.Profit,null,u)}},{key:"deleteInvestDetail",value:function(e){e.delete()}},{key:"_upsertInvest",value:function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=new F;return u.id=l,u.productId=e,u.productName=t,u.productType=G.getByCode(n),u.money=r,u.count=o,u.happenTime=i,u.buySellId=c,u.recordType=a,u.save()}}]),e}(),Q=z,$=n(105),H=n(52),W=n(78),J=function(){function e(){Object(d.a)(this,e)}return Object(y.a)(e,null,[{key:"getTypeTrees",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=[];function i(e){if(t||e.config.status!=H.b.Disabled){var i=e.config.parent_code;R.a.isNull(i)&&(n.push(e.code),r.push({key:e.code,entity:e,childs:[]}))}}function a(e){if(t||e.config.status!=H.b.Disabled){var i=e.config.parent_code;if(!R.a.isNull(i)){var a=n.indexOf(i);if(a<0)return;r[a].childs.push({key:e.code,entity:e})}}}return e==H.c.IncomeType?(W.a.getIncomeTypes().forEach((function(e){return i(e)})),W.a.getIncomeTypes().forEach((function(e){return a(e)}))):(W.a.getExpenditureTypes().forEach((function(e){return i(e)})),W.a.getExpenditureTypes().forEach((function(e){return a(e)}))),r}},{key:"queryMonthData",value:function(e){return this._calIncomeExpendData(W.a.queryMonth(e))}},{key:"queryYearData",value:function(e){var t=this._calIncomeExpendData(W.a.queryTimeBetwen(R.d.monthStart(e),R.d.yearEnd(e))),n=this._calSumByMonth(t.income.details),r=this._calSumByMonth(t.expend.details);return t.income.sumByMonth=n,t.expend.sumByMonth=r,t}},{key:"_calSumByMonth",value:function(e){var t,n={},r=Object(E.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=R.d.monthStr(i.happenTime);a in n||(n[a]=0),n[a]+=i.money}}catch(o){r.e(o)}finally{r.f()}return Object.keys(n).map((function(e){return{month:e,total:n[e]}}))}},{key:"_calIncomeExpendData",value:function(e){var t=this,n={income:{total:0,details:[]},expend:{total:0,details:[]}};return e.sort((function(e,t){return Math.abs(e.type.code)>Math.abs(t.type.code)?1:-1})).forEach((function(e){var r=n.expend;e.type.isIncome()&&(r=n.income),r.details.push(t._newEntityFromDetail(e)),r.total+=e.money})),n}},{key:"_newEntityFromDetail",value:function(e){return{id:e.id,happenTime:e.happenTime,title:e.type.name,money:e.money,desc:e.desc,type:e.type}}}]),e}(),X=function(){function e(){Object(d.a)(this,e)}return Object(y.a)(e,null,[{key:"queryMonthData",value:function(e){var t=R.d.monthStart(e),n=R.d.monthEnd(e),r=Q.getAllInvestDetailBefore(n);return{asset:this._getInvestSummary(r.asset,t,n),debt:this._getInvestSummary(r.debt,t,n),fund:this._getInvestSummary(r.fund,t,n),stock:this._getInvestSummary(r.stock,t,n)}}},{key:"queryYearData",value:function(e){var t=R.d.monthStart(e),n=R.d.yearEnd(e),r=Q.getAllInvestDetailBefore(n);return{asset:this._getInvestSummary(r.asset,t,n),debt:this._getInvestSummary(r.debt,t,n),fund:this._getInvestSummary(r.fund,t,n),stock:this._getInvestSummary(r.stock,t,n)}}},{key:"getPaperProfit",value:function(e){var t,n;return R.a.isNull(e)?0:(null===(t=e.currentPrice)||void 0===t?void 0:t.money)-(null===(n=e.buySells)||void 0===n?void 0:n.totalMoney)}},{key:"getPaperProfitPercent",value:function(e){var t;return R.c.safeDivision(this.getPaperProfit(e),null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)}},{key:"getSellProfitPercent",value:function(e){var t,n;return R.c.safeDivision(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney,Math.abs(null===(n=e.buySells)||void 0===n?void 0:n.filterSellMoney))}},{key:"_getInvestSummary",value:function(e,t,n){var r=this._getProfitSummary(e,t,n);return{totalMoneys:this._getTotalMoney(e),totalProfitMoneys:[r[0],r[1]],products:r[2]}}},{key:"_getProfitSummary",value:function(e,t,n){for(var r=0,i=0,a={},o=0,c=Object.keys(e);o<c.length;o++){var l=c[o],u=e[l];R.a.isNull(u.profits)||function(){var e=0,a=[];u.profits.datas.forEach((function(r){R.d.inTime(r.happenTime,t,n)&&(e+=r.money,a.push(r))})),r+=u.profits.totalMoney,0!==e&&(i+=e,u.profits.filterDatas=a,u.profits.filterTotalMoney=e)}(),R.a.isNull(u.buySells)||function(){var e=0,r=0,i=0,a=[];u.buySells.datas.forEach((function(o){R.d.inTime(o.happenTime,t,n)&&0!==o.money&&(e+=o.money,o.money<0&&(r+=o.money),R.a.notNumber(o.count)||(i+=o.count),a.push(o))})),u.buySells.filterMoney=e,u.buySells.filterSellMoney=r,u.buySells.filterTotalCount=i,u.buySells.filterDatas=a}(),a[l]=u}return[r,i,a]}},{key:"_getTotalMoney",value:function(e){for(var t=0,n=0,r=0,i=Object.keys(e);r<i.length;r++){var a=e[i[r]];R.a.isNull(a.currentPrice)||(t+=a.currentPrice.money),R.a.isNull(a.buySells)||(n+=a.buySells.totalMoney)}return[t,n]}}]),e}(),Z=n(820),ee=n(3),te=n(818),ne=n(254),re=n(819),ie=n(815),ae=n(537),oe=n(822),ce=n(816),le=k.a.Text,ue=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={extra:r.props.extra},r}return Object(y.a)(n,[{key:"getOptions",value:function(e){var t=[];if(R.a.isNull(e))return t;var n=Object.keys(e);if(0===n.length)return t;if(1===e[n[0]].length){var r,i=Object(E.a)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.push({value:a,label:e[a][0]})}}catch(f){i.e(f)}finally{i.f()}}else{var o,c=[],l=Object(E.a)(n);try{for(l.s();!(o=l.n()).done;){var u=e[o.value][2];c.includes(u)||(t.push({label:u,options:[]}),c.push(u))}}catch(f){l.e(f)}finally{l.f()}var s,d=Object(E.a)(n);try{for(d.s();!(s=d.n()).done;){var y=s.value,h=e[y][2];t[c.indexOf(h)].options.push({value:y,label:e[y][0]})}}catch(f){d.e(f)}finally{d.f()}}return t}},{key:"itemToWidget",value:function(e){var t,n,r,i,a,o,l,u,s,d,y,h=this,f=e.name,p=null!==(t=e.type)&&void 0!==t?t:e.name,v=null!==(n=e.required)&&void 0!==n&&n?"(\u5fc5\u586b)":"",m="",b="",j=e.defaultValue;R.a.isNull(this.state[f])&&!R.a.isNull(j)&&(this.state[f]=j);var g="220px";switch(p){case"treeType":return m=null!==(r=e.hint)&&void 0!==r?r:"\u7c7b\u578b",b=null!==(i=e.placeholder)&&void 0!==i?i:"\u8bf7\u9009\u62e9(\u652f\u6301\u641c\u7d22)",Object(w.jsxs)(S.a,{align:"middle",children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsxs)(le,{children:[m,v,":"]})}),Object(w.jsx)(T.a,{flex:"auto",align:"center",children:Object(w.jsx)(te.a,{style:{width:g},dropdownStyle:{maxHeight:600,overflow:"auto"},showSearch:!0,treeData:e.treeData,placeholder:b,treeDefaultExpandAll:!1,value:this.state[f],onChange:function(e){h.setState(Object(ee.a)({},f,e))}})})]});case"type":m=null!==(a=e.hint)&&void 0!==a?a:"\u7c7b\u578b";var x=f+"Name",O=f+"ParentCode",k=f+"ParentName",P=this.getOptions(e.code2Name);return Object(w.jsxs)(S.a,{align:"middle",children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsxs)(le,{children:[m,v,":"]})}),Object(w.jsx)(T.a,{flex:"auto",align:"center",children:Object(w.jsx)(ne.a,{style:{width:g},value:this.state[f],onChange:function(t){var n;h.setState((n={},Object(ee.a)(n,f,t),Object(ee.a)(n,x,e.code2Name[t][0]),Object(ee.a)(n,O,e.code2Name[t][1]),Object(ee.a)(n,k,e.code2Name[t][2]),n))},options:P})})]});case"money":var M=e.moneyPon;m=null!==(o=e.hint)&&void 0!==o?o:"\u91d1\u989d";var D=f+"Pon";return this.state[D]=M,Object(w.jsxs)(S.a,{align:"middle",style:{margin:"10px 0"},children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsxs)(le,{children:[m,v,":"]})}),Object(w.jsx)(T.a,{flex:"auto",align:"center",children:Object(w.jsx)(re.a,{style:{width:g},addonBefore:M?"+":"-",value:this.state[f],onChange:function(e){h.setState(Object(ee.a)({},f,e))}})})]});case"date":R.a.isNull(e.inMonth)||!R.a.isNull(this.state[f])&&R.d.inMonth(this.state[f],new Date(e.inMonth))||(this.state[f]=new Date(e.inMonth)),m=null!==(l=e.hint)&&void 0!==l?l:"\u53d1\u751f\u65e5\u671f";var I=null!==(u=e.picker)&&void 0!==u?u:"";return Object(w.jsxs)(S.a,{align:"middle",style:{margin:"10px 0"},children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsxs)(le,{children:[m,v,":"]})}),Object(w.jsx)(T.a,{flex:"auto",align:"center",children:Object(w.jsx)(ie.a,{style:{width:g},picker:I,value:c()(this.state[f]),onChange:function(e,t){h.setState(Object(ee.a)({},f,e.toDate()))}})})]});case"input":return m=null!==(s=e.hint)&&void 0!==s?s:"\u63cf\u8ff0",b=null!==(d=e.placeholder)&&void 0!==d?d:"\u8bf7\u8f93\u5165\u6587\u672c",Object(w.jsxs)(S.a,{align:"middle",style:{margin:"10px 0"},children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsxs)(le,{children:[m,v,":"]})}),Object(w.jsx)(T.a,{flex:"auto",align:"center",children:Object(w.jsx)(ae.a,{placeholder:b,style:{width:g},value:this.state[f],onChange:function(e){h.setState(Object(ee.a)({},f,e.target.value))}})})]});case"switch":return m=null!==(y=e.hint)&&void 0!==y?y:"\u5f00\u5173",Object(w.jsxs)(S.a,{align:"middle",style:{margin:"10px 0"},children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsxs)(le,{children:[m,v,":"]})}),Object(w.jsx)(T.a,{flex:"auto",align:"center",children:Object(w.jsx)(oe.a,{defaultChecked:this.state[f],onChange:function(e){h.setState(Object(ee.a)({},f,e))}})})]});default:return Object(w.jsx)(S.a,{children:Object(w.jsxs)(le,{children:["\u672a\u652f\u6301\u8f93\u5165\u914d\u7f6e ",e.name]})})}}},{key:"checkData",value:function(e,t){try{var n=e[t.name];if(!0===t.required&&R.a.isNull(n))throw new Error(t.name+" \u5fc5\u987b\u8f93\u5165");if(!0===t.isNum&&isNaN(n))throw new Error(t.name+" \u5fc5\u987b\u4e3a\u6570\u5b57");if(!R.a.isNull(t.inMonth)&&!R.d.inMonth(n,new Date(t.inMonth)))throw new Error("\u53d1\u751f\u65e5\u671f\u4ec5\u53ef\u9009\u5728\u5f53\u524d\u6708\u4efd\uff1a"+t.inMonth);return!0}catch(r){return console.warn(r),alert(r),!1}}},{key:"render",value:function(){var e,t,n=this,r=[],i=Object(E.a)(this.props.cfgs);try{for(i.s();!(t=i.n()).done;){var a=t.value;r.push(this.itemToWidget(a))}}catch(o){i.e(o)}finally{i.f()}return Object(w.jsxs)(ce.a,{title:null!==(e=this.props.title)&&void 0!==e?e:"\u65b0\u589e",style:{margin:"0px 5px"},bodyStyle:{padding:"25px"},children:[r,Object(w.jsx)(S.a,{justify:"center",style:{margin:"15px 0 0 0"},children:Object(w.jsx)(T.a,{children:Object(w.jsx)(M.a,{type:"primary",onClick:function(){var e,t=Object(E.a)(n.props.cfgs);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!n.checkData(n.state,r))return}}catch(o){t.e(o)}finally{t.f()}n.props.onSubmit(n.state)&&n.setState({})},children:" \u63d0\u4ea4 "})})})]})}}],[{key:"getMoney",value:function(e,t){var n=e[t+"Pon"]?1:-1;return R.a.notNumber(e[t])?NaN:e[t]*n*100}}]),n}(j.a.Component),se=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={},r}return Object(y.a)(n,[{key:"render",value:function(){var e=this,t=this.props.title,n=this.props.visible,r=this.props.cfgs,i=this.props.extra;return Object(w.jsx)(Z.a,{title:t,visible:n,footer:null,onCancel:function(){return e.props.onCancel()},children:Object(w.jsx)(ue,{title:"",cfgs:r,extra:i,onSubmit:function(t){return e.props.onOk(t)}},this.props.key)})}}]),n}(j.a.Component),de=p.a.Content,ye=k.a.Text,he=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={},r.investColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){var t="gold";return e.info.productType.isStock()&&(t="red"),Object(w.jsx)(N.a,{color:t,children:e.info.productType.name},e.info.productType.code)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:e.info.productName})}},{title:"\u6700\u65b0\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.d.dayStr(null===(t=e.currentPrice)||void 0===t?void 0:t.happenTime)})}},{title:"\u6295\u8d44\u603b\u989d",key:"totalInvest",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.c.getStr(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalMoney)}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=X.getPaperProfitPercent(e);return Object(w.jsx)(ye,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=X.getPaperProfitPercent(e.entity),r=X.getPaperProfitPercent(t.entity);return R.a.compare(n,r)}},{title:"\u8d26\u9762\u5229\u6da6",key:"paperProfit",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getStr(X.getPaperProfit(e))})},sorter:function(e,t){return R.c.compare(X.getPaperProfit(e.entity),X.getPaperProfit(t.entity))}},{title:"\u6700\u65b0\u4ef7\u503c",key:"lastPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.c.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u5356\u51fa\u603b\u989d",key:"sellPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.c.getStr(Math.abs(null===(t=e.buySells)||void 0===t?void 0:t.totalSellMoney))})},sorter:function(e,t){var n,r;return R.c.compareAbs(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalSellMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalSellMoney)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=r.getSellProfitPercent(e);return Object(w.jsx)(ye,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=r.getSellProfitPercent(e.entity),i=r.getSellProfitPercent(t.entity);return R.a.compare(n,i)}},{title:"\u5356\u51fa\u5229\u6da6",key:"sellProfit",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.c.getStr(null===(t=e.profits)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.totalMoney)}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.c.getDetailStr(R.c.safeDivision(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney,e.buySells.totalCount))})}},{title:"\u73b0\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:R.c.getDetailStr(R.c.safeDivision(null===(t=e.currentPrice)||void 0===t?void 0:t.money,e.buySells.totalCount))})}},{title:"\u4efd\u6570",key:"totalCount",dataIndex:"entity",render:function(e){var t,n=null===(t=e.buySells)||void 0===t?void 0:t.totalCount;return Object(w.jsx)(ye,{children:0==Math.abs(n)?"-":Math.abs(n)})}}],r.subInvestColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.d.dayStr(e.happenTime)})}},{title:"\u4e70\u5165/\u5356\u51fa\u672c\u91d1",key:"principal",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getStr(e.money)})}},{title:"\u5230\u8d26\u603b\u989d",key:"sellGetMoney",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getStr(-1*e.money+e.profitMoney)})}},{title:"\u5229\u6da6",key:"profit",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getStr(e.profitMoney)})}},{title:"\u5229\u6da6\u7387",key:"profitPercent",dataIndex:"entity",render:function(e){var t=R.c.safeDivision(e.profitMoney,Math.abs(e.money));return Object(w.jsx)(ye,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})}},{title:"\u4efd\u6570",key:"totalCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:0==Math.abs(e.count)?"-":Math.abs(e.count)})}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getDetailStr(R.c.safeDivision(Math.abs(e.money),Math.abs(e.count)))})}},{title:"\u5356\u51fa\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getDetailStr(R.c.safeDivision(Math.abs(-1*e.money+e.profitMoney),Math.abs(e.count)))})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(w.jsx)(A.b,{size:"middle",children:Object(w.jsx)("a",{onClick:function(){r.deleteInvestDetail(t.entity)},children:"\u5220\u9664"})})}}],r.productColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){var t,n,r,i,a,o="gold";return null!==(t=e.type)&&void 0!==t&&t.isAsset()?o="geekblue":null!==(n=e.type)&&void 0!==n&&n.isDebt()?o="green":null!==(r=e.type)&&void 0!==r&&r.isStock()&&(o="red"),Object(w.jsx)(N.a,{color:o,children:null===(a=e.type)||void 0===a?void 0:a.name},null===(i=e.type)||void 0===i?void 0:i.code)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:e.name})}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:e.desc})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(w.jsxs)(A.b,{size:"middle",children:[Object(w.jsx)("a",{onClick:function(){r.showEditProductDialog(t.entity)},children:"\u7f16\u8f91"}),Object(w.jsx)("a",{onClick:function(){r.deleteProduct(t.entity)},children:"\u5220\u9664"})]})}}],r.productFixVoteColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return Object(w.jsx)(N.a,{color:"gold",children:e.productTypeName},e.productTypeCode)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:e.productName})}},{title:"\u5b9a\u6295\u989d",key:"fixVote",dataIndex:"entity",render:function(e){return Object(w.jsx)(ye,{children:R.c.getStr(e.productFixVote)})}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=e.paperProfitPercent;return Object(w.jsx)(ye,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=e.entity.paperProfitPercent,r=t.entity.paperProfitPercent;return R.a.compare(n,r)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=e.sellProfitPercent;return Object(w.jsx)(ye,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=e.entity.sellProfitPercent,r=t.entity.sellProfitPercent;return R.a.compare(n,r)}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(ye,{children:null===(t=e.product)||void 0===t?void 0:t.desc})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){if(!R.a.isNull(t.entity.product))return Object(w.jsxs)(A.b,{size:"middle",children:[Object(w.jsx)("a",{onClick:function(){r.showEditProductDialog(t.entity.product)},children:"\u7f16\u8f91"}),Object(w.jsx)("a",{onClick:function(){r.deleteProduct(t.entity.product)},children:"\u5220\u9664"})]})}}],r}return Object(y.a)(n,[{key:"getSellProfitPercent",value:function(e){var t,n;return R.c.safeDivision(null===(t=e.profits)||void 0===t?void 0:t.totalMoney,Math.abs(null===(n=e.buySells)||void 0===n?void 0:n.totalSellMoney))}},{key:"showEditProductDialog",value:function(e){this.setState({showDialog:"editProduct",currentProduct:e})}},{key:"editProduct",value:function(e,t){Q.editProduct(e,t.desc,ue.getMoney(t,"money")),this.hideDialog()}},{key:"hideDialog",value:function(){this.setState({showDialog:"",currentProduct:null})}},{key:"deleteInvestDetail",value:function(e){Q.deleteInvestDetail(e),this.refreshPage()}},{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"addProduct",value:function(e){Q.upsertProduct(e.type,e.name,e.desc),this.refreshPage()}},{key:"queryProducts",value:function(){return Q.queryProducts()}},{key:"deleteProduct",value:function(e){Q.deleteProduct(e),this.refreshPage()}},{key:"queryAllInvestData",value:function(){return Q.getAllInvestDetailBefore(null)}},{key:"render",value:function(){var e,t,n,r=this,i={};Q.getProductTypes().forEach((function(e){i[e.code]=[e.name]}));var a=[],o=[],c=[],l={};Q.queryProducts().sort((function(e,t){return Math.abs(e.type.code)<Math.abs(t.type.code)?1:-1})).forEach((function(e){e.type.isAsset()||e.type.isDebt()?a.push({key:e.id,entity:e}):e.type.isStock()?o.push({key:e.id,entity:e}):c.push({key:e.id,entity:e}),l[e.id]=e}));for(var u=this.queryAllInvestData(),s=[],d=[],y=[],h={productTypeCode:99999999,productTypeName:"\u6c47\u603b",productName:"\u6c47\u603b",productFixVote:0,paperProfit:0,sellProfit:0,paperProfitPercent:0,sellProfitPercent:0},f=0,p=Object.keys(u.fund);f<p.length;f++){var v=p[f],m=u.fund[v];s.push({key:v,entity:m});var b=l[v],j=X.getPaperProfitPercent(m),g=this.getSellProfitPercent(m),x={product:b,productTypeCode:b.type.code,productTypeName:b.type.name,productName:b.name,productFixVote:b.fixVote,paperProfit:b.fixVote*j,sellProfit:b.fixVote*g,paperProfitPercent:j,sellProfitPercent:g};h.productFixVote+=x.productFixVote,h.paperProfit+=x.paperProfit,h.sellProfit+=x.sellProfit,y.push({key:v,entity:x})}h.paperProfitPercent=h.paperProfit/h.productFixVote,h.sellProfitPercent=h.sellProfit/h.productFixVote,y.push({key:9999999,entity:h});for(var O=0,k=Object.keys(u.stock);O<k.length;O++){var M=k[O],D=u.stock[M];d.push({key:M,entity:D})}var I=function(e,t){var n=[];return e.entity.buySells.datas.forEach((function(t){if(0!==t.money){var r,i,a,o=Object(E.a)(null!==(r=null===(i=e.entity.profits)||void 0===i?void 0:i.datas)&&void 0!==r?r:[]);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c.buySellId===t.id){t.profitMoney=c.money;break}}}catch(l){o.e(l)}finally{o.f()}n.push({key:t.id,entity:t})}})),Object(w.jsx)(L.a,{columns:r.subInvestColumns,dataSource:n,pagination:!1})},C=function(e){var t;return!R.a.isNull(null===(t=e.entity.buySells)||void 0===t?void 0:t.datas)};return Object(w.jsxs)(de,{className:"Content",children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u6295\u8d44\u8be6\u60c5"}),Object(w.jsx)(L.a,{columns:this.investColumns,dataSource:d,expandable:{expandedRowRender:I,rowExpandable:C},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(w.jsx)(L.a,{columns:this.investColumns,dataSource:s,expandable:{expandedRowRender:I,rowExpandable:C},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(w.jsx)(P.a,{orientation:"center",children:"\u6295\u8d44\u4ea7\u54c1"}),Object(w.jsxs)(S.a,{style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(w.jsx)(T.a,{span:8,children:Object(w.jsx)(ue,{title:"\u65b0\u589e\u6295\u8d44\u4ea7\u54c1",cfgs:[{name:"type",code2Name:i,required:!0},{name:"name",type:"input",hint:"\u540d\u79f0",required:!0},{name:"desc",type:"input"}],onSubmit:function(e){return r.addProduct(e),!0}})}),Object(w.jsxs)(T.a,{span:16,children:[Object(w.jsx)(L.a,{columns:this.productColumns,dataSource:o,pagination:{pageSize:10}}),Object(w.jsx)(L.a,{columns:this.productFixVoteColumns,dataSource:y,pagination:{pageSize:15},scroll:{x:1e3},sortDirections:["descend"]}),Object(w.jsx)(L.a,{columns:this.productColumns,dataSource:a,pagination:{pageSize:10}})]})]}),Object(w.jsx)(se,{title:"\u4fee\u6539\u4ea7\u54c1",visible:"editProduct"===this.state.showDialog,cfgs:[{name:"money",hint:"\u5b9a\u6295\u989d",defaultValue:(null===(t=this.state.currentProduct)||void 0===t?void 0:t.fixVote)/100,moneyPon:!0},{name:"desc",type:"input",defaultValue:null===(n=this.state.currentProduct)||void 0===n?void 0:n.desc}],onOk:function(e){return r.editProduct(r.state.currentProduct,e)},onCancel:function(){return r.hideDialog()}},null===(e=this.state.currentProduct)||void 0===e?void 0:e.id)]})}}]),n}(j.a.Component),fe=n(12),pe=n(821),ve=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).tablename="data_summary",e}return Object(y.a)(n,[{key:"upsert",value:function(e){var t,n,r=B.a.getDateStr(e.gmtCreate,!0),i=B.a.getDateStr(e.gmtModified);null==e.id?null===(t=s.a.db)||void 0===t||t.insert(this.tablename,["gmt_create","gmt_modified","type","time","money"],[r,i,e.type.code,e.time.timeStr(),e.money]):null===(n=s.a.db)||void 0===n||n.update(this.tablename,e.id,["gmt_create","gmt_modified","type","time","money"],[r,i,e.type.code,e.time.timeStr(),e.money])}},{key:"selectAllMonthKey",value:function(){var e;return this.convert(null===(e=s.a.db)||void 0===e?void 0:e.select(this.tablename,["type"],[be.BY_MONTH_KEY.code],["="]))}},{key:"convert",value:function(e){var t=[];if(void 0===e||void 0===e[0])return t;var n,r=Object(E.a)(e[0].values);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=new me;a.id=i[0],a.gmtCreate=new Date(i[1]),a.gmtModified=new Date(i[2]),a.type=be.getByCode(i[3]),a.time=new Date(i[4]),a.money=i[5],t.push(a)}}catch(o){r.e(o)}finally{r.f()}return t}}]),n}(B.a),me=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type=null,e.time=null,e.money=null,e}return Object(y.a)(n,[{key:"save",value:function(){this.gmtModified=new Date,n.repo.upsert(this)}}],[{key:"queryAllMonthKey",value:function(){return this.repo.selectAllMonthKey()}},{key:"delete",value:function(e){this.repo.delete(e)}}]),n}(V.a);me.repo=new ve;var be=function(){function e(t,n){Object(d.a)(this,e),this.code=t,this.name=n}return Object(y.a)(e,null,[{key:"getByCode",value:function(e){var t,n=Object(E.a)(this.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.code==e)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"values",value:function(){return[this.BY_MONTH_KEY]}}]),e}();be.BY_MONTH_KEY=new be(1,"\u6309\u6708\u5c55\u793a\u7684\u53ef\u7528\u6708\u4efd");var je=function(){function e(){Object(d.a)(this,e)}return Object(y.a)(e,null,[{key:"addMonth",value:function(e){var t=new me;t.type=be.BY_MONTH_KEY,t.time=R.d.monthStart(e),t.save()}},{key:"queryMonths",value:function(){return me.queryAllMonthKey().map((function(e){return R.d.monthStr(e.time)}))}}]),e}(),ge=k.a.Text,xe=function(){function e(){Object(d.a)(this,e)}return Object(y.a)(e,null,[{key:"getProductTag",value:function(e){return Object(w.jsx)(N.a,{color:this._getProductColor(e),children:e.name},e.code)}},{key:"_getProductColor",value:function(e){return e.isAsset()?"geekblue":e.isDebt()?"green":e.isStock()?"red":"gold"}},{key:"createShowTextRow",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Object(w.jsxs)(S.a,{align:"middle",style:{margin:"0 10px",padding:"4px 0"},children:[Object(w.jsx)(T.a,{span:12,children:Object(w.jsx)(ge,{type:n,strong:!0,children:e})}),Object(w.jsx)(T.a,{span:12,align:"right",children:Object(w.jsx)(ge,{type:n,strong:!0,children:t})})]})}}]),e}(),Oe=p.a.Content,ke=p.a.Sider,Pe=k.a.Text,Se=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={},r.incomeExpendColumns=[{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){var t="geekblue";return"\u4e3b\u52a8\u6536\u5165"===e.title||"\u88ab\u52a8\u6536\u5165"===e.title?t="red":"\u4e3b\u52a8\u652f\u51fa"!==e.title&&"\u88ab\u52a8\u652f\u51fa"!==e.title||(t="green"),Object(w.jsx)(N.a,{color:t,children:e.title},e.title)}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(e.money)})}}],r.subIncomeExpendColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.d.dayStr(e.happenTime)})}},{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:e.title})}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(e.money)})},sorter:function(e,t){return R.c.compareAbs(e.entity.money,t.entity.money)}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:e.desc})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){if(!R.a.isNull(t.entity.id))return Object(w.jsxs)(A.b,{size:"middle",children:[Object(w.jsx)("a",{onClick:function(){console.log(t.entity),r.showDialog("modifyIncomeOrExpend",t.entity)},children:"\u7f16\u8f91"}),Object(w.jsx)("a",{onClick:function(){r.deleteIncomeExpendDetail(t.entity.id)},children:"\u5220\u9664"})]})}}],r.assetDebtColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return xe.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:e.info.productName})}},{title:"\u6700\u65b0\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){var t,n,i="";return R.d.inMonth(null===(t=e.currentPrice)||void 0===t?void 0:t.happenTime,r.monthDate)||(i="secondary"),Object(w.jsx)(Pe,{type:i,children:R.d.dayStr(null===(n=e.currentPrice)||void 0===n?void 0:n.happenTime)})}},{title:"\u603b\u989d",key:"currentPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}}],r.subAssetDebtColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.d.dayStr(e.happenTime)})}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(e.money)})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(w.jsx)(A.b,{size:"middle",children:Object(w.jsx)("a",{onClick:function(){r.deleteInvestDetail(t.entity)},children:"\u5220\u9664"})})}}],r.investColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return xe.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:e.info.productName})}},{title:"\u6700\u65b0\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){var t,n,i="";return R.d.inMonth(null===(t=e.currentPrice)||void 0===t?void 0:t.happenTime,r.monthDate)||(i="secondary"),Object(w.jsx)(Pe,{type:i,children:R.d.dayStr(null===(n=e.currentPrice)||void 0===n?void 0:n.happenTime)})}},{title:"\u5356\u51fa\u603b\u989d",key:"sellPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(Math.abs(null===(t=e.buySells)||void 0===t?void 0:t.filterSellMoney))})},sorter:function(e,t){var n,r;return R.c.compareAbs(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterSellMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterSellMoney)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=X.getSellProfitPercent(e);return Object(w.jsx)(Pe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=X.getSellProfitPercent(e.entity),r=X.getSellProfitPercent(t.entity);return R.a.compare(n,r)}},{title:"\u5356\u51fa\u5229\u6da6",key:"sellProfit",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}},{title:"\u5f53\u671f\u6295\u8d44",key:"timeInvest",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(null===(t=e.buySells)||void 0===t?void 0:t.filterMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterMoney)}},{title:"\u5f53\u671f\u8d26\u9762\u5229\u6da6",key:"qoqPaperProfit",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(r.getQoqPaperProfit(e))})},sorter:function(e,t){return R.c.compare(r.getQoqPaperProfit(e.entity),r.getQoqPaperProfit(t.entity))}},{title:"\u5f53\u671f\u8d26\u9762\u5229\u6da6\u7387",key:"qoqPaperProfitPercent",dataIndex:"entity",render:function(e){var t=r.getQoqPaperProfitPercent(e);return Object(w.jsx)(Pe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=r.getQoqPaperProfitPercent(e.entity),i=r.getQoqPaperProfitPercent(t.entity);return R.a.compare(n,i)}},{title:"\u6295\u8d44\u603b\u989d",key:"totalInvest",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalMoney)}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=X.getPaperProfitPercent(e);return Object(w.jsx)(Pe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=X.getPaperProfitPercent(e.entity),r=X.getPaperProfitPercent(t.entity);return R.a.compare(n,r)}},{title:"\u8d26\u9762\u5229\u6da6",key:"paperProfit",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(X.getPaperProfit(e))})},sorter:function(e,t){return R.c.compare(X.getPaperProfit(e.entity),X.getPaperProfit(t.entity))}},{title:"\u6700\u65b0\u4ef7\u503c",key:"lastPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getDetailStr(R.c.safeDivision(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney,e.buySells.totalCount))})}},{title:"\u73b0\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(Pe,{children:R.c.getDetailStr(R.c.safeDivision(null===(t=e.currentPrice)||void 0===t?void 0:t.money,e.buySells.totalCount))})}}],r.subInvestColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.d.dayStr(e.happenTime)})}},{title:"\u4e70\u5165/\u5356\u51fa\u672c\u91d1",key:"principal",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(e.money)})}},{title:"\u5230\u8d26\u603b\u989d",key:"sellGetMoney",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(Math.abs(e.money)+e.profitMoney)})}},{title:"\u5229\u6da6",key:"profit",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getStr(e.profitMoney)})}},{title:"\u5229\u6da6\u7387",key:"profitPercent",dataIndex:"entity",render:function(e){var t=R.c.safeDivision(e.profitMoney,Math.abs(e.money));return Object(w.jsx)(Pe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getDetailStr(R.c.safeDivision(Math.abs(e.money),Math.abs(e.count)))})}},{title:"\u5356\u51fa\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(Pe,{children:R.c.getDetailStr(R.c.safeDivision(Math.abs(-1*e.money+e.profitMoney),Math.abs(e.count)))})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(w.jsx)(A.b,{size:"middle",children:Object(w.jsx)("a",{onClick:function(){r.deleteInvestDetail(t.entity)},children:"\u5220\u9664"})})}}],r}return Object(y.a)(n,[{key:"getQoqPaperProfit",value:function(e){var t,n=X.getPaperProfit(this._getLastMonthProductDetail(e.info.productId)),r=X.getPaperProfit(e);return R.a.safeGetNumber(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)+r-n}},{key:"getQoqPaperProfitPercent",value:function(e){var t;return R.c.safeDivision(this.getQoqPaperProfit(e),null===e||void 0===e||null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)}},{key:"_getLastMonthProductDetail",value:function(e){for(var t=0,n=[this.lastMonthAllInvestData.fund,this.lastMonthAllInvestData.stock,this.lastMonthAllInvestData.asset,this.lastMonthAllInvestData.debt];t<n.length;t++){var r=n[t];if(e in r.products)return r.products[e]}return null}},{key:"insertData",value:function(e){try{var t,n=ue.getMoney(e,"money"),r=e.date,i=this._praseTypeCode(e.treeType);return W.a.upsert(n,$.b.getByCode(i),r,null!==(t=e.desc)&&void 0!==t?t:""),this.refreshPage(),!0}catch(a){return console.warn(a),alert(a),!1}}},{key:"modifyIncomeOrExpend",value:function(e){var t,n=e.extra,r=this._praseTypeCode(e.treeType),i=null!==(t=e.desc)&&void 0!==t?t:"";W.a.upsert(n.money,$.b.getByCode(r),n.happenTime,i,n.id),this.hideDialog()}},{key:"addBuyInvest",value:function(e){var t=e.type,n=e.typeName,r=e.typeParentCode,i=ue.getMoney(e,"money"),a=ue.getMoney(e,"currentPrice"),o=e.count,c=e.date;return Q.addBuyInvest(t,n,r,o,i,a,c),this.refreshPage(),!0}},{key:"addSellInvest",value:function(e){var t=e.type,n=e.typeName,r=e.typeParentCode,i=e.count,a=ue.getMoney(e,"money"),o=ue.getMoney(e,"currentPrice"),c=ue.getMoney(e,"currentProfit"),l=ue.getMoney(e,"sellProfit"),u=e.date;if(R.a.notNumber(l)){if(R.a.notNumber(c))return v.b.error("\u5356\u51fa\u5229\u6da6 \u6216 \u8d26\u9762\u5229\u6da6 \u5fc5\u987b\u586b\u5199\u4e00\u4e2a\uff01"),!1;Q.addSellInvest(t,n,r,i,a,o,c,u)}else Q.addSellInvestOfProfit(t,n,r,i,a,l,o,u);return this.refreshPage(),!0}},{key:"addAssetDebtProfit",value:function(e){var t=e.type,n=e.typeName,r=e.typeParentCode,i=ue.getMoney(e,"money"),a=ue.getMoney(e,"currentPrice"),o=e.date;return Q.addAssetDebtProfit(t,n,r,i,a,o),this.refreshPage(),!0}},{key:"deleteInvestDetail",value:function(e){Q.deleteInvestDetail(e),this.refreshPage()}},{key:"deleteIncomeExpendDetail",value:function(e){W.a.delete(e),this.refreshPage()}},{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"getByMonthSideDatas",value:function(){var e=je.queryMonths();this.months=e;var t={};return e.forEach((function(e){var n=e.substring(0,4);R.a.isNull(t[n])&&(t[n]=[]),t[n].push(e)})),t}},{key:"showDialog",value:function(e,t){this.setState({dialogKey:e,dialogExtra:t})}},{key:"addNewMoth",value:function(e){isNaN(e)?v.b.error("\u8bf7\u8f93\u5165\u6709\u6548\u6708\u4efd\uff0c\u5982 2022-5"):this.months.includes(R.d.monthStr(e))?(v.b.error("\u5df2\u6709\u5f53\u524d\u6708\u4efd"),this.hideDialog()):(je.addMonth(e),this.state.sideKey=R.d.monthStr(e),this.hideDialog())}},{key:"hideDialog",value:function(){this.setState({dialogKey:""})}},{key:"render",value:function(){var e,t,n,r,i,a=this,o=[],c=this.getByMonthSideDatas(),l=null;i=Object.keys(c).sort((function(e,t){return t>e?1:-1})).map((function(e,t){return o.push(e),{key:e,label:e,children:c[e].sort((function(e,t){return t>e?1:-1})).map((function(e,t){return null==l&&(l=e),{key:e,label:e}}))}})),R.a.isNull(this.state.sideKey)&&(this.state.sideKey=l),this.monthDate=new Date(this.state.sideKey);var u=this.monthDate;if(R.a.notNumber(u))return Object(w.jsx)(Oe,{});console.log("month page render ",u);var s=J.getTypeTrees(H.c.IncomeType,!1),d=J.getTypeTrees(H.c.ExpenditureType,!1),y=this._getTypeTreeSelectDatas(s),h=this._getTypeTreeSelectDatas(d),f={},v={},b={};Q.queryProducts().forEach((function(e){e.type.isAsset()?v[e.id]=[e.name,e.type.code,e.type.name]:e.type.isDebt()?b[e.id]=[e.name,e.type.code,e.type.name]:f[e.id]=[e.name,e.type.code,e.type.name]}));var j=[],g=J.queryMonthData(u),x=g.income.total,O=g.expend.total,k=X.queryMonthData(u),D=this._getPassiveIncomeSummary(k),I=this._getPassiveExpendSummary(k);console.log("===== monthData     =====",g),console.log("===== allInvestData =====",k),this.lastMonthAllInvestData=X.queryMonthData(R.d.lastMonthEnd(u));var C=this._getTotalMoney(k),_=this._getTotalMoney(this.lastMonthAllInvestData),N=x+O+D.total+I.total;j.push({key:"\u4e3b\u52a8\u6536\u5165",entity:this.newEntity(null,"\u4e3b\u52a8\u6536\u5165",x,null,g.income.details)}),j.push({key:"\u88ab\u52a8\u6536\u5165",entity:this.newEntity(null,"\u88ab\u52a8\u6536\u5165",D.total,null,D.details)}),j.push({key:"\u4e3b\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u4e3b\u52a8\u652f\u51fa",O,null,g.expend.details)}),j.push({key:"\u88ab\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u88ab\u52a8\u652f\u51fa",I.total,null,I.details)}),j.push({key:"\u65b0\u589e\u73b0\u91d1",entity:this.newEntity(null,"\u65b0\u589e\u73b0\u91d1",N,null)}),j.push({key:"\u4e0a\u671f\u603b\u8d44\u4ea7",entity:this.newEntity(null,"\u4e0a\u671f\u603b\u8d44\u4ea7",_,null)});var B=[];B.push(this.newEntity(null,"\u8d44\u4ea7\u603b\u989d",k.asset.totalMoneys[0],null)),B.push(this.newEntity(null,"\u8d1f\u503a\u603b\u989d",k.debt.totalMoneys[0],null)),B.push(this.newEntity(null,"\u6295\u8d44\u603b\u989d",k.fund.totalMoneys[1],"\u8d26\u9762\u4ef7\u503c\uff1a".concat(R.c.getStr(k.fund.totalMoneys[0])))),B.push(this.newEntity(null,"\u80a1\u7968\u603b\u989d",k.stock.totalMoneys[1],"\u8d26\u9762\u4ef7\u503c\uff1a".concat(R.c.getStr(k.stock.totalMoneys[0])))),j.push({key:"\u5f53\u524d\u603b\u8d44\u4ea7",entity:this.newEntity(null,"\u5f53\u524d\u603b\u8d44\u4ea7",C,null,B)});var q=this._mapToList(k.fund.products,!0),U=this._mapToList(k.stock.products,!0),V=[];V.push.apply(V,Object(fe.a)(this._mapToList(k.asset.products)).concat(Object(fe.a)(this._mapToList(k.debt.products))));var K=function(e,t){var n=[];return e.entity.buySells.filterDatas.forEach((function(t){var r,i,a,o=Object(E.a)(null!==(r=null===(i=e.entity.profits)||void 0===i?void 0:i.filterDatas)&&void 0!==r?r:[]);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c.buySellId===t.id){t.profitMoney=c.money;break}}}catch(l){o.e(l)}finally{o.f()}n.push({key:t.id,entity:t})})),Object(w.jsx)(L.a,{columns:a.subInvestColumns,dataSource:n,pagination:!1})},F=function(e){var t,n;return!R.a.isNull(null===(t=e.entity.buySells)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterDatas.length)>0},Y=Object(w.jsxs)(Oe,{className:"Content",children:[Object(w.jsxs)(S.a,{children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u4f7f\u7528\u6b65\u9aa4"}),Object(w.jsxs)(A.b,{direction:"vertical",children:[Object(w.jsx)(Pe,{children:"1. \u8fd8\u6e05\u5404\u8d44\u4ea7\u8d26\u6237\u7684\u501f\u6b3e\uff08\u4fe1\u7528\u5361\uff09\uff0c\u8bb0\u5f55\u8d44\u4ea7\u73b0\u989d"}),Object(w.jsx)(Pe,{children:"2. \u8bb0\u5f55 \u652f\u4ed8\u5b9d/\u5fae\u4fe1 \u5f53\u6708\u7684 \u6536\u5165/\u652f\u51fa"}),Object(w.jsx)(Pe,{children:"3. \u8bb0\u5f55 \u57fa\u91d1/\u80a1\u7968 \u7684 \u5f53\u6708 \u4e70\u5165/\u5356\u51fa \u64cd\u4f5c\u548c\u5f53\u524d\u73b0\u989d\u7b49\u4fe1\u606f"}),Object(w.jsx)(Pe,{children:"4. \u68c0\u67e5 \u603b\u8d44\u4ea7\u73af\u6bd4\u8bef\u5dee \u4fe1\u606f\uff08\u5927\u4e8e0\u8868\u793a\uff1a\u6536\u5165\u5c11\u4e86/\u652f\u51fa\u591a\u4e86/\u5f53\u524d\u603b\u8d44\u4ea7\u591a\u4e86\uff09\uff0c\u5c3d\u91cf\u4fdd\u6301500\u4ee5\u4e0b"})]})]}),Object(w.jsxs)(S.a,{justify:"space-between",style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u65b0\u589e\u6536\u5165/\u652f\u51fa"}),Object(w.jsxs)(T.a,{span:8,children:[Object(w.jsx)(ue,{title:"\u6536\u5165",cfgs:[{name:"treeType",treeData:y,required:!0},{name:"money",required:!0,moneyPon:!0},{name:"date",required:!0,inMonth:u},{name:"desc",type:"input"}],onSubmit:function(e){return a.insertData(e)}}),Object(w.jsx)(ue,{title:"\u652f\u51fa",cfgs:[{name:"treeType",treeData:h,required:!0},{name:"money",required:!0,moneyPon:!1},{name:"date",required:!0,inMonth:u},{name:"desc",type:"input"}],onSubmit:function(e){return a.insertData(e)}})]}),Object(w.jsxs)(T.a,{span:16,children:[Object(w.jsx)(L.a,{columns:this.incomeExpendColumns,dataSource:j,expandable:{expandedRowRender:function(e,t){var n=[];return e.entity.child.forEach((function(e){n.push({key:R.a.isNull(e.id)?e.title:e.id,entity:e})})),Object(w.jsx)(L.a,{columns:a.subIncomeExpendColumns,dataSource:n,pagination:!1,sortDirections:["descend"]})},rowExpandable:function(e){return!R.a.isNull(e.entity.child)&&e.entity.child.length>0}},pagination:{pageSize:20},sortDirections:["descend"]}),Object(w.jsx)(P.a,{orientation:"center",children:"\u6307\u6807"}),xe.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u652f\u51fa\uff08\u8d22\u5bcc\u81ea\u7531\u7387\uff09",R.a.getPercent(D.total/Math.abs(O+I.total))),xe.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u4e3b\u52a8\u6536\u5165",R.a.getPercent(D.total/x)),this.createShowMoneyRowIfBiggerThan("\u603b\u8d44\u4ea7\u73af\u6bd4\u8bef\u5dee",C-_-N,[500,1e3])]})]}),Object(w.jsxs)(S.a,{justify:"space-between",style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u8d44\u4ea7/\u8d1f\u503a"}),Object(w.jsxs)(T.a,{span:8,children:[Object(w.jsx)(ue,{title:"\u8d44\u4ea7",cfgs:[{name:"type",code2Name:v,required:!0},{name:"currentPrice",type:"money",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!0},{name:"money",hint:"\u6536\u76ca",moneyPon:!0},{name:"date",required:!0,inMonth:u}],onSubmit:function(e){return a.addAssetDebtProfit(e)}}),Object(w.jsx)(ue,{title:"\u8d1f\u503a",cfgs:[{name:"type",code2Name:b,required:!0},{name:"currentPrice",type:"money",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!1},{name:"money",hint:"\u4e8f\u635f",moneyPon:!1},{name:"date",required:!0,inMonth:u}],onSubmit:function(e){return a.addAssetDebtProfit(e)}})]}),Object(w.jsx)(T.a,{span:16,children:Object(w.jsx)(L.a,{columns:this.assetDebtColumns,dataSource:V,expandable:{expandedRowRender:function(e,t){var n=[];return e.entity.profits.filterDatas.forEach((function(e){n.push({key:e.id,entity:e})})),Object(w.jsx)(L.a,{columns:a.subAssetDebtColumns,dataSource:n,pagination:!1})},rowExpandable:function(e){var t,n;return!R.a.isNull(null===(t=e.entity.profits)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.profits)||void 0===n?void 0:n.filterDatas.length)>0}},pagination:{pageSize:20},scroll:{x:800},sortDirections:["descend"]})})]}),Object(w.jsxs)(S.a,{style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u6295\u8d44"}),Object(w.jsx)(T.a,{span:10,children:Object(w.jsx)(ue,{title:"\u4e70\u5165\u6295\u8d44",cfgs:[{name:"type",code2Name:f,required:!0},{name:"money",hint:"\u82b1\u8d39\u91d1\u989d",required:!0,moneyPon:!0},{name:"currentPrice",type:"money",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!0},{name:"count",type:"money",hint:"\u4efd\u6570",required:!1,moneyPon:!0},{name:"date",required:!0,inMonth:u}],onSubmit:function(e){return a.addBuyInvest(e)}})}),Object(w.jsx)(T.a,{span:14,children:Object(w.jsx)(ue,{title:"\u5356\u51fa\u6295\u8d44",cfgs:[{name:"type",code2Name:f,required:!0},{name:"count",type:"money",hint:"\u4efd\u6570",required:!1,moneyPon:!0},{name:"money",hint:"\u5356\u51fa\u6240\u5f97\u91d1\u989d",required:!0,moneyPon:!0},{name:"sellProfit",type:"money",hint:"\u5356\u51fa\u5229\u6da6-\u53ef\u8d1f\uff08\u4e8c\u9009\u4e00\uff09",required:!1,moneyPon:!0},{name:"currentPrice",type:"money",hint:"\u8d26\u9762\u4ef7\u503c",required:!0,moneyPon:!0},{name:"currentProfit",type:"money",hint:"\u8d26\u9762\u5229\u6da6-\u53ef\u8d1f\uff08\u4e8c\u9009\u4e00\uff09",required:!1,moneyPon:!0},{name:"date",required:!0,inMonth:u}],onSubmit:function(e){return a.addSellInvest(e)}})})]}),Object(w.jsx)(L.a,{columns:this.investColumns,dataSource:U,expandable:{expandedRowRender:K,rowExpandable:F},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(w.jsx)(L.a,{columns:this.investColumns,dataSource:q,expandable:{expandedRowRender:K,rowExpandable:F},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]})]});return Object(w.jsxs)(p.a,{children:[Object(w.jsx)(ke,{width:200,children:Object(w.jsx)(m.a,{className:"Menu",mode:"inline",openKeys:o,selectedKeys:[this.state.sideKey],items:i,onSelect:function(e){a.setState((function(){return a.state.sideKey=e.key}))}})}),Object(w.jsxs)(p.a,{className:"Layout-inner",children:[Object(w.jsxs)(S.a,{align:"middle",children:[Object(w.jsx)(T.a,{flex:"auto",children:Object(w.jsx)(pe.a,{children:Object(w.jsx)(pe.a.Item,{children:this.state.sideKey})})}),Object(w.jsx)(T.a,{span:12,align:"right",children:Object(w.jsx)(M.a,{onClick:function(){return a.showDialog("addNewMonth",null)},children:"\u65b0\u52a0\u6708\u4efd"})})]}),Y]}),Object(w.jsx)(se,{title:"\u65b0\u52a0\u6708\u4efd",visible:"addNewMonth"===this.state.dialogKey,cfgs:[{name:"date",hint:"\u6708\u4efd",picker:"month",defaultValue:new Date}],onOk:function(e){return a.addNewMoth(e.date)},onCancel:function(){return a.hideDialog()}}),Object(w.jsx)(se,{title:"\u4fee\u6539\u6536\u5165/\u652f\u51fa",visible:"modifyIncomeOrExpend"===this.state.dialogKey,cfgs:[{name:"treeType",required:!0,treeData:null!==(t=this.state.dialogExtra)&&void 0!==t&&t.type.isIncome()?y:h,defaultValue:this._getTypeTreeCode(null===(n=this.state.dialogExtra)||void 0===n?void 0:n.type)},{name:"desc",type:"input",required:!1,defaultValue:null===(r=this.state.dialogExtra)||void 0===r?void 0:r.desc}],extra:this.state.dialogExtra,onOk:function(e){return a.modifyIncomeOrExpend(e)},onCancel:function(){return a.hideDialog()}},null===(e=this.state.dialogExtra)||void 0===e?void 0:e.id)]})}},{key:"_getTypeTreeCode",value:function(e){return R.a.isNull(e)?null:e.code+"___"+e.name}},{key:"_praseTypeCode",value:function(e){return parseInt(e.split("___")[0])}},{key:"_getTypeTreeSelectDatas",value:function(e){var t,n=[],r=Object(E.a)(e);try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o={title:a.entity.name,value:this._getTypeTreeCode(a.entity),children:[]},c=Object(E.a)(a.childs);try{for(c.s();!(i=c.n()).done;){var l=i.value;o.children.push({title:l.entity.name,value:this._getTypeTreeCode(l.entity)})}}catch(u){c.e(u)}finally{c.f()}n.push(o)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"createShowMoneyRowIfBiggerThan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="",i=Math.abs(t);return void 0!==n[0]&&(r=i>100*n[1]?"danger":i>100*n[0]?"warning":"success"),xe.createShowTextRow(e,R.c.getStr(t),r)}},{key:"createShowMoneyRowIfSmallerThan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="",i=Math.abs(t);return void 0!==n[0]&&(r=i<100*n[1]?"danger":i<100*n[0]?"warning":"success"),xe.createShowTextRow(e,R.c.getStr(t),r)}},{key:"createShowMoneyRow",value:function(e,t){return xe.createShowTextRow(e,R.c.getStr(t),"")}},{key:"newEntity",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return{happenTime:e,title:t,money:n,desc:r,child:i}}},{key:"_getTotalMoney",value:function(e){var t=e.asset.totalMoneys,n=e.fund.totalMoneys,r=e.stock.totalMoneys,i=e.debt.totalMoneys;return t[0]+i[0]+n[1]+r[1]}},{key:"_mapToList",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=0,i=Object.keys(e);r<i.length;r++){var a,o,c,l,u=i[r],s=e[u];t&&R.c.noValue(null===(a=s.currentPrice)||void 0===a?void 0:a.money)&&R.c.noValue(null===(o=s.profits)||void 0===o?void 0:o.filterTotalMoney)&&R.c.noValue(null===(c=s.buySells)||void 0===c?void 0:c.filterMoney)&&R.c.noValue(null===(l=s.buySells)||void 0===l?void 0:l.totalMoney)||n.push({key:u,entity:s})}return n}},{key:"_getProductsProfitEntitys",value:function(e){var t=this;if(R.a.isEmpty(e))return[];var n=[];return Object.keys(e).map((function(r){var i,a=null===(i=e[r].profits)||void 0===i?void 0:i.filterDatas;if(!R.a.isNull(a)){var o,c=Object(E.a)(a);try{for(c.s();!(o=c.n()).done;){var l=o.value;n.push(t.newEntity(l.happenTime,l.productName,l.money,null))}}catch(u){c.e(u)}finally{c.f()}}})),n}},{key:"_getPassiveIncomeSummary",value:function(e){var t=e.asset,n=e.fund,r=e.stock,i=[];return i.push.apply(i,Object(fe.a)(this._getProductsProfitEntitys(t.products)).concat(Object(fe.a)(this._getProductsProfitEntitys(n.products)),Object(fe.a)(this._getProductsProfitEntitys(r.products)))),{total:t.totalProfitMoneys[1]+n.totalProfitMoneys[1]+r.totalProfitMoneys[1],details:i}}},{key:"_getPassiveExpendSummary",value:function(e){var t=e.debt,n=[];return n.push.apply(n,Object(fe.a)(this._getProductsProfitEntitys(t.products))),{total:t.totalProfitMoneys[1],details:n}}}]),n}(j.a.Component),Te=Se,Me=p.a.Content,we=k.a.Text,De=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(d.a)(this,n),t.call(this,e)}return Object(y.a)(n,[{key:"render",value:function(){return Object(w.jsx)(Me,{className:"Content",children:Object(w.jsx)(we,{style:{fontSize:"50px"},children:" TODO "})})}}]),n}(j.a.Component),Ie=p.a.Content,Ce=k.a.Text,_e=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={},r.incomeExpendColumns=[{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(Ce,{disabled:!e.isEnable(),children:e.name})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(w.jsxs)(A.b,{size:"middle",children:[Object(w.jsx)("a",{onClick:function(){r.showModifyTypeDialog("updateType",t.entity)},children:"\u7f16\u8f91"}),Object(w.jsx)("a",{disabled:!t.entity.isEnable(),onClick:function(){t.entity.isEnable()&&r.showModifyTypeDialog("addType",t.entity)},children:"\u65b0\u589e"})]})}}],r.subIncomeExpendColumns=[{title:"\u5b50\u7c7b\u578b\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(Ce,{disabled:!e.isEnable(),children:e.name})}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return Object(w.jsx)(A.b,{size:"middle",children:Object(w.jsx)("a",{onClick:function(){r.showModifyTypeDialog("updateType",t.entity)},children:"\u7f16\u8f91"})})}}],r}return Object(y.a)(n,[{key:"showModifyTypeDialog",value:function(e,t){this.setState({dialogKey:e,dialogExtra:t})}},{key:"hideDialog",value:function(){this.setState({dialogKey:null,dialogExtra:null})}},{key:"modifyType",value:function(e,t){console.log(e,t);var n=t.extra,r=t.switch,i=t.desc,a=parseInt(t.type);0==a&&(a=null),"updateType"===e?W.a.updateType(n,i,a,r?H.b.Normal:H.b.Disabled):"addType"===e&&W.a.addType(n.config.type,i,a,r?H.b.Normal:H.b.Disabled),this.hideDialog()}},{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"render",value:function(){var e,t,n,r,i,a,o,c,l,u,d=this,y=J.getTypeTrees(H.c.IncomeType,!0),h=J.getTypeTrees(H.c.ExpenditureType,!0),f=function(e,t){return Object(w.jsx)(L.a,{columns:d.subIncomeExpendColumns,dataSource:e.childs,pagination:!1})},p=function(e){return!R.a.isNull(e.childs)&&e.childs.length>0},v={},m={},b=Object(E.a)(y);try{for(b.s();!(u=b.n()).done;){var j=u.value;v[j.entity.code]=[j.entity.name]}}catch(D){b.e(D)}finally{b.f()}v[0]=["\u7a7a"];var g,x=Object(E.a)(h);try{for(x.s();!(g=x.n()).done;){var O=g.value;m[O.entity.code]=[O.entity.name]}}catch(D){x.e(D)}finally{x.f()}m[0]=["\u7a7a"];var k="",M=!1;return"updateType"===this.state.dialogKey?(M=!0,k="\u7f16\u8f91\u7c7b\u578b"):"addType"===this.state.dialogKey&&(M=!0,k="\u65b0\u589e\u7c7b\u578b"),Object(w.jsxs)(Ie,{className:"Content",children:[Object(w.jsxs)(P.a,{orientation:"center",children:["DB\u7248\u672c\uff1a",null===(e=s.a.db)||void 0===e?void 0:e.getDbConfig().db_version]}),Object(w.jsxs)(S.a,{justify:"space-between",style:{padding:"10px 5px",backgroundColor:"#eee"},children:[Object(w.jsxs)(T.a,{span:12,children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u6536\u5165\u7c7b\u578b\u914d\u7f6e"}),Object(w.jsx)(L.a,{style:{margin:"0px 5px"},columns:this.incomeExpendColumns,dataSource:y,expandable:{expandedRowRender:f,rowExpandable:p},pagination:{pageSize:50},sortDirections:["descend"]})]}),Object(w.jsxs)(T.a,{span:12,children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u652f\u51fa\u7c7b\u578b\u914d\u7f6e"}),Object(w.jsx)(L.a,{columns:this.incomeExpendColumns,dataSource:h,expandable:{expandedRowRender:f,rowExpandable:p},pagination:{pageSize:50},sortDirections:["descend"]})]})]}),Object(w.jsx)(se,{title:k,visible:M,cfgs:[{name:"type",hint:"\u7236\u7c7b\u578b",required:!0,code2Name:null!==(n=this.state.dialogExtra)&&void 0!==n&&n.isIncome()?v:m,defaultValue:"addType"===this.state.dialogKey?(null!==(r=null===(i=this.state.dialogExtra)||void 0===i?void 0:i.config.code)&&void 0!==r?r:0)+"":(null!==(a=null===(o=this.state.dialogExtra)||void 0===o?void 0:o.config.parent_code)&&void 0!==a?a:0)+""},{name:"desc",type:"input",hint:"\u540d\u79f0",required:!0,defaultValue:null===(c=this.state.dialogExtra)||void 0===c?void 0:c.name},{name:"switch",hint:"\u662f\u5426\u542f\u7528",required:!0,defaultValue:null===(l=this.state.dialogExtra)||void 0===l?void 0:l.isEnable()}],extra:this.state.dialogExtra,onOk:function(e){return d.modifyType(d.state.dialogKey,e)},onCancel:function(){return d.hideDialog()}},null===(t=this.state.dialogExtra)||void 0===t?void 0:t.code)]})}}]),n}(j.a.Component),Ee=n(6),Ne=n(812),Ae=n(813),Le=n(310),Re=p.a.Content,Be=p.a.Sider,qe=k.a.Text,Ue=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={startMonth:"01"},r.incomeExpendColumns=[{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){var t="geekblue";return"\u4e3b\u52a8\u6536\u5165"===e.title||"\u88ab\u52a8\u6536\u5165"===e.title?t="red":"\u4e3b\u52a8\u652f\u51fa"!==e.title&&"\u88ab\u52a8\u652f\u51fa"!==e.title||(t="green"),Object(w.jsx)(N.a,{color:t,children:e.title},e.title)}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(e.money)})}}],r.subIncomeExpendColumns=[{title:"\u540d\u79f0",key:"title",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:e.title})}},{title:"\u91d1\u989d",key:"money",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(e.money)})},sorter:function(e,t){return R.c.compareAbs(e.entity.money,t.entity.money)}},{title:"\u63cf\u8ff0",key:"desc",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:e.desc})}}],r.assetDebtColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return xe.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:e.info.productName})}},{title:"\u603b\u989d",key:"currentPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}}],r.subAssetDebtColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.d.dayStr(e.happenTime)})}},{title:"\u5230\u8d26\u5229\u6da6",key:"currentMonthProfit",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(e.money)})}}],r.investColumns=[{title:"\u7c7b\u578b",key:"type",dataIndex:"entity",render:function(e){return xe.getProductTag(e.info.productType)}},{title:"\u540d\u79f0",key:"name",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:e.info.productName})}},{title:"\u5356\u51fa\u603b\u989d",key:"sellPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(Math.abs(null===(t=e.buySells)||void 0===t?void 0:t.filterSellMoney))})},sorter:function(e,t){var n,r;return R.c.compareAbs(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterSellMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterSellMoney)}},{title:"\u5356\u51fa\u5229\u6da6\u7387",key:"sellProfitPercent",dataIndex:"entity",render:function(e){var t=X.getSellProfitPercent(e);return Object(w.jsx)(qe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=X.getSellProfitPercent(e.entity),r=X.getSellProfitPercent(t.entity);return R.a.compare(n,r)}},{title:"\u5356\u51fa\u5229\u6da6",key:"sellProfit",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(null===(t=e.profits)||void 0===t?void 0:t.filterTotalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.profits)||void 0===n?void 0:n.filterTotalMoney,null===(r=t.entity.profits)||void 0===r?void 0:r.filterTotalMoney)}},{title:"\u5f53\u671f\u6295\u8d44",key:"timeInvest",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(null===(t=e.buySells)||void 0===t?void 0:t.filterMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.filterMoney)}},{title:"\u6295\u8d44\u603b\u989d",key:"totalInvest",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.buySells)||void 0===n?void 0:n.totalMoney,null===(r=t.entity.buySells)||void 0===r?void 0:r.totalMoney)}},{title:"\u8d26\u9762\u5229\u6da6\u7387",key:"paperProfitPercent",dataIndex:"entity",render:function(e){var t=X.getPaperProfitPercent(e);return Object(w.jsx)(qe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})},sorter:function(e,t){var n=X.getPaperProfitPercent(e.entity),r=X.getPaperProfitPercent(t.entity);return R.a.compare(n,r)}},{title:"\u8d26\u9762\u5229\u6da6",key:"paperProfit",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(X.getPaperProfit(e))})},sorter:function(e,t){return R.c.compare(X.getPaperProfit(e.entity),X.getPaperProfit(t.entity))}},{title:"\u6700\u65b0\u4ef7\u503c",key:"lastPrice",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getStr(null===(t=e.currentPrice)||void 0===t?void 0:t.money)})},sorter:function(e,t){var n,r;return R.c.compare(null===(n=e.entity.currentPrice)||void 0===n?void 0:n.money,null===(r=t.entity.currentPrice)||void 0===r?void 0:r.money)}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getDetailStr(R.c.safeDivision(null===(t=e.buySells)||void 0===t?void 0:t.totalMoney,e.buySells.totalCount))})}},{title:"\u73b0\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){var t;return Object(w.jsx)(qe,{children:R.c.getDetailStr(R.c.safeDivision(null===(t=e.currentPrice)||void 0===t?void 0:t.money,e.buySells.totalCount))})}}],r.subInvestColumns=[{title:"\u53d1\u751f\u65f6\u95f4",key:"happenTime",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.d.dayStr(e.happenTime)})}},{title:"\u4e70\u5165/\u5356\u51fa\u672c\u91d1",key:"principal",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(e.money)})}},{title:"\u5230\u8d26\u603b\u989d",key:"sellGetMoney",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(Math.abs(e.money)+e.profitMoney)})}},{title:"\u5229\u6da6",key:"profit",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getStr(e.profitMoney)})}},{title:"\u5229\u6da6\u7387",key:"profitPercent",dataIndex:"entity",render:function(e){var t=R.c.safeDivision(e.profitMoney,Math.abs(e.money));return Object(w.jsx)(qe,{type:R.c.getPercentColorType(t),children:R.c.getPercentStr(t)})}},{title:"\u6210\u672c\u4ef7",key:"costPricePerCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getDetailStr(R.c.safeDivision(Math.abs(e.money),Math.abs(e.count)))})}},{title:"\u5356\u51fa\u4ef7",key:"currentPricePerCount",dataIndex:"entity",render:function(e){return Object(w.jsx)(qe,{children:R.c.getDetailStr(R.c.safeDivision(Math.abs(-1*e.money+e.profitMoney),Math.abs(e.count)))})}}],r}return Object(y.a)(n,[{key:"getByYearSideDatas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"01",t=je.queryMonths();this.months=t;var n=[];return t.forEach((function(t){var r=t.substring(0,4)+"-"+e;n.includes(r)||n.push(r)})),n.sort((function(e,t){return t>e?1:-1}))}},{key:"showDialog",value:function(e){this.setState({showDialog:e})}},{key:"modifyMonth",value:function(e){isNaN(e)?v.b.error("\u8bf7\u8f93\u5165\u6709\u6548\u6708\u4efd\uff0c\u5982 2022-5"):(this.state.startMonth=R.d.monthStr(e).substring(5,7),this.state.sideKey=null,this.hideDialog())}},{key:"hideDialog",value:function(){this.setState({showDialog:""})}},{key:"getAggregateGroupDataArr",value:function(e){var t,n={},r=0,i=Object(E.a)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=$.b.getByCode(a.type.code);(o=o.getGroup()).code in n||(n[o.code]={name:o.name,code:o.code,value:0});var c=Math.abs(a.money/100);n[o.code].value+=c,r+=c}}catch(l){i.e(l)}finally{i.f()}return Object.keys(n).map((function(e){return n[e].valuePercent=n[e].value/r,n[e]})).sort((function(e,t){return R.a.compare(e.code,t.code)}))}},{key:"getAggregateTimeDataArr",value:function(e,t){var n,r={},i=0,a=Object(E.a)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,c=$.b.getByCode(o.type.code),l=c.getGroup();if(t===l.code){var u=R.d.monthStr(o.happenTime)+"_"+c.code;u in r||(r[u]={name:c.name,code:c.code,groupCode:l.code,groupName:l.name,month:R.d.monthStr(o.happenTime),value:0});var s=Math.abs(o.money/100);r[u].value+=s,i+=s}}}catch(y){a.e(y)}finally{a.f()}var d=Object.keys(r).map((function(e){return r[e].valuePercent=r[e].value/i,r[e]})).sort((function(e,t){return e.month==t.month?R.a.compare(e.code,t.code):e.month>t.month?1:-1}));return d}},{key:"render",value:function(){var e=this,t=this.getByYearSideDatas(this.state.startMonth),n=t.map((function(e,t){return{key:e,label:e}}));R.a.isNull(this.state.sideKey)&&(this.state.sideKey=t[0]);var r=new Date(this.state.sideKey),i=J.queryYearData(r),a=X.queryYearData(r);console.log("===== yearData     =====",i),console.log("===== allInvestData =====",a);var o=this._getPassiveIncomeSummary(a),c=this._getPassiveExpendSummary(a),l=[];l.push({key:"\u4e3b\u52a8\u6536\u5165",entity:this.newEntity(null,"\u4e3b\u52a8\u6536\u5165",i.income.total,null,i.income.sumByMonth.map((function(t){return e.newEntity(null,t.month,t.total,null)})))}),l.push({key:"\u88ab\u52a8\u6536\u5165",entity:this.newEntity(null,"\u88ab\u52a8\u6536\u5165",o.total,null,o.details)}),l.push({key:"\u4e3b\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u4e3b\u52a8\u652f\u51fa",i.expend.total,null,i.expend.sumByMonth.map((function(t){return e.newEntity(null,t.month,t.total,null)})))}),l.push({key:"\u88ab\u52a8\u652f\u51fa",entity:this.newEntity(null,"\u88ab\u52a8\u652f\u51fa",c.total,null,c.details)}),l.push({key:"\u65b0\u589e\u73b0\u91d1",entity:this.newEntity(null,"\u65b0\u589e\u73b0\u91d1",i.income.total+o.total+i.expend.total+c.total,null)});var u=this._mapToList(a.fund.products,!0),s=this._mapToList(a.stock.products,!0),d=[];d.push.apply(d,Object(fe.a)(this._mapToList(a.asset.products)).concat(Object(fe.a)(this._mapToList(a.debt.products))));var y=function(t,n){var r=[];return t.entity.buySells.filterDatas.forEach((function(e){var n,i,a,o=Object(E.a)(null!==(n=null===(i=t.entity.profits)||void 0===i?void 0:i.filterDatas)&&void 0!==n?n:[]);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c.buySellId===e.id){e.profitMoney=c.money;break}}}catch(l){o.e(l)}finally{o.f()}r.push({key:e.id,entity:e})})),Object(w.jsx)(L.a,{columns:e.subInvestColumns,dataSource:r,pagination:!1})},h=function(e){var t,n;return!R.a.isNull(null===(t=e.entity.buySells)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.buySells)||void 0===n?void 0:n.filterDatas.length)>0},f=this.getAggregateGroupDataArr(i.income.details),v=this.getAggregateGroupDataArr(i.expend.details),b=[];if(!R.a.isNull(this.state.selectedGroupCode)){var j=$.b.getByCode(this.state.selectedGroupCode);b=j.isIncome()?this.getAggregateTimeDataArr(i.income.details,j.code):this.getAggregateTimeDataArr(i.expend.details,j.code)}var g=Object(w.jsxs)(Re,{children:[Object(w.jsx)(L.a,{columns:this.incomeExpendColumns,dataSource:l,expandable:{expandedRowRender:function(t,n){var r=[];return t.entity.child.forEach((function(e){r.push({key:R.a.isNull(e.id)?e.title:e.id,entity:e})})),Object(w.jsx)(L.a,{columns:e.subIncomeExpendColumns,dataSource:r,pagination:!1,sortDirections:["descend"]})},rowExpandable:function(e){return!R.a.isNull(e.entity.child)&&e.entity.child.length>0}},pagination:{pageSize:20},sortDirections:["descend"]}),Object(w.jsxs)(S.a,{children:[Object(w.jsx)(T.a,{span:12,children:Object(w.jsx)(Ne.a,Object(Ee.a)({},this._getPieConfig(f)))}),Object(w.jsx)(T.a,{span:12,children:Object(w.jsx)(Ne.a,Object(Ee.a)({},this._getPieConfig(v)))})]}),Object(w.jsx)(S.a,{style:{padding:"10px"},children:Object(w.jsx)(T.a,{span:24,children:b.length>0?Object(w.jsx)(Ae.a,Object(Ee.a)({},this._getBarConfig(b))):Object(w.jsx)("div",{})})}),Object(w.jsx)(P.a,{orientation:"center",children:"\u6307\u6807"}),xe.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u652f\u51fa\uff08\u8d22\u5bcc\u81ea\u6709\u7387\uff09",R.a.getPercent(o.total/Math.abs(i.expend.total+c.total))),xe.createShowTextRow("\u88ab\u52a8\u6536\u5165/\u4e3b\u52a8\u6536\u5165",R.a.getPercent(o.total/i.income.total)),Object(w.jsx)(P.a,{orientation:"center",children:"\u8d44\u4ea7/\u8d1f\u503a"}),Object(w.jsx)(L.a,{columns:this.assetDebtColumns,dataSource:d,expandable:{expandedRowRender:function(t,n){var r=[];return t.entity.profits.filterDatas.forEach((function(e){r.push({key:e.id,entity:e})})),Object(w.jsx)(L.a,{columns:e.subAssetDebtColumns,dataSource:r,pagination:!1})},rowExpandable:function(e){var t,n;return!R.a.isNull(null===(t=e.entity.profits)||void 0===t?void 0:t.filterDatas)&&(null===(n=e.entity.profits)||void 0===n?void 0:n.filterDatas.length)>0}},pagination:{pageSize:20},scroll:{x:800},sortDirections:["descend"]}),Object(w.jsx)(P.a,{orientation:"center",children:"\u6295\u8d44"}),Object(w.jsx)(L.a,{columns:this.investColumns,dataSource:s,expandable:{expandedRowRender:y,rowExpandable:h},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]}),Object(w.jsx)(L.a,{columns:this.investColumns,dataSource:u,expandable:{expandedRowRender:y,rowExpandable:h},pagination:{pageSize:20},scroll:{x:1500},sortDirections:["descend"]})]});return Object(w.jsxs)(p.a,{children:[Object(w.jsx)(Be,{width:200,children:Object(w.jsx)(m.a,{className:"Menu",mode:"inline",selectedKeys:[this.state.sideKey],items:n,onSelect:function(t){e.setState((function(){return e.state.sideKey=t.key}))}})}),Object(w.jsxs)(p.a,{className:"Layout-inner",children:[Object(w.jsxs)(S.a,{align:"middle",children:[Object(w.jsx)(T.a,{flex:"auto",children:Object(w.jsx)(pe.a,{children:Object(w.jsx)(pe.a.Item,{children:this.state.sideKey})})}),Object(w.jsx)(T.a,{span:12,align:"right",children:Object(w.jsx)(M.a,{onClick:function(){return e.showDialog("modifyStartMonth")},children:"\u8c03\u6574\u5f00\u59cb\u6708\u4efd"})})]}),g]}),Object(w.jsx)(se,{title:"\u8c03\u6574\u5f00\u59cb\u6708\u4efd",visible:"modifyStartMonth"===this.state.showDialog,cfgs:[{name:"date",hint:"\u6708\u4efd",picker:"month",defaultValue:new Date("2022-01")}],onOk:function(t){return e.modifyMonth(t.date)},onCancel:function(){return e.hideDialog()}})]})}},{key:"_getBarConfig",value:function(e){return{data:e,xField:"month",yField:"value",isGroup:!0,isStack:!0,seriesField:"name",groupField:"groupName",label:{position:"middle",style:{fill:"black",textAlign:"center"},formatter:function(e){return e.name+": "+R.c.getPercentStr(e.valuePercent)}},tooltip:{formatter:function(e){return{name:"".concat(e.name),value:"".concat(R.c.getStr(e.value,!0))}}}}}},{key:"_getPieConfig",value:function(e){var t=this;function n(e,t,n){var r=Object(Le.measureTextWidth)(t,n),i=r.width,a=r.height,o=e/2,c=1;e<i&&(c=Math.min(Math.sqrt(Math.abs(Math.pow(o,2)/(Math.pow(i/2,2)+Math.pow(a,2)))),1));var l="width:".concat(e,"px;");return'<div style="'.concat(l,";font-size:").concat(c,"em;line-height:").concat(c<1?1:"inherit",';">').concat(t,"</div>")}return{appendPadding:10,data:e,angleField:"valuePercent",colorField:"name",radius:1,innerRadius:.618,label:{type:"inner",offset:"-50%",style:{fill:"black",textAlign:"center"},formatter:function(e){return e.name+": "+R.c.getPercentStr(e.valuePercent)},autoRotate:!1},statistic:{title:{offsetY:-4,customHtml:function(e,t,r){var i=e.getBoundingClientRect(),a=i.width,o=i.height;return n(Math.sqrt(Math.pow(a/2,2)+Math.pow(o/2,2)),r?r.name:"\u603b\u8ba1",{fontSize:28})}},content:{offsetY:4,customHtml:function(e,t,r,i){return n(e.getBoundingClientRect().width,"".concat(r?R.c.getStr(r.value,!0):R.c.getStr(i.reduce((function(e,t){return e+t.value}),0),!0)),{fontSize:32})}}},interactions:[{type:"element-selected"},{type:"element-active"},{type:"pie-statistic-active"}],onReady:function(e){e.on("element:click",(function(e){t.setState({selectedGroupCode:e.data.data.code})}))}}}},{key:"newEntity",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return{happenTime:e,title:t,money:n,desc:r,child:i}}},{key:"_mapToList",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=0,i=Object.keys(e);r<i.length;r++){var a,o,c,l,u=i[r],s=e[u];t&&R.c.noValue(null===(a=s.currentPrice)||void 0===a?void 0:a.money)&&R.c.noValue(null===(o=s.profits)||void 0===o?void 0:o.filterTotalMoney)&&R.c.noValue(null===(c=s.buySells)||void 0===c?void 0:c.filterMoney)&&R.c.noValue(null===(l=s.buySells)||void 0===l?void 0:l.totalMoney)||n.push({key:u,entity:s})}return n}},{key:"_getPassiveIncomeSummary",value:function(e){var t=e.asset,n=e.fund,r=e.stock;return{total:t.totalProfitMoneys[1]+n.totalProfitMoneys[1]+r.totalProfitMoneys[1],details:[this.newEntity(null,"\u8d44\u4ea7\u6536\u5165",t.totalProfitMoneys[1]),this.newEntity(null,"\u6295\u8d44\u6536\u5165",n.totalProfitMoneys[1]),this.newEntity(null,"\u80a1\u7968\u6536\u5165",r.totalProfitMoneys[1])]}}},{key:"_getPassiveExpendSummary",value:function(e){var t=e.debt;return{total:t.totalProfitMoneys[1],details:[this.newEntity(null,"\u8d1f\u503a\u652f\u51fa",t.totalProfitMoneys[1])]}}}]),n}(j.a.Component),Ve=Ue,Ke=n(535),Fe=k.a.Text,Ye=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={},r.testResults=[],r.group="default",r.resultColumns=[{title:"id",key:"id",dataIndex:"entity",render:function(e){return Object(w.jsx)(Fe,{children:e.id})}},{title:"success",key:"success",dataIndex:"entity",render:function(e){var t="green";return e.success||(t="red"),Object(w.jsx)(N.a,{color:t,children:e.success?"Success":"Fail"})}},{title:"group",key:"group",dataIndex:"entity",render:function(e){return Object(w.jsx)(Fe,{children:e.group})}},{title:"msg",key:"msg",dataIndex:"entity",render:function(e){return Object(w.jsx)(Fe,{children:e.msg})}},{title:"actual",key:"actual",dataIndex:"entity",render:function(e){return Object(w.jsx)(Fe,{children:e.actual})}},{title:"expect",key:"expect",dataIndex:"entity",render:function(e){return Object(w.jsx)(Fe,{children:e.expect})}}],r}return Object(y.a)(n,[{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"_expect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r={};(r=t===e?{group:this.group,success:!0,msg:n,expect:t,actual:e}:{group:this.group,success:!1,msg:n,expect:t,actual:e}).id=this.testResults.length+1,this.testResults.push(r)}},{key:"_testIncomeExpend",value:function(){this.group="_testIncomeExpend";var e=J.queryMonthData(new Date("2022-11"));this._expect(e.income.total,3007018),this._expect(e.income.details.length,2),this._expect(e.expend.total,-826853),this._expect(e.expend.details.length,17);var t=J.queryMonthData(new Date("2022-10"));this._expect(t.income.total,3260514),this._expect(t.income.details.length,3),this._expect(t.expend.total,-1809859),this._expect(t.expend.details.length,20);var n=J.queryYearData(new Date("2021-04"));this._expect(n.income.total,14980332),this._expect(n.income.details.length,9),this._expect(n.income.sumByMonth.length,4),this._expect(n.expend.total,-164667437),this._expect(n.expend.details.length,51),this._expect(n.expend.sumByMonth.length,4)}},{key:"_testInvestData",value:function(){this.group="_testInvestData";var e=X.queryMonthData(new Date("2022-10"));this._expect(e.asset.totalMoneys[0],17330631),this._expect(e.asset.totalProfitMoneys[1],7500),this._expect(e.asset.totalMoneys[1],0),this._expect(e.debt.totalMoneys[0],-894467),this._expect(e.debt.totalProfitMoneys[1],-85e4),this._expect(e.debt.totalMoneys[1],0),this._expect(e.fund.totalMoneys[0],50981840),this._expect(e.fund.totalProfitMoneys[1],0),this._expect(e.fund.totalMoneys[1],57218750),this._expect(e.stock.totalMoneys[0],21153610),this._expect(e.stock.totalProfitMoneys[1],28250),this._expect(e.stock.totalMoneys[1],24719638);var t=X.queryMonthData(new Date("2022-11"));this._expect(t.asset.totalMoneys[0],16241803),this._expect(t.asset.totalProfitMoneys[1],2650),this._expect(t.asset.totalMoneys[1],0),this._expect(t.debt.totalMoneys[0],-6e3),this._expect(t.debt.totalProfitMoneys[1],-15e5),this._expect(t.debt.totalMoneys[1],0),this._expect(t.fund.totalMoneys[0],54335438),this._expect(t.fund.totalProfitMoneys[1],0),this._expect(t.fund.totalMoneys[1],58088750),this._expect(t.stock.totalMoneys[0],21522750),this._expect(t.stock.totalProfitMoneys[1],-20),this._expect(t.stock.totalMoneys[1],24677398)}},{key:"testAll",value:function(){this.testResults=[],this._testIncomeExpend(),this._testInvestData(),this.refreshPage()}},{key:"render",value:function(){var e=this;return Object(w.jsxs)(Ke.Content,{className:"Content",children:[Object(w.jsxs)(P.a,{orientation:"center",children:["\u7248\u672c\uff1a",s.a.getVersion()]}),Object(w.jsxs)(S.a,{style:{padding:"10px 50px 50px",backgroundColor:"#eee",margin:"10px 0"},children:[Object(w.jsx)(P.a,{orientation:"center",children:"\u6d4b\u8bd5\u6309\u94ae"}),Object(w.jsx)(M.a,{onClick:function(){return e.testAll()},children:"\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b"})]}),Object(w.jsx)(L.a,{columns:this.resultColumns,dataSource:this.testResults.filter((function(e){return!e.success})).map((function(e,t){return{key:t,entity:e}}))})]})}}]),n}(j.a.Component),Ge=Ye,ze=p.a.Header,Qe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;Object(d.a)(this,n),r=t.call(this,e);var i={init:"\u6570\u636e\u521d\u59cb\u5316",by_month:"\u6309\u6708\u5c55\u793a",by_year:"\u6309\u5e74\u5c55\u793a",invest_detail:"\u6295\u8d44\u8be6\u60c5",user_config:"\u7528\u6237\u914d\u7f6e"};return s.a.isProduction()||(i.test="\u6d4b\u8bd5\u9875\u9762"),r.navItems=Object.keys(i).map((function(e){return{key:e,label:i[e]}})),r.state={navKey:"init"},r}return Object(y.a)(n,[{key:"refreshPage",value:function(){this.setState({updateTime:(new Date).getTime()})}},{key:"render",value:function(){var e=this,t=this.state.navKey,n=null;return"init"===t||!0!==s.b?("init"!==t&&(this.state.navKey="init",v.b.error("\u8bf7\u5148\u52a0\u8f7dDB\u6587\u4ef6")),n=Object(w.jsx)(_,{onDbReady:function(){s.a.isProduction()?e.state.navKey="by_month":e.state.navKey="user_config",e.refreshPage()}})):n="test"===t?Object(w.jsx)(Ge,{}):"by_month"===t?Object(w.jsx)(Te,{}):"by_year"===t?Object(w.jsx)(Ve,{}):"invest_detail"===t?Object(w.jsx)(he,{}):"user_config"===t?Object(w.jsx)(_e,{}):Object(w.jsx)(De,{}),Object(w.jsxs)(p.a,{children:[Object(w.jsx)(ze,{className:"header",children:Object(w.jsx)(m.a,{theme:"dark",mode:"horizontal",items:this.navItems,selectedKeys:[t],onSelect:function(t){e.setState((function(){return e.state.navKey=t.key}))}})}),n]})}}]),n}(j.a.Component);c.a.locale("zh-cn"),u.a.render(Object(w.jsx)(r.a,{locale:a.a,children:Object(w.jsx)(Qe,{},"mainpage")}),document.getElementById("root"))}},[[806,1,2]]]);
//# sourceMappingURL=main.4c4955a9.chunk.js.map